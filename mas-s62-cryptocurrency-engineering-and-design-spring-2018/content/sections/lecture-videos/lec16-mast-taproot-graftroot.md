---
about_this_resource_text: ''
course_id: mas-s62-cryptocurrency-engineering-and-design-spring-2018
embedded_media:
- id: Video-YouTube-Stream
  media_location: gF4Mkkhyz1Q
  parent_uid: 4d595b57196aee4338937f75e346656b
  title: Video-YouTube-Stream
  type: Video
  uid: 1fb267700b6c27b60a2897338c53fefe
- id: Thumbnail-YouTube-JPG
  media_location: https://img.youtube.com/vi/gF4Mkkhyz1Q/default.jpg
  parent_uid: 4d595b57196aee4338937f75e346656b
  title: Thumbnail-YouTube-JPG
  type: Thumbnail
  uid: 757a71bce55d5b35481caf1b1b0d574b
- id: 3Play-3PlayYouTubeid-MP4
  media_location: gF4Mkkhyz1Q
  parent_uid: 4d595b57196aee4338937f75e346656b
  title: 3Play-3Play YouTube id
  type: 3Play
  uid: 54888ccd36ebeea5f3b9bc1fa970b5aa
- id: gF4Mkkhyz1Q.srt
  parent_uid: 4d595b57196aee4338937f75e346656b
  technical_location: https://ocw.mit.edu/courses/media-arts-and-sciences/mas-s62-cryptocurrency-engineering-and-design-spring-2018/lecture-videos/lec16-mast-taproot-graftroot/gF4Mkkhyz1Q.srt
  title: 3play caption file
  type: null
  uid: 2e29abd958c77e6781b240dd947b2174
- id: gF4Mkkhyz1Q.pdf
  parent_uid: 4d595b57196aee4338937f75e346656b
  technical_location: https://ocw.mit.edu/courses/media-arts-and-sciences/mas-s62-cryptocurrency-engineering-and-design-spring-2018/lecture-videos/lec16-mast-taproot-graftroot/gF4Mkkhyz1Q.pdf
  title: 3play pdf file
  type: null
  uid: da4b02e40aa25b39aa533cec8bb79045
- id: Caption-3Play YouTube id-SRT
  parent_uid: 4d595b57196aee4338937f75e346656b
  title: Caption-3Play YouTube id-SRT-English - US
  type: Caption
  uid: b1de6de65a55e0443f906bc227009507
- id: Transcript-3Play YouTube id-PDF
  parent_uid: 4d595b57196aee4338937f75e346656b
  title: Transcript-3Play YouTube id-PDF-English - US
  type: Transcript
  uid: 5a9c93ceb11b6742557f8e61e243275f
- id: Video-InternetArchive-MP4
  media_location: https://archive.org/download/MIT24.912S17/MITMAS_S62S18_lec16_300k.mp4
  parent_uid: 4d595b57196aee4338937f75e346656b
  title: Video-Internet Archive-MP4
  type: Video
  uid: 80aef30dee21b7118c279b3a5eb510f9
inline_embed_id: 42515564masttaprootgraftroot4422138
layout: video
order_index: null
parent_uid: 6396b119dea1934ebbe339b1c3062c94
related_resources_text: ''
short_url: lec16-mast-taproot-graftroot
technical_location: https://ocw.mit.edu/courses/media-arts-and-sciences/mas-s62-cryptocurrency-engineering-and-design-spring-2018/lecture-videos/lec16-mast-taproot-graftroot
template_type: Tabbed
title: 'Lecture 16: MAST, Taproot, Graftroot'
transcript: <p><span m='890'>ANNOUNCER:</span> <span m='935'>The</span> <span m='980'>following</span>
  <span m='1430'>content</span> <span m='1940'>is</span> <span m='2060'>provided</span>
  <span m='2480'>under</span> <span m='2720'>a</span> <span m='2780'>Creative</span>
  <span m='3260'>Commons</span> <span m='3650'>license.</span> <span m='4650'>Your</span>
  <span m='4730'>support</span> <span m='5240'>will</span> <span m='5390'>help</span>
  <span m='5660'>MIT</span> <span m='6110'>OpenCourseWare</span> <span m='6860'>continue</span>
  <span m='7340'>to</span> <span m='7490'>offer</span> <span m='7820'>high-quality</span>
  <span m='8540'>educational</span> <span m='9200'>resources</span> <span m='9770'>for</span>
  <span m='9890'>free.</span> <span m='10950'>To</span> <span m='10970'>make</span>
  <span m='11180'>a</span> <span m='11240'>donation,</span> <span m='11990'>or</span>
  <span m='12140'>to</span> <span m='12260'>view</span> <span m='12500'>additional</span>
  <span m='12890'>materials</span> <span m='13490'>from</span> <span m='13700'>hundreds</span>
  <span m='14030'>of</span> <span m='14120'>MIT</span> <span m='14510'>courses,</span>
  <span m='15810'>visit</span> <span m='16010'>MITOpenCourseWare</span> <span m='17105'>at</span>
  <span m='17870'>ocw.mit.edu.</span> </p><p><span m='22420'>TADGE DRYJA:</span> <span
  m='22525'>So</span> <span m='22630'>today</span> <span m='23780'>I'm</span> <span
  m='23970'>going</span> <span m='24030'>to</span> <span m='24140'>talk</span> <span
  m='24310'>about</span> <span m='24550'>MAST,</span> <span m='25410'>taproot,</span>
  <span m='26110'>and</span> <span m='27130'>graftroot.</span> <span m='28300'>And</span>
  <span m='28420'>these</span> <span m='28600'>are</span> <span m='28660'>pretty</span>
  <span m='28840'>cool</span> <span m='29230'>new</span> <span m='29620'>ideas</span>
  <span m='30310'>in</span> <span m='30460'>Bitcoin.</span> <span m='31390'>They're</span>
  <span m='31540'>not</span> <span m='31810'>really</span> <span m='33610'>production</span>
  <span m='34120'>ready.</span> <span m='34600'>They're</span> <span m='34780'>still</span>
  <span m='35200'>sort</span> <span m='35500'>of</span> <span m='36280'>ideas,</span>
  <span m='38410'>but</span> <span m='38680'>it's</span> <span m='38800'>kind</span>
  <span m='39010'>of</span> <span m='39130'>neat</span> <span m='39430'>to</span>
  <span m='39550'>look</span> <span m='39730'>at</span> <span m='40230'>the</span>
  <span m='40510'>future</span> <span m='40810'>directions</span> <span m='41920'>of</span>
  <span m='42310'>how</span> <span m='42490'>people</span> <span m='43030'>are</span>
  <span m='43240'>thinking</span> <span m='43660'>about</span> <span m='44080'>improving</span>
  <span m='45040'>these</span> <span m='45250'>protocols.</span> <span m='45970'>So</span>
  <span m='46090'>we're</span> <span m='46180'>going</span> <span m='46240'>to</span>
  <span m='46300'>talk</span> <span m='46420'>about</span> <span m='46780'>new</span>
  <span m='47110'>types</span> <span m='47590'>of</span> <span m='47710'>scripts--</span>
  <span m='49110'>MAST,</span> <span m='49650'>taproot,</span> <span m='50350'>and</span>
  <span m='50590'>graftroot--</span> <span m='51730'>and</span> <span m='52000'>all</span>
  <span m='52180'>those</span> <span m='52360'>sort</span> <span m='52570'>of</span>
  <span m='52720'>interactions</span> <span m='53500'>between</span> <span m='53800'>these</span>
  <span m='53980'>three</span> <span m='54160'>things.</span> <span m='55450'>I</span>
  <span m='55680'>will</span> <span m='55800'>define</span> <span m='56100'>these,</span>
  <span m='56280'>of</span> <span m='56370'>course.</span> </p><p><span m='58420'>So</span>
  <span m='58570'>so</span> <span m='58750'>far</span> <span m='59650'>we've</span>
  <span m='59860'>talked</span> <span m='60100'>about</span> <span m='60340'>scripts.</span>
  <span m='61120'>And</span> <span m='62020'>you've</span> <span m='62140'>got</span>
  <span m='62350'>up</span> <span m='62530'>codes.</span> <span m='63040'>You've</span>
  <span m='63160'>got</span> <span m='63330'>a</span> <span m='63400'>stack.</span>
  <span m='64330'>I</span> <span m='64450'>think</span> <span m='64690'>with</span>
  <span m='64840'>the</span> <span m='64930'>homework</span> <span m='66940'>people</span>
  <span m='67210'>sort</span> <span m='67360'>of</span> <span m='67420'>got</span>
  <span m='67570'>the</span> <span m='67690'>idea,</span> <span m='68050'>OK,</span>
  <span m='68260'>I</span> <span m='68320'>can</span> <span m='68410'>do</span> <span
  m='68620'>OP_RETURN.</span> <span m='69280'>I</span> <span m='69340'>can</span>
  <span m='69430'>do</span> <span m='69580'>OP_CHECKSIG,</span> <span m='72430'>and</span>
  <span m='72550'>the</span> <span m='72670'>basic</span> <span m='73030'>idea</span>
  <span m='73270'>of</span> <span m='73330'>how</span> <span m='73420'>it</span> <span
  m='73480'>works.</span> </p><p><span m='74740'>So</span> <span m='74920'>right</span>
  <span m='75190'>now</span> <span m='75640'>in</span> <span m='75880'>Bitcoin,</span>
  <span m='76720'>it's</span> <span m='76900'>mostly</span> <span m='78190'>pay</span>
  <span m='78400'>to</span> <span m='78550'>pubkey</span> <span m='79000'>hash.</span>
  <span m='79270'>So</span> <span m='79450'>most</span> <span m='79750'>of</span>
  <span m='79840'>the</span> <span m='79930'>scripts</span> <span m='80230'>that</span>
  <span m='80350'>you'll</span> <span m='80500'>see--</span> <span m='80740'>mostly,</span>
  <span m='81070'>output</span> <span m='81370'>scripts</span> <span m='82040'>in</span>
  <span m='82150'>an</span> <span m='82240'>output</span> <span m='82870'>look</span>
  <span m='83020'>like</span> <span m='83170'>this.</span> <span m='84140'>OP_DUP,</span>
  <span m='84740'>OP_HASH160,</span> <span m='86110'>thumb</span> <span m='86470'>pubkey</span>
  <span m='86890'>hash</span> <span m='87820'>OP_EQUALVERIFY,</span> <span m='88790'>OP_CHECKSIG.</span>
  </p><p><span m='90160'>And</span> <span m='90310'>then</span> <span m='90430'>when</span>
  <span m='90580'>you</span> <span m='90700'>want</span> <span m='90910'>to</span>
  <span m='91420'>execute</span> <span m='91840'>the</span> <span m='91960'>script,</span>
  <span m='92740'>you</span> <span m='92920'>put</span> <span m='93400'>a</span> <span
  m='93520'>pubkey</span> <span m='94570'>and</span> <span m='94780'>a</span> <span
  m='94870'>signature</span> <span m='96580'>as</span> <span m='96700'>your</span>
  <span m='96850'>input.</span> <span m='97990'>It</span> <span m='98230'>duplicates</span>
  <span m='99040'>the</span> <span m='99160'>pubkey,</span> <span m='100420'>hashes</span>
  <span m='100930'>it,</span> <span m='102010'>pushes</span> <span m='102520'>this</span>
  <span m='102790'>hash</span> <span m='103330'>onto</span> <span m='103660'>it,</span>
  <span m='104320'>checks</span> <span m='104650'>that</span> <span m='104770'>those</span>
  <span m='104980'>two</span> <span m='105100'>things</span> <span m='105340'>are</span>
  <span m='105430'>equal.</span> <span m='107110'>And</span> <span m='107290'>this</span>
  <span m='107470'>also</span> <span m='108010'>removes</span> <span m='108520'>those</span>
  <span m='108730'>two</span> <span m='108880'>things,</span> <span m='109180'>leaving</span>
  <span m='109480'>only</span> <span m='109690'>the</span> <span m='109780'>signature,</span>
  <span m='110290'>and</span> <span m='110410'>then</span> <span m='110500'>checks</span>
  <span m='110740'>the</span> <span m='110800'>signature.</span> </p><p><span m='111740'>So</span>
  <span m='111790'>if</span> <span m='111910'>they're</span> <span m='112030'>not</span>
  <span m='112240'>equal--</span> <span m='112690'>if</span> <span m='112810'>you</span>
  <span m='113140'>try</span> <span m='113390'>to</span> <span m='113470'>sign</span>
  <span m='113770'>with</span> <span m='113920'>a</span> <span m='113980'>different</span>
  <span m='114370'>pubkey</span> <span m='114850'>than</span> <span m='115030'>the</span>
  <span m='115120'>one</span> <span m='115360'>that</span> <span m='115600'>is</span>
  <span m='115750'>committed</span> <span m='116080'>to</span> <span m='116200'>in</span>
  <span m='116290'>this</span> <span m='116440'>pubkey</span> <span m='116710'>hash,</span>
  <span m='117310'>it'll</span> <span m='117550'>fail</span> <span m='118150'>at</span>
  <span m='118390'>this</span> <span m='118750'>point.</span> <span m='119680'>And</span>
  <span m='119980'>if</span> <span m='120070'>you</span> <span m='120130'>put</span>
  <span m='120310'>the</span> <span m='120400'>right</span> <span m='120790'>pubkey</span>
  <span m='121180'>but</span> <span m='121300'>the</span> <span m='121390'>wrong</span>
  <span m='121630'>signature,</span> <span m='122050'>it'll</span> <span m='122230'>fail</span>
  <span m='122470'>at</span> <span m='122530'>this</span> <span m='122680'>point.</span>
  <span m='125200'>Well,</span> <span m='125470'>it'll</span> <span m='126220'>the</span>
  <span m='126340'>CHECKSIG</span> <span m='126730'>will</span> <span m='126850'>fail,</span>
  <span m='127600'>put</span> <span m='127810'>a</span> <span m='127840'>0</span>
  <span m='128169'>on</span> <span m='128289'>the</span> <span m='128380'>stack.</span>
  <span m='128770'>And</span> <span m='128889'>then</span> <span m='129039'>the</span>
  <span m='129310'>stack</span> <span m='129580'>will</span> <span m='129699'>have</span>
  <span m='129820'>a</span> <span m='129850'>0</span> <span m='130240'>on</span> <span
  m='130389'>it,</span> <span m='130570'>and</span> <span m='130660'>that'll</span>
  <span m='130900'>fail.</span> <span m='131860'>Verify</span> <span m='132460'>means,</span>
  <span m='132910'>immediately</span> <span m='133390'>fail,</span> <span m='134170'>if</span>
  <span m='134290'>these</span> <span m='134440'>things</span> <span m='134650'>are</span>
  <span m='134710'>not</span> <span m='134890'>equal.</span> </p><p><span m='136310'>And</span>
  <span m='136490'>then</span> <span m='137000'>in</span> <span m='137220'>segwit,</span>
  <span m='138050'>they</span> <span m='138380'>templated</span> <span m='139070'>it.</span>
  <span m='139430'>So</span> <span m='139670'>really,</span> <span m='140090'>this</span>
  <span m='140360'>entire</span> <span m='140780'>script</span> <span m='141200'>became</span>
  <span m='142190'>OP_0,</span> <span m='142550'>pubkey</span> <span m='143160'>hash,</span>
  <span m='143870'>which</span> <span m='144020'>is</span> <span m='144110'>confusing.</span>
  <span m='145160'>If</span> <span m='145280'>you</span> <span m='145340'>don't</span>
  <span m='145490'>know</span> <span m='145610'>what</span> <span m='145790'>that</span>
  <span m='145970'>means--</span> <span m='146760'>wait,</span> <span m='147440'>OP_0</span>
  <span m='148010'>means</span> <span m='148790'>just</span> <span m='149360'>put</span>
  <span m='149600'>a</span> <span m='149630'>0</span> <span m='149960'>on</span> <span
  m='150050'>the</span> <span m='150110'>stack,</span> <span m='151010'>and</span>
  <span m='151130'>then</span> <span m='151370'>put</span> <span m='151580'>a</span>
  <span m='151610'>pubkey hash</span> <span m='152240'>on</span> <span m='152360'>the</span>
  <span m='152420'>stack,</span> <span m='152870'>and</span> <span m='153290'>anyone</span>
  <span m='153650'>can</span> <span m='153800'>spend</span> <span m='154010'>this.</span>
  </p><p><span m='154880'>But</span> <span m='155030'>the</span> <span m='155150'>idea</span>
  <span m='155360'>in</span> <span m='155450'>segwit</span> <span m='155810'>is,</span>
  <span m='155930'>yes,</span> <span m='157130'>software</span> <span m='157550'>that</span>
  <span m='157700'>is</span> <span m='157790'>not</span> <span m='158000'>aware</span>
  <span m='158240'>of</span> <span m='158380'>segwit</span> <span m='158830'>will</span>
  <span m='159080'>see</span> <span m='159320'>this</span> <span m='159650'>as</span>
  <span m='160280'>spendable</span> <span m='160730'>by</span> <span m='160910'>anyone</span>
  <span m='161300'>without</span> <span m='161600'>a</span> <span m='161660'>signature.</span>
  <span m='162830'>Software</span> <span m='163200'>that</span> <span m='163370'>is</span>
  <span m='163810'>aware</span> <span m='164080'>of</span> <span m='164290'>segwit</span>
  <span m='164600'>knows</span> <span m='165080'>that</span> <span m='165650'>these</span>
  <span m='166040'>two</span> <span m='166310'>things</span> <span m='166730'>are</span>
  <span m='166880'>the</span> <span m='167030'>same.</span> <span m='167450'>So</span>
  <span m='167660'>essentially,</span> <span m='168050'>if</span> <span m='168260'>you</span>
  <span m='168410'>see</span> <span m='168650'>this,</span> <span m='169670'>turn</span>
  <span m='170030'>it</span> <span m='170120'>into</span> <span m='170390'>this.</span>
  </p><p><span m='171380'>Take</span> <span m='171740'>the</span> <span m='171950'>pubkey</span>
  <span m='172310'>hash</span> <span m='173300'>and</span> <span m='173930'>fill</span>
  <span m='174230'>in</span> <span m='174440'>these</span> <span m='174710'>OP</span>
  <span m='174860'>codes.</span> <span m='175310'>And</span> <span m='175430'>that's</span>
  <span m='175610'>actually</span> <span m='175880'>what</span> <span m='176000'>the</span>
  <span m='176090'>code</span> <span m='176300'>does,</span> <span m='177080'>for</span>
  <span m='177230'>the</span> <span m='177320'>script</span> <span m='177590'>interpreter.</span>
  <span m='178370'>It</span> <span m='178420'>will</span> <span m='178520'>say,</span>
  <span m='178760'>oh,</span> <span m='179030'>it</span> <span m='179150'>matches</span>
  <span m='179570'>this</span> <span m='179780'>template.</span> <span m='180650'>It's</span>
  <span m='181010'>OP_0</span> <span m='181700'>and</span> <span m='181820'>a</span>
  <span m='181880'>20-byte</span> <span m='182810'>piece</span> <span m='182990'>of</span>
  <span m='183050'>data.</span> <span m='183860'>Turn</span> <span m='184130'>it</span>
  <span m='184250'>into</span> <span m='184460'>this,</span> <span m='184940'>and</span>
  <span m='185060'>then</span> <span m='185180'>execute</span> <span m='185600'>it.</span>
  <span m='186710'>So</span> <span m='187190'>in</span> <span m='187310'>this</span>
  <span m='187460'>way,</span> <span m='187640'>segwit</span> <span m='188030'>saves</span>
  <span m='188330'>three</span> <span m='188510'>bytes.</span> <span m='189140'>Because</span>
  <span m='189740'>now</span> <span m='189890'>you</span> <span m='189980'>have</span>
  <span m='190100'>one</span> <span m='190250'>byte</span> <span m='190460'>there</span>
  <span m='190670'>instead</span> <span m='190940'>of</span> <span m='191210'>1,</span>
  <span m='191410'>2,</span> <span m='191610'>3,</span> <span m='191870'>4.</span>
  <span m='193790'>You</span> <span m='193940'>lose</span> <span m='194330'>a</span>
  <span m='194390'>couple</span> <span m='194720'>more</span> <span m='194960'>bytes</span>
  <span m='195530'>elsewhere</span> <span m='195890'>in</span> <span m='195980'>segwit,</span>
  <span m='196270'>so</span> <span m='196370'>it</span> <span m='196460'>actually</span>
  <span m='196880'>tends</span> <span m='197150'>to</span> <span m='197240'>lose</span>
  <span m='197450'>a</span> <span m='197600'>couple</span> <span m='197790'>of</span>
  <span m='197840'>bytes.</span> <span m='198110'>But</span> <span m='198260'>whatever.</span>
  </p><p><span m='199770'>So</span> <span m='199920'>this</span> <span m='201330'>works.</span>
  <span m='201630'>This</span> <span m='201780'>makes</span> <span m='201930'>sense.</span>
  <span m='202450'>Any</span> <span m='202530'>questions</span> <span m='202860'>about</span>
  <span m='203160'>pay to</span> <span m='203450'>pubkey</span> <span m='203850'>hash?</span>
  <span m='205350'>It</span> <span m='205740'>works</span> <span m='206010'>OK?</span>
  </p><p><span m='207480'>And</span> <span m='207570'>there's</span> <span m='207750'>also</span>
  <span m='208820'>pay</span> <span m='209040'>to</span> <span m='209220'>script</span>
  <span m='209610'>hash.</span> <span m='210570'>This</span> <span m='210780'>is</span>
  <span m='210930'>the</span> <span m='211050'>other</span> <span m='211260'>thing</span>
  <span m='211440'>you'll</span> <span m='211590'>see</span> <span m='211770'>quite</span>
  <span m='211980'>a</span> <span m='212040'>bit</span> <span m='212190'>of</span>
  <span m='212580'>in</span> <span m='212700'>Bitcoin</span> <span m='213030'>today.</span>
  <span m='215250'>I</span> <span m='215310'>don't</span> <span m='215430'>know</span>
  <span m='215520'>what</span> <span m='215640'>the</span> <span m='215700'>ratios</span>
  <span m='216150'>are.</span> <span m='216630'>80%</span> <span m='217380'>pay</span>
  <span m='217630'>to</span> <span m='217680'>pubkey</span> <span m='218010'>hash,</span>
  <span m='218250'>20%</span> <span m='218870'>pay</span> <span m='219010'>to</span>
  <span m='219120'>script</span> <span m='219360'>hash--</span> <span m='220170'>something</span>
  <span m='220470'>like</span> <span m='220680'>that.</span> <span m='221730'>So a</span>
  <span m='222120'>minority,</span> <span m='222660'>but</span> <span m='223260'>significant.</span>
  </p><p><span m='225510'>And</span> <span m='227500'>for</span> <span m='227700'>pay</span>
  <span m='227890'>to</span> <span m='227940'>script</span> <span m='228330'>hash,</span>
  <span m='228720'>it</span> <span m='228840'>looks</span> <span m='229050'>like</span>
  <span m='229170'>this--</span> <span m='229830'>also</span> <span m='230250'>sort</span>
  <span m='230490'>of</span> <span m='230610'>template-y,</span> <span m='231270'>right?</span>
  <span m='232000'>OP_HASH160,</span> <span m='233370'>a</span> <span m='233490'>script</span>
  <span m='233790'>hash,</span> <span m='234470'>OP_EQUAL.</span> <span m='235260'>That's</span>
  <span m='235500'>it.</span> <span m='237000'>This</span> <span m='237240'>also</span>
  <span m='237600'>seems</span> <span m='237900'>like,</span> <span m='238050'>wait,</span>
  <span m='238830'>all</span> <span m='239010'>I</span> <span m='239100'>have</span>
  <span m='239280'>to</span> <span m='239370'>do</span> <span m='239970'>is</span>
  <span m='240180'>provide</span> <span m='240870'>a</span> <span m='241020'>pre-image</span>
  <span m='242130'>of</span> <span m='242250'>this,</span> <span m='243060'>and</span>
  <span m='243150'>then</span> <span m='243240'>I'll</span> <span m='243330'>be</span>
  <span m='243450'>able</span> <span m='243570'>to</span> <span m='243630'>spend</span>
  <span m='243810'>the</span> <span m='243900'>coins.</span> <span m='245070'>But</span>
  <span m='245670'>the</span> <span m='246060'>script</span> <span m='246360'>interpreter</span>
  <span m='246780'>knows--</span> <span m='247110'>no,</span> <span m='247470'>actually</span>
  <span m='248070'>what</span> <span m='248280'>this</span> <span m='248520'>means--</span>
  <span m='249050'>if</span> <span m='249180'>you</span> <span m='249270'>see</span>
  <span m='249570'>this</span> <span m='249930'>template,</span> <span m='250410'>if</span>
  <span m='250500'>you</span> <span m='250560'>see</span> <span m='250710'>this</span>
  <span m='250830'>format--</span> <span m='252210'>verify</span> <span m='252810'>that</span>
  <span m='252960'>this</span> <span m='253140'>is</span> <span m='253230'>equal,</span>
  <span m='253860'>and</span> <span m='254070'>then</span> <span m='254760'>execute</span>
  <span m='255360'>whatever</span> <span m='255720'>the</span> <span m='255810'>pre-image</span>
  <span m='256230'>was,</span> <span m='256800'>as</span> <span m='256950'>a</span>
  <span m='257010'>script.</span> </p><p><span m='258779'>So</span> <span m='258990'>actually</span>
  <span m='259230'>the</span> <span m='259320'>first</span> <span m='259589'>time</span>
  <span m='259800'>I</span> <span m='259890'>started</span> <span m='260279'>programming</span>
  <span m='260790'>Bitcoin</span> <span m='261089'>stuff,</span> <span m='261420'>I</span>
  <span m='261510'>did</span> <span m='261630'>not</span> <span m='262019'>know</span>
  <span m='262530'>about</span> <span m='262770'>pay</span> <span m='262950'>to</span>
  <span m='263010'>script</span> <span m='263260'>hash,</span> <span m='264090'>and</span>
  <span m='264240'>I</span> <span m='264300'>was</span> <span m='264420'>just</span>
  <span m='264540'>trying</span> <span m='264720'>to</span> <span m='264810'>make</span>
  <span m='264930'>my</span> <span m='265080'>own</span> <span m='265200'>transactions.</span>
  <span m='266400'>And</span> <span m='266580'>I</span> <span m='266640'>used</span>
  <span m='266910'>this.</span> <span m='267240'>I</span> <span m='267360'>just</span>
  <span m='267510'>said,</span> <span m='267630'>well,</span> <span m='267840'>I</span>
  <span m='267960'>want</span> <span m='268140'>to</span> <span m='268200'>see</span>
  <span m='268380'>that</span> <span m='268500'>I</span> <span m='268590'>can</span>
  <span m='268950'>get</span> <span m='269850'>the</span> <span m='269940'>script</span>
  <span m='270210'>to</span> <span m='270270'>execute</span> <span m='270690'>right.</span>
  <span m='271290'>I'll</span> <span m='271440'>just</span> <span m='271890'>take</span>
  <span m='272130'>a</span> <span m='272160'>random</span> <span m='272460'>number,</span>
  <span m='273060'>hash</span> <span m='273450'>it,</span> <span m='274590'>put</span>
  <span m='274800'>it</span> <span m='274890'>into</span> <span m='275100'>this</span>
  <span m='275310'>thing,</span> <span m='275580'>and</span> <span m='275700'>try</span>
  <span m='275850'>to</span> <span m='275940'>spend</span> <span m='276180'>it.</span>
  <span m='276270'>And</span> <span m='276390'>it</span> <span m='276630'>never</span>
  <span m='276870'>worked,</span> <span m='277260'>and</span> <span m='277410'>I</span>
  <span m='278220'>didn't</span> <span m='278490'>know</span> <span m='278640'>why.</span>
  <span m='279070'>And</span> <span m='279170'>then</span> <span m='279180'>a</span>
  <span m='279240'>few</span> <span m='279390'>days</span> <span m='279570'>later,</span>
  <span m='280470'>I</span> <span m='280560'>read</span> <span m='280710'>about</span>
  <span m='280950'>pay</span> <span m='281060'>to</span> <span m='281160'>script</span>
  <span m='281410'>hash.</span> </p><p><span m='282450'>Wait,</span> <span m='282690'>it</span>
  <span m='282780'>wasn't</span> <span m='283030'>days</span> <span m='283230'>later.</span>
  <span m='283590'>I</span> <span m='283710'>just</span> <span m='283890'>put</span>
  <span m='284100'>an</span> <span m='284250'>OP.</span> <span m='285030'>I</span>
  <span m='285090'>put</span> <span m='285270'>an</span> <span m='285450'>OP,</span>
  <span m='285750'>no</span> <span m='285990'>OP,</span> <span m='287030'>OP_HASH160,</span>
  <span m='287410'>script</span> <span m='287670'>hash,</span> <span m='287940'>OP_EQUAL.</span>
  <span m='288360'>And</span> <span m='288480'>then</span> <span m='288630'>it</span>
  <span m='288720'>worked.</span> <span m='289050'>And</span> <span m='289140'>I</span>
  <span m='289170'>was</span> <span m='289260'>like,</span> <span m='289500'>OK,</span>
  <span m='289610'>I don't know how</span> <span m='289920'>Bitcoin</span> <span m='290370'>works.</span>
  <span m='291040'>This</span> <span m='291200'>doesn't</span> <span m='291420'>make</span>
  <span m='291570'>any</span> <span m='291690'>sense.</span> <span m='292540'>I</span>
  <span m='292640'>put</span> <span m='292680'>a</span> <span m='292740'>no</span>
  <span m='292980'>OP,</span> <span m='293250'>and</span> <span m='293370'>then</span>
  <span m='293550'>it</span> <span m='293820'>starts</span> <span m='294150'>working.</span>
  </p><p><span m='295680'>And</span> <span m='295800'>then</span> <span m='296580'>a</span>
  <span m='296640'>few</span> <span m='297090'>days</span> <span m='297360'>later</span>
  <span m='297630'>I</span> <span m='297720'>read</span> <span m='298050'>about</span>
  <span m='298390'>pay to</span> <span m='298590'>script</span> <span m='298860'>hash,</span>
  <span m='299160'>and</span> <span m='299310'>it</span> <span m='299370'>was,</span>
  <span m='299770'>oh,</span> <span m='300490'>this</span> <span m='300750'>actually</span>
  <span m='301140'>has</span> <span m='301290'>a</span> <span m='301350'>special</span>
  <span m='301650'>meaning.</span> <span m='302070'>This</span> <span m='302250'>is</span>
  <span m='302340'>a</span> <span m='302400'>template</span> <span m='302880'>where</span>
  <span m='303750'>if</span> <span m='303870'>you</span> <span m='304260'>HASH160,</span>
  <span m='305200'>a</span> <span m='305390'>bunch</span> <span m='305610'>of</span>
  <span m='305670'>data,</span> <span m='306240'>and</span> <span m='306560'>OP_EQUAL,</span>
  <span m='307410'>then</span> <span m='307590'>it</span> <span m='307830'>interprets</span>
  <span m='308430'>the</span> <span m='308520'>pre-image</span> <span m='309000'>as</span>
  <span m='309120'>a</span> <span m='309180'>script.</span> <span m='310950'>Does</span>
  <span m='311100'>it</span> <span m='311220'>have</span> <span m='311400'>to</span>
  <span m='311520'>be</span> <span m='311640'>20</span> <span m='311940'>bytes,</span>
  <span m='312270'>probably?</span> <span m='313130'>Yeah,</span> <span m='313680'>I</span>
  <span m='313740'>don't</span> <span m='313860'>know.</span> </p><p><span m='315910'>There's</span>
  <span m='316230'>actually</span> <span m='317100'>a</span> <span m='317460'>vulnerability</span>
  <span m='318510'>here.</span> <span m='320340'>How</span> <span m='320640'>pay to</span>
  <span m='320930'>script</span> <span m='321180'>hash</span> <span m='321420'>got</span>
  <span m='321630'>introduced</span> <span m='322230'>is</span> <span m='322350'>sort</span>
  <span m='322560'>of</span> <span m='322680'>an</span> <span m='322770'>interesting</span>
  <span m='323370'>debate.</span> <span m='323850'>There</span> <span m='324000'>was</span>
  <span m='324300'>OP_EVAL,</span> <span m='325750'>pay</span> <span m='326210'>to</span>
  <span m='326400'>script</span> <span m='326670'>hash--</span> <span m='326880'>a</span>
  <span m='326910'>bunch</span> <span m='327150'>of</span> <span m='327390'>argument</span>
  <span m='327930'>about</span> <span m='328290'>it.</span> <span m='328590'>And</span>
  <span m='328710'>this</span> <span m='328890'>was</span> <span m='329040'>in</span>
  <span m='329220'>2012,</span> <span m='330270'>I</span> <span m='330360'>think,</span>
  <span m='330810'>or</span> <span m='331020'>'11.</span> <span m='332310'>And</span>
  <span m='335130'>it</span> <span m='335250'>was</span> <span m='335400'>sort</span>
  <span m='335640'>of</span> <span m='335700'>contentious,</span> <span m='336270'>and</span>
  <span m='336360'>people</span> <span m='336630'>argue</span> <span m='336880'>about</span>
  <span m='337050'>it.</span> </p><p><span m='337140'>And</span> <span m='337830'>in</span>
  <span m='337980'>retrospect</span> <span m='338610'>this</span> <span m='338760'>is</span>
  <span m='338850'>actually</span> <span m='339540'>insecure</span> <span m='340770'>because</span>
  <span m='342300'>you're</span> <span m='342540'>using</span> <span m='343140'>OP_HASH160</span>
  <span m='343440'>160,</span> <span m='344220'>which</span> <span m='344400'>is</span>
  <span m='344470'>160-byte</span> <span m='345480'>hash</span> <span m='345690'>function.</span>
  <span m='346110'>It's</span> <span m='346230'>basically</span> <span m='346620'>SHA-256</span>
  <span m='347940'>followed</span> <span m='348420'>by</span> <span m='348750'>RIPEMD-160.</span>
  <span m='352560'>This</span> <span m='352860'>is</span> <span m='352980'>not</span>
  <span m='353250'>big</span> <span m='353520'>enough.</span> <span m='354760'>You're</span>
  <span m='354900'>committing</span> <span m='355350'>to</span> <span m='355860'>a</span>
  <span m='355920'>script</span> <span m='356190'>hash,</span> <span m='356500'>which</span>
  <span m='356580'>is</span> <span m='356670'>20</span> <span m='356910'>bytes.</span>
  </p><p><span m='358320'>So</span> <span m='358470'>normally</span> <span m='358860'>you're</span>
  <span m='358980'>like,</span> <span m='359260'>yeah,</span> <span m='359460'>whatever,</span>
  <span m='359590'>160</span> <span m='360180'>bits</span> <span m='361710'>is</span>
  <span m='361830'>plenty.</span> <span m='363840'>You</span> <span m='364080'>can</span>
  <span m='364290'>have</span> <span m='364530'>collision</span> <span m='364980'>attacks,</span>
  <span m='365730'>where</span> <span m='366300'>if</span> <span m='366420'>you're</span>
  <span m='366540'>doing</span> <span m='366840'>multisig</span> <span m='367440'>with</span>
  <span m='367590'>someone</span> <span m='367860'>else,</span> <span m='368550'>they</span>
  <span m='368700'>may</span> <span m='368910'>be</span> <span m='369090'>able</span>
  <span m='369300'>to</span> <span m='369390'>calculate</span> <span m='370260'>different</span>
  <span m='370590'>pubkeys,</span> <span m='371760'>so</span> <span m='372330'>that</span>
  <span m='372930'>your</span> <span m='373280'>pubkey--</span> <span m='374880'>they</span>
  <span m='375030'>have</span> <span m='375210'>a</span> <span m='375240'>collision</span>
  <span m='375690'>where</span> <span m='375840'>two</span> <span m='376230'>different</span>
  <span m='377700'>20-byte</span> <span m='378420'>scripts</span> <span m='378990'>hash</span>
  <span m='379290'>to</span> <span m='379410'>the</span> <span m='379500'>same</span>
  <span m='379770'>thing.</span> <span m='380250'>Sorry,</span> <span m='380550'>two</span>
  <span m='380700'>different</span> <span m='380970'>scripts,</span> <span m='381570'>hashed</span>
  <span m='381780'>to</span> <span m='381840'>the</span> <span m='381930'>same</span>
  <span m='382140'>20</span> <span m='382380'>bytes.</span> <span m='384510'>This</span>
  <span m='384690'>is</span> <span m='384780'>possible</span> <span m='385140'>because</span>
  <span m='385380'>that's</span> <span m='385530'>only</span> <span m='385740'>2</span>
  <span m='385930'>to</span> <span m='386030'>the</span> <span m='386130'>80</span>
  <span m='386400'>work</span> <span m='387420'>which</span> <span m='387900'>is</span>
  <span m='388620'>still</span> <span m='388920'>a</span> <span m='388980'>lot.</span>
  <span m='389830'>And</span> <span m='389880'>used</span> <span m='390240'>to</span>
  <span m='390330'>be</span> <span m='390480'>considered</span> <span m='390960'>like,</span>
  <span m='391170'>no</span> <span m='391320'>one</span> <span m='391410'>can</span>
  <span m='391530'>do--</span> <span m='391680'>2</span> <span m='391770'>to</span>
  <span m='391950'>the</span> <span m='392100'>80</span> <span m='392290'>is</span>
  <span m='392700'>beyond</span> <span m='393240'>any</span> <span m='393720'>human</span>
  <span m='394590'>endeavor.</span> <span m='395400'>But</span> <span m='395610'>Bitcoin</span>
  <span m='396120'>does</span> <span m='396240'>2 to</span> <span m='396320'>the</span>
  <span m='396390'>80</span> <span m='396570'>work</span> <span m='396780'>every</span>
  <span m='397530'>day,</span> <span m='398450'>hour.</span> <span m='398970'>I</span>
  <span m='399030'>don't</span> <span m='399150'>know,</span> <span m='399360'>something</span>
  <span m='400080'>fairly</span> <span m='400440'>reasonable.</span> </p><p><span
  m='401310'>So</span> <span m='402180'>it's</span> <span m='402330'>like,</span>
  <span m='402450'>wait,</span> <span m='402660'>2 to</span> <span m='402900'>the</span>
  <span m='403020'>80</span> <span m='403280'>is</span> <span m='403350'>not</span>
  <span m='403500'>enough.</span> <span m='405060'>For</span> <span m='405570'>the</span>
  <span m='405690'>same</span> <span m='405960'>security</span> <span m='406440'>as</span>
  <span m='406560'>Bitcoin,</span> <span m='406950'>which</span> <span m='407100'>is</span>
  <span m='407220'>generally</span> <span m='407820'>a</span> <span m='408390'>2</span>
  <span m='408570'>to</span> <span m='408640'>the</span> <span m='408740'>128</span>
  <span m='409350'>security</span> <span m='409740'>parameter,</span> <span m='410520'>we</span>
  <span m='410670'>would</span> <span m='410790'>need</span> <span m='411000'>this</span>
  <span m='411240'>to</span> <span m='411360'>be</span> <span m='412650'>256</span>
  <span m='413370'>bits</span> <span m='413640'>instead</span> <span m='413910'>of</span>
  <span m='413970'>160.</span> <span m='414780'>So</span> <span m='415470'>when</span>
  <span m='416400'>they</span> <span m='416670'>upgraded</span> <span m='417000'>the</span>
  <span m='417060'>segwit</span> <span m='418180'>pay to</span> <span m='418380'>witness</span>
  <span m='418800'>script</span> <span m='419070'>hash,</span> <span m='419970'>this</span>
  <span m='420240'>has</span> <span m='420390'>to</span> <span m='420480'>be</span>
  <span m='420570'>32</span> <span m='420930'>bytes,</span> <span m='422780'>to</span>
  <span m='422990'>eliminate</span> <span m='423500'>any</span> <span m='423710'>of</span>
  <span m='423800'>those</span> <span m='424280'>collision</span> <span m='425120'>vulnerabilities.</span>
  </p><p><span m='426410'>So</span> <span m='426530'>yeah,</span> <span m='426860'>that's</span>
  <span m='427070'>what</span> <span m='427190'>distinguishes</span> <span m='427850'>it.</span>
  <span m='427940'>So</span> <span m='428420'>they</span> <span m='428540'>look</span>
  <span m='428720'>the</span> <span m='428810'>same,</span> <span m='429080'>Right</span>
  <span m='429410'>it's</span> <span m='429560'>just</span> <span m='430160'>OP_0,</span>
  <span m='431030'>piece</span> <span m='431240'>of</span> <span m='431300'>data,</span>
  <span m='432200'>OP_0,</span> <span m='433040'>piece</span> <span m='433250'>of</span>
  <span m='433310'>data.</span> <span m='433790'>But</span> <span m='433970'>they</span>
  <span m='434090'>do</span> <span m='434300'>completely</span> <span m='434750'>different</span>
  <span m='434990'>things</span> <span m='435350'>based</span> <span m='435830'>on</span>
  <span m='436070'>how</span> <span m='436250'>long</span> <span m='436490'>this</span>
  <span m='436640'>data</span> <span m='436820'>is.</span> </p><p><span m='438280'>OK,</span>
  <span m='438560'>so</span> <span m='438680'>that's</span> <span m='438830'>pay</span>
  <span m='438970'>to</span> <span m='439040'>script</span> <span m='439280'>hash.</span>
  <span m='439790'>Any</span> <span m='440030'>questions</span> <span m='440540'>about</span>
  <span m='441170'>the</span> <span m='441260'>basic</span> <span m='441590'>construction?</span>
  </p><p><span m='443570'>OK,</span> <span m='444390'>I</span> <span m='444510'>want</span>
  <span m='444810'>to</span> <span m='445630'>make it</span> <span m='445940'>so</span>
  <span m='446100'>that</span> <span m='446240'>two</span> <span m='446690'>of</span>
  <span m='446820'>these</span> <span m='447120'>three</span> <span m='447360'>keys</span>
  <span m='447810'>must</span> <span m='448110'>sign,</span> <span m='448740'>in</span>
  <span m='448860'>order</span> <span m='449040'>to</span> <span m='449160'>spend</span>
  <span m='449400'>the</span> <span m='449490'>coins.</span> <span m='450480'>So</span>
  <span m='450600'>I</span> <span m='450660'>say,</span> <span m='450930'>OP_2</span>
  <span m='451980'>push</span> <span m='452550'>three</span> <span m='453000'>public</span>
  <span m='453360'>keys</span> <span m='455670'>OP_3,</span> <span m='456370'>OP_CHECKMULTISIG.</span>
  <span m='457380'>So</span> <span m='457530'>the</span> <span m='457620'>idea</span>
  <span m='457860'>is</span> <span m='458340'>two</span> <span m='458820'>of</span>
  <span m='458970'>these</span> <span m='459180'>three</span> <span m='460200'>must</span>
  <span m='460380'>sign.</span> <span m='461180'>So</span> <span m='461220'>you</span>
  <span m='461280'>can</span> <span m='461370'>put</span> <span m='461610'>OP_1,</span>
  <span m='462600'>this</span> <span m='463140'>OP_3.</span> <span m='463470'>You</span>
  <span m='463590'>can</span> <span m='463680'>OP_3--</span> <span m='464520'>this</span>
  <span m='464940'>OP_3.</span> <span m='465630'>If</span> <span m='465750'>you</span>
  <span m='465810'>put</span> <span m='466020'>OP_4,</span> <span m='467220'>three</span>
  <span m='467520'>keys,</span> <span m='467970'>and</span> <span m='468090'>then</span>
  <span m='468330'>OP_3,</span> <span m='468900'>it</span> <span m='469380'>probably</span>
  <span m='469710'>will</span> <span m='469830'>never</span> <span m='470100'>be</span>
  <span m='470400'>spendable</span> <span m='471060'>and</span> <span m='471270'>just</span>
  <span m='471420'>never</span> <span m='471630'>work.</span> <span m='473820'>I'm</span>
  <span m='474000'>pretty</span> <span m='474270'>sure</span> <span m='474420'>you</span>
  <span m='474750'>have</span> <span m='474900'>to</span> <span m='474990'>put</span>
  <span m='475230'>the</span> <span m='475350'>signatures</span> <span m='476010'>in</span>
  <span m='476160'>the</span> <span m='476250'>correct</span> <span m='476760'>order.</span>
  <span m='477370'>So</span> <span m='478110'>when</span> <span m='478260'>you</span>
  <span m='478350'>spend,</span> <span m='478710'>you</span> <span m='478800'>say,</span>
  <span m='479280'>OP_0,</span> <span m='479850'>sigA,</span> <span m='480360'>sigC.</span>
  <span m='481682'>And</span> <span m='482030'>that's</span> <span m='482310'>A,</span>
  <span m='482810'>C.</span> <span m='483210'>If</span> <span m='483390'>you</span>
  <span m='483510'>put</span> <span m='483870'>sigC,</span> <span m='484560'>sigA,</span>
  <span m='484980'>it</span> <span m='485190'>fails.</span> </p><p><span m='488940'>This</span>
  <span m='489150'>is</span> <span m='489300'>a</span> <span m='489330'>fun</span>
  <span m='490440'>little</span> <span m='491040'>part,</span> <span m='491580'>where</span>
  <span m='491970'>you</span> <span m='492180'>have</span> <span m='492420'>to</span>
  <span m='492540'>put</span> <span m='492810'>in</span> <span m='493200'>a</span>
  <span m='493260'>0</span> <span m='493620'>byte</span> <span m='494250'>before</span>
  <span m='494580'>the</span> <span m='494700'>signatures,</span> <span m='495150'>when</span>
  <span m='495300'>you</span> <span m='495360'>want</span> <span m='495510'>to</span>
  <span m='495570'>spend.</span> <span m='496770'>I'm</span> <span m='497220'>not</span>
  <span m='497640'>100%</span> <span m='498270'>sure</span> <span m='498840'>how</span>
  <span m='499140'>that</span> <span m='499290'>got</span> <span m='499530'>in.</span>
  <span m='499960'>It</span> <span m='500010'>was</span> <span m='500470'>a</span>
  <span m='500550'>screw</span> <span m='500850'>up,</span> <span m='501720'>and</span>
  <span m='503010'>we</span> <span m='503160'>just</span> <span m='503280'>live</span>
  <span m='503430'>with</span> <span m='503610'>it</span> <span m='503670'>forever.</span>
  <span m='504912'>[LAUGHS]</span> <span m='505824'>If</span> <span m='506280'>you</span>
  <span m='506370'>don't</span> <span m='506520'>put</span> <span m='506670'>the</span>
  <span m='506880'>OP_0,</span> <span m='507480'>it</span> <span m='507690'>doesn't</span>
  <span m='507960'>work.</span> <span m='508980'>And</span> <span m='509160'>it's</span>
  <span m='509340'>somewhat</span> <span m='509700'>confusing.</span> <span m='510570'>It</span>
  <span m='510690'>wastes</span> <span m='510990'>a</span> <span m='511080'>byte,</span>
  <span m='511410'>which</span> <span m='511590'>is</span> <span m='511680'>not</span>
  <span m='511830'>a</span> <span m='511860'>huge</span> <span m='512100'>deal.</span>
  <span m='512340'>But</span> <span m='512520'>it's</span> <span m='512610'>just</span>
  <span m='512730'>like,</span> <span m='512919'>what?</span> <span m='514720'>And</span>
  <span m='514860'>they</span> <span m='515130'>didn't</span> <span m='515669'>fix</span>
  <span m='515970'>that</span> <span m='516150'>in</span> <span m='516330'>segwit.</span>
  <span m='517650'>It</span> <span m='517770'>just</span> <span m='518480'>stays</span>
  <span m='519210'>in</span> <span m='519330'>there.</span> <span m='519990'>Who</span>
  <span m='520140'>knows</span> <span m='520380'>if</span> <span m='520500'>it'll</span>
  <span m='520679'>ever</span> <span m='520820'>get</span> <span m='521020'>out.</span>
  <span m='521730'>So</span> <span m='522120'>segwit</span> <span m='522210'>was</span>
  <span m='522390'>an</span> <span m='522480'>opportunity</span> <span m='522900'>to</span>
  <span m='522990'>fix</span> <span m='523200'>it.</span> </p><p><span m='523880'>Yes,</span>
  <span m='524070'>go</span> <span m='524340'>ahead.</span> </p><p><span m='524610'>AUDIENCE:</span>
  <span m='524670'>Why</span> <span m='524730'>didn't</span> <span m='524850'>they</span>
  <span m='524940'>just</span> <span m='525120'>update</span> <span m='525455'>that
  pretty</span> <span m='525790'>quickly</span> <span m='526040'>when</span> <span
  m='526210'>they</span> <span m='526650'>realized</span> <span m='527090'>you</span>
  <span m='527220'>have</span> <span m='527340'>to</span> <span m='527440'>put an</span>
  <span m='527560'>OP_0 there?</span> </p><p><span m='527840'>TADGE DRYJA:</span>
  <span m='527910'>Hard</span> <span m='528200'>fork.</span> <span m='530670'>So</span>
  <span m='531180'>you</span> <span m='531330'>put</span> <span m='531510'>this</span>
  <span m='531780'>in.</span> <span m='532200'>And</span> <span m='532590'>you</span>
  <span m='532950'>could</span> <span m='533130'>say,</span> <span m='533280'>wait,</span>
  <span m='533760'>that's</span> <span m='534120'>stupid.</span> <span m='534550'>Wait,</span>
  <span m='534720'>you</span> <span m='534840'>need</span> <span m='534990'>a</span>
  <span m='535050'>0</span> <span m='535350'>in</span> <span m='535470'>front</span>
  <span m='535800'>when</span> <span m='535980'>you</span> <span m='536070'>put</span>
  <span m='536190'>the</span> <span m='536280'>signatures?</span> <span m='537130'>Let's</span>
  <span m='537210'>get</span> <span m='537360'>rid</span> <span m='537540'>of</span>
  <span m='537600'>that.</span> <span m='538130'>So</span> <span m='538650'>now</span>
  <span m='539970'>the</span> <span m='540150'>old</span> <span m='540420'>software</span>
  <span m='540840'>says,</span> <span m='541050'>no,</span> <span m='541620'>I</span>
  <span m='541770'>need</span> <span m='541980'>a</span> <span m='542040'>0</span>
  <span m='542460'>here.</span> <span m='543510'>And</span> <span m='543930'>then</span>
  <span m='544440'>if</span> <span m='544880'>you</span> <span m='544950'>don't</span>
  <span m='545100'>put</span> <span m='545220'>the</span> <span m='545310'>0,</span>
  <span m='545700'>and</span> <span m='545790'>you</span> <span m='545850'>just</span>
  <span m='545970'>put</span> <span m='546120'>the</span> <span m='546190'>two</span>
  <span m='546360'>signatures,</span> <span m='546990'>I</span> <span m='547080'>fail</span>
  <span m='547560'>this</span> <span m='547710'>script.</span> </p><p><span m='548550'>AUDIENCE:</span>
  <span m='548610'>[INAUDIBLE]</span> <span m='548670'>doesn't</span> <span m='548820'>have
  to be a</span> <span m='549320'>0</span> <span m='549820'>until</span> <span m='550320'>the</span>
  <span m='550720'>[INAUDIBLE]?</span> </p><p><span m='550910'>TADGE DRYJA:</span>
  <span m='551020'>Right.</span> <span m='551130'>It</span> <span m='551220'>could</span>
  <span m='551370'>be</span> <span m='551520'>anything.</span> <span m='552630'>It</span>
  <span m='552690'>could</span> <span m='552840'>just</span> <span m='552990'>be</span>
  <span m='553650'>any</span> <span m='554910'>data.</span> <span m='557370'>And</span>
  <span m='557880'>it</span> <span m='557970'>was</span> <span m='558090'>like</span>
  <span m='558210'>any</span> <span m='558390'>data</span> <span m='559500'>the</span>
  <span m='559560'>stack</span> <span m='559800'>would</span> <span m='559920'>get</span>
  <span m='560520'>popped</span> <span m='560760'>off.</span> <span m='562200'>And</span>
  <span m='562410'>then</span> <span m='564030'>the</span> <span m='564130'>two</span>
  <span m='564280'>signatures.</span> <span m='564770'>So</span> <span m='564850'>if</span>
  <span m='564940'>you</span> <span m='565030'>said,</span> <span m='565240'>let's</span>
  <span m='565450'>eliminate</span> <span m='565810'>that</span> <span m='565930'>requirement</span>
  <span m='566650'>that</span> <span m='566740'>would</span> <span m='566860'>actually</span>
  <span m='567250'>be</span> <span m='567370'>a</span> <span m='567430'>hard</span>
  <span m='567790'>fork,</span> <span m='568000'>because</span> <span m='568270'>it</span>
  <span m='568360'>would</span> <span m='568450'>be</span> <span m='568570'>allowing</span>
  <span m='569980'>scripts</span> <span m='570400'>that</span> <span m='570520'>were</span>
  <span m='570640'>previously</span> <span m='571240'>invalid</span> <span m='571830'>to</span>
  <span m='571920'>now</span> <span m='572050'>become</span> <span m='572320'>valid.</span>
  <span m='573130'>And</span> <span m='573370'>that's</span> <span m='573670'>a</span>
  <span m='573730'>huge</span> <span m='574600'>undertaking,</span> <span m='575110'>that</span>
  <span m='575370'>has</span> <span m='575500'>sort</span> <span m='576010'>of</span>
  <span m='576160'>only</span> <span m='576550'>happened</span> <span m='576970'>once</span>
  <span m='577270'>in</span> <span m='577390'>Bitcoin,</span> <span m='577900'>and</span>
  <span m='577990'>that</span> <span m='578140'>wasn't</span> <span m='578410'>even</span>
  <span m='578590'>planned.</span> <span m='580460'>And</span> <span m='580540'>so</span>
  <span m='580750'>it's</span> <span m='580870'>just</span> <span m='581050'>like,</span>
  <span m='581170'>whatever,</span> <span m='581770'>leave</span> <span m='581980'>it.</span>
  <span m='582850'>They</span> <span m='583000'>did</span> <span m='583240'>soft</span>
  <span m='583530'>fork</span> <span m='583770'>it</span> <span m='583890'>then.</span>
  <span m='584430'>Is</span> <span m='584560'>it</span> <span m='584650'>soft forked</span>
  <span m='585010'>or</span> <span m='585070'>policy?</span> </p><p><span m='585860'>AUDIENCE:</span>
  <span m='586045'>Soft</span> <span m='586230'>fork.</span> </p><p><span m='587110'>TADGE
  DRYJA:</span> <span m='587170'>So</span> <span m='587230'>they</span> <span m='587320'>did</span>
  <span m='587470'>soft</span> <span m='587840'>fork and</span> <span m='587980'>say,</span>
  <span m='588430'>it</span> <span m='588490'>needs</span> <span m='588670'>to</span>
  <span m='588730'>be</span> <span m='588820'>a</span> <span m='588880'>0.</span>
  </p><p><span m='590088'>AUDIENCE:</span> <span m='590300'>[INAUDIBLE]</span> </p><p><span
  m='591360'>TADGE DRYJA:</span> <span m='591465'>Yeah,</span> <span m='591570'>I'm</span>
  <span m='591916'>not</span> <span m='592262'>sure.</span> <span m='593695'>So</span>
  <span m='594130'>it</span> <span m='594220'>could</span> <span m='594400'>be</span>
  <span m='594550'>non-standard,</span> <span m='595090'>or</span> <span m='595180'>it</span>
  <span m='595240'>could</span> <span m='595420'>be</span> <span m='595540'>an</span>
  <span m='595630'>actual</span> <span m='596320'>consensus</span> <span m='596830'>rule,</span>
  <span m='597040'>that that</span> <span m='597340'>has</span> <span m='597490'>to</span>
  <span m='597580'>be</span> <span m='597700'>a</span> <span m='597730'>0.</span>
  <span m='598480'>It</span> <span m='598630'>used</span> <span m='598930'>to</span>
  <span m='599050'>be</span> <span m='600100'>anything,</span> <span m='600770'>and</span>
  <span m='600790'>now</span> <span m='601300'>it</span> <span m='601900'>should</span>
  <span m='602050'>be</span> <span m='602150'>a</span> <span m='602190'>0.</span>
  <span m='602410'>Put</span> <span m='602680'>a</span> <span m='602900'>0</span>
  <span m='603220'>and then</span> <span m='603490'>it'll</span> <span m='603640'>work.</span>
  <span m='604970'>But</span> <span m='605220'>that</span> <span m='605440'>remains</span>
  <span m='606130'>in</span> <span m='606280'>segwit</span> <span m='606700'>as</span>
  <span m='606820'>well,</span> <span m='607090'>with</span> <span m='607330'>multisig.</span>
  <span m='608650'>They</span> <span m='608800'>could</span> <span m='608950'>have</span>
  <span m='609040'>fixed</span> <span m='609340'>it.</span> <span m='609940'>They</span>
  <span m='610060'>didn't</span> <span m='610240'>want</span> <span m='610390'>to</span>
  <span m='610450'>touch</span> <span m='610690'>it.</span> <span m='611020'>It</span>
  <span m='611110'>was</span> <span m='611230'>just</span> <span m='611380'>like,</span>
  <span m='611560'>whatever.</span> <span m='615660'>When</span> <span m='615820'>you</span>
  <span m='615910'>see</span> <span m='616030'>one</span> <span m='616180'>of</span>
  <span m='616240'>these,</span> <span m='616930'>turn</span> <span m='617290'>it</span>
  <span m='617380'>into</span> <span m='617560'>one</span> <span m='617710'>of</span>
  <span m='617770'>these,</span> <span m='618130'>and</span> <span m='618250'>just</span>
  <span m='618430'>do</span> <span m='618610'>the</span> <span m='618730'>exact</span>
  <span m='619000'>same</span> <span m='619150'>thing</span> <span m='619360'>you</span>
  <span m='619420'>used</span> <span m='619600'>to</span> <span m='619690'>be</span>
  <span m='619780'>doing.</span> <span m='620560'>That's</span> <span m='620770'>a</span>
  <span m='620830'>lot</span> <span m='621010'>simpler</span> <span m='621340'>and</span>
  <span m='621430'>easier.</span> </p><p><span m='622510'>So</span> <span m='623350'>kind</span>
  <span m='623530'>of</span> <span m='623590'>weird,</span> <span m='624430'>but</span>
  <span m='624940'>this</span> <span m='625300'>works.</span> <span m='625870'>People</span>
  <span m='626170'>use</span> <span m='626320'>this</span> <span m='626680'>a</span>
  <span m='626740'>lot,</span> <span m='627530'>especially</span> <span m='628160'>exchanges.</span>
  <span m='630270'>Exchanges</span> <span m='632060'>very</span> <span m='632380'>often</span>
  <span m='632860'>use</span> <span m='633220'>this</span> <span m='633400'>kind</span>
  <span m='633580'>of</span> <span m='633850'>construction,</span> <span m='634750'>because</span>
  <span m='635200'>it</span> <span m='635350'>helps</span> <span m='635770'>people</span>
  <span m='637270'>manage</span> <span m='637600'>keys.</span> <span m='637990'>If</span>
  <span m='638110'>one</span> <span m='638320'>key</span> <span m='638500'>gets</span>
  <span m='638680'>compromised,</span> <span m='639370'>you</span> <span m='639430'>don't</span>
  <span m='639580'>lose</span> <span m='639760'>all</span> <span m='639850'>your</span>
  <span m='639970'>money.</span> <span m='641920'>Usually,</span> <span m='642430'>2</span>
  <span m='642670'>of</span> <span m='642760'>3,</span> <span m='643420'>sometimes</span>
  <span m='643870'>3</span> <span m='644050'>of</span> <span m='644110'>4.</span>
  <span m='644770'>3</span> <span m='645010'>of</span> <span m='645100'>3,</span>
  <span m='645490'>2</span> <span m='645700'>of</span> <span m='645790'>2--</span>
  <span m='646570'>all</span> <span m='646690'>sorts</span> <span m='646930'>of</span>
  <span m='647020'>constructions</span> <span m='647530'>where</span> <span m='647650'>this</span>
  <span m='647800'>is</span> <span m='647920'>extremely</span> <span m='648370'>useful.</span>
  <span m='649210'>And</span> <span m='649330'>actually,</span> <span m='649840'>I'll</span>
  <span m='649930'>be</span> <span m='650050'>talking</span> <span m='650440'>about</span>
  <span m='651970'>more</span> <span m='652870'>powerful</span> <span m='653380'>signature</span>
  <span m='653770'>aggregation</span> <span m='654400'>and</span> <span m='654520'>multisig</span>
  <span m='655300'>on</span> <span m='655480'>Wednesday.</span> <span m='656530'>But</span>
  <span m='656740'>for</span> <span m='656860'>now,</span> <span m='657340'>this</span>
  <span m='657490'>is</span> <span m='657580'>what</span> <span m='657700'>we</span>
  <span m='657790'>use.</span> <span m='659160'>And,</span> <span m='659230'>how</span>
  <span m='659350'>can</span> <span m='659470'>we</span> <span m='659590'>make</span>
  <span m='659740'>this</span> <span m='659890'>better?</span> </p><p><span m='662130'>So</span>
  <span m='662280'>one</span> <span m='662430'>interesting</span> <span m='662790'>thing--</span>
  <span m='663570'>pay</span> <span m='664060'>to</span> <span m='664300'>pubkey,</span>
  <span m='664830'>which</span> <span m='665100'>is</span> <span m='666770'>not</span>
  <span m='667160'>really</span> <span m='667490'>used</span> <span m='667820'>anymore,</span>
  <span m='668300'>but</span> <span m='668480'>used</span> <span m='668750'>to</span>
  <span m='668840'>be</span> <span m='668990'>used</span> <span m='669290'>more</span>
  <span m='669470'>frequently,</span> <span m='670070'>like</span> <span m='670280'>in</span>
  <span m='670340'>the</span> <span m='670460'>early</span> <span m='670700'>days.</span>
  <span m='671180'>If</span> <span m='671270'>you</span> <span m='671330'>look</span>
  <span m='671510'>at</span> <span m='672710'>transactions</span> <span m='673310'>in</span>
  <span m='673400'>2009,</span> <span m='673970'>2010,</span> <span m='674990'>this</span>
  <span m='675200'>is</span> <span m='675770'>predominant,</span> <span m='676490'>I</span>
  <span m='676610'>think.</span> <span m='677930'>And</span> <span m='678380'>all</span>
  <span m='678530'>the</span> <span m='678620'>mining</span> <span m='679430'>outputs</span>
  <span m='680060'>from</span> <span m='680300'>a</span> <span m='680360'>long</span>
  <span m='680540'>time</span> <span m='680750'>ago</span> <span m='681110'>looked</span>
  <span m='681320'>like</span> <span m='681500'>this.</span> <span m='683240'>And</span>
  <span m='683330'>the</span> <span m='684110'>output</span> <span m='684380'>script</span>
  <span m='684620'>was</span> <span m='684770'>just</span> <span m='685590'>pubkey,</span>
  <span m='686400'>OP_CHECKSIG,</span> <span m='687500'>which</span> <span m='687650'>is</span>
  <span m='687740'>really</span> <span m='687920'>simple.</span> </p><p><span m='689250'>And</span>
  <span m='689330'>then</span> <span m='689450'>the</span> <span m='689540'>idea</span>
  <span m='689840'>is</span> <span m='689990'>when</span> <span m='690140'>you</span>
  <span m='690200'>want</span> <span m='690350'>to</span> <span m='690410'>spend</span>
  <span m='690620'>it,</span> <span m='690920'>you</span> <span m='691040'>just</span>
  <span m='691340'>push</span> <span m='691580'>a</span> <span m='691640'>signature</span>
  <span m='692030'>onto</span> <span m='692180'>the</span> <span m='692270'>stack.</span>
  <span m='693350'>Then</span> <span m='693470'>you</span> <span m='693590'>have</span>
  <span m='693860'>signature,</span> <span m='694430'>pubkey,</span> <span m='695050'>OP_CHECKSIG.</span>
  <span m='695960'>That's</span> <span m='696230'>it.</span> <span m='698210'>It's</span>
  <span m='698420'>really</span> <span m='698690'>simple,</span> <span m='699140'>and</span>
  <span m='699260'>it</span> <span m='699470'>actually</span> <span m='699950'>saves</span>
  <span m='700400'>space.</span> <span m='702500'>Your</span> <span m='702680'>pubkey</span>
  <span m='703040'>is</span> <span m='703190'>33</span> <span m='703730'>bytes,</span>
  <span m='705380'>whereas</span> <span m='705950'>your</span> <span m='707660'>pubkey</span>
  <span m='708020'>hash</span> <span m='708290'>script,</span> <span m='709250'>the</span>
  <span m='709520'>pubkey</span> <span m='709820'>hash is</span> <span m='710090'>20</span>
  <span m='710330'>bytes.</span> <span m='710810'>So</span> <span m='711080'>yeah,</span>
  <span m='711290'>the</span> <span m='711380'>pubkey</span> <span m='711710'>hash</span>
  <span m='712510'>is</span> <span m='712860'>12</span> <span m='713240'>bytes</span>
  <span m='713480'>smaller</span> <span m='714770'>plus</span> <span m='715250'>the</span>
  <span m='715550'>extra</span> <span m='716020'>OP</span> <span m='716270'>codes</span>
  <span m='716660'>makes</span> <span m='717020'>it</span> <span m='717440'>10</span>
  <span m='717980'>bytes</span> <span m='719060'>savings</span> <span m='719990'>for</span>
  <span m='720170'>the</span> <span m='720290'>output</span> <span m='720590'>script.</span>
  </p><p><span m='722190'>However,</span> <span m='722630'>when</span> <span m='722900'>you</span>
  <span m='723050'>spend</span> <span m='724160'>with</span> <span m='724460'>data</span>
  <span m='724550'>pubkey</span> <span m='724880'>hash,</span> <span m='725240'>you</span>
  <span m='725390'>need</span> <span m='725540'>to</span> <span m='725600'>put</span>
  <span m='726290'>the</span> <span m='726410'>pubkey</span> <span m='726710'>itself</span>
  <span m='727670'>and</span> <span m='727820'>the</span> <span m='727880'>signature.</span>
  <span m='729290'>So</span> <span m='729440'>you're</span> <span m='730430'>putting</span>
  <span m='730700'>the</span> <span m='730790'>pubkey</span> <span m='731090'>into</span>
  <span m='731270'>the</span> <span m='731330'>network</span> <span m='731780'>either</span>
  <span m='732020'>way,</span> <span m='732320'>eventually.</span> <span m='733490'>So</span>
  <span m='733610'>this</span> <span m='733760'>is</span> <span m='733850'>actually</span>
  <span m='734360'>overall</span> <span m='735080'>more</span> <span m='735320'>space</span>
  <span m='735620'>efficient,</span> <span m='736550'>in</span> <span m='736910'>that</span>
  <span m='737150'>you're</span> <span m='737330'>saving</span> <span m='737720'>23</span>
  <span m='738200'>bytes</span> <span m='739040'>over</span> <span m='739220'>the</span>
  <span m='739370'>lifecycle</span> <span m='739940'>of</span> <span m='740060'>it.</span>
  <span m='740840'>The</span> <span m='741020'>output</span> <span m='741350'>is</span>
  <span m='741500'>a</span> <span m='741530'>little</span> <span m='741740'>bit</span>
  <span m='741890'>bigger</span> <span m='742550'>but</span> <span m='742700'>the</span>
  <span m='742820'>input</span> <span m='743180'>is</span> <span m='743240'>significantly</span>
  <span m='743810'>smaller,</span> <span m='744240'>so</span> <span m='744290'>you</span>
  <span m='744380'>end</span> <span m='744500'>up</span> <span m='744590'>saving.</span>
  </p><p><span m='746450'>Why</span> <span m='748610'>do</span> <span m='748730'>we</span>
  <span m='748910'>always</span> <span m='749420'>use</span> <span m='750020'>pubkey</span>
  <span m='750500'>hashes</span> <span m='750950'>instead</span> <span m='751220'>of</span>
  <span m='751310'>pubkeys?</span> <span m='754230'>There's</span> <span m='754410'>a</span>
  <span m='754470'>lot</span> <span m='754680'>of</span> <span m='754770'>different</span>
  <span m='755070'>opinions</span> <span m='755520'>on</span> <span m='755650'>it.</span>
  <span m='756590'>You</span> <span m='756690'>know,</span> <span m='756810'>it's</span>
  <span m='756900'>Bitcoin,</span> <span m='757260'>there's</span> <span m='757380'>no</span>
  <span m='757920'>"answer."</span> <span m='759150'>People</span> <span m='759420'>have</span>
  <span m='759540'>different</span> <span m='759810'>ideas</span> <span m='760110'>of</span>
  <span m='760200'>why</span> <span m='760650'>these</span> <span m='760830'>are</span>
  <span m='760920'>better.</span> <span m='762120'>Any</span> <span m='762760'>ideas?</span>
  </p><p><span m='763516'>AUDIENCE:</span> <span m='763754'>[INAUDIBLE]</span> <span
  m='763992'>put their</span> <span m='764468'>pubkey</span> <span m='764944'>out
  in</span> <span m='765420'>public</span> <span m='765900'>before</span> <span m='766287'>it
  got</span> <span m='766674'>spent.</span> </p><p><span m='767450'>TADGE DRYJA:</span>
  <span m='767530'>Yeah,</span> <span m='767610'>that's</span> <span m='769170'>probably</span>
  <span m='769470'>the</span> <span m='769530'>predominant</span> <span m='770160'>one.</span>
  <span m='770520'>And</span> <span m='770820'>that's</span> <span m='771060'>going</span>
  <span m='771130'>to</span> <span m='771240'>be</span> <span m='771330'>a</span>
  <span m='772470'>tricky</span> <span m='772800'>one</span> <span m='773040'>to</span>
  <span m='773190'>try</span> <span m='773490'>to</span> <span m='773910'>convince</span>
  <span m='774330'>people</span> <span m='774660'>is</span> <span m='774780'>not</span>
  <span m='774990'>the</span> <span m='775080'>case.</span> <span m='778020'>I'll</span>
  <span m='778140'>get</span> <span m='778290'>to</span> <span m='778380'>that.</span>
  <span m='778560'>But</span> <span m='779130'>people</span> <span m='779460'>started</span>
  <span m='779760'>arguing</span> <span m='780060'>about</span> <span m='780480'>pubkey</span>
  <span m='780765'>hash.</span> <span m='781740'>When</span> <span m='782550'>someone</span>
  <span m='782910'>posted</span> <span m='783240'>about</span> <span m='783450'>graftroot,</span>
  <span m='784450'>the</span> <span m='784860'>discussion</span> <span m='785310'>devolved</span>
  <span m='785850'>into</span> <span m='786330'>a,</span> <span m='786840'>wait,</span>
  <span m='787170'>I</span> <span m='787290'>don't</span> <span m='787470'>want</span>
  <span m='787650'>my</span> <span m='787800'>pubkey</span> <span m='788190'>on</span>
  <span m='788310'>the</span> <span m='788400'>network.</span> </p><p><span m='789930'>And</span>
  <span m='792050'>there's</span> <span m='793070'>some</span> <span m='793340'>arguments</span>
  <span m='793850'>why</span> <span m='794120'>you'd</span> <span m='794630'>want</span>
  <span m='794900'>a</span> <span m='794960'>pubkey</span> <span m='795260'>hash,</span>
  <span m='795620'>and</span> <span m='795770'>it's</span> <span m='795890'>more</span>
  <span m='796040'>secure,</span> <span m='796530'>but</span> <span m='796670'>there's</span>
  <span m='796880'>a</span> <span m='796940'>lot</span> <span m='797150'>of</span>
  <span m='797240'>arguments</span> <span m='797600'>that</span> <span m='797720'>it</span>
  <span m='798050'>doesn't</span> <span m='798470'>actually</span> <span m='798860'>provide</span>
  <span m='799130'>any</span> <span m='799310'>extra</span> <span m='799520'>security.</span>
  <span m='800310'>So</span> <span m='800330'>that's</span> <span m='800780'>a</span>
  <span m='800840'>tricky</span> <span m='801080'>one.</span> <span m='802360'>But</span>
  <span m='802460'>that</span> <span m='802610'>is</span> <span m='802760'>one.</span>
  <span m='802970'>That</span> <span m='803150'>is</span> <span m='803300'>probably</span>
  <span m='803570'>a</span> <span m='803780'>big</span> <span m='803930'>one</span>
  <span m='804080'>people</span> <span m='804290'>like.</span> <span m='804710'>Other</span>
  <span m='805100'>ideas</span> <span m='806270'>why</span> <span m='806480'>you</span>
  <span m='806560'>use</span> <span m='806650'>pubkey</span> <span m='806930'>hashes</span>
  <span m='807350'>instead</span> <span m='807590'>of</span> <span m='807680'>pubkeys</span>
  <span m='808010'>themselves?</span> </p><p><span m='811810'>Size--</span> <span
  m='813790'>you</span> <span m='813880'>want</span> <span m='814060'>the</span> <span
  m='814150'>outputs</span> <span m='814450'>to</span> <span m='814540'>be</span>
  <span m='814630'>small.</span> <span m='815420'>Also,</span> <span m='815830'>I'm</span>
  <span m='816010'>pretty</span> <span m='816340'>sure</span> <span m='816670'>when</span>
  <span m='817690'>Satoshi</span> <span m='818320'>wrote</span> <span m='818620'>all</span>
  <span m='818770'>this,</span> <span m='819520'>he</span> <span m='819670'>did</span>
  <span m='819850'>not</span> <span m='820390'>know</span> <span m='820810'>about</span>
  <span m='821260'>compressed</span> <span m='821760'>public</span> <span m='822090'>keys,</span>
  <span m='823150'>because</span> <span m='823480'>that</span> <span m='823750'>stuff</span>
  <span m='824140'>was</span> <span m='824410'>not</span> <span m='824650'>in</span>
  <span m='824770'>there</span> <span m='825010'>for</span> <span m='825430'>a</span>
  <span m='825520'>while.</span> <span m='828550'>I</span> <span m='828610'>think</span>
  <span m='828790'>I</span> <span m='828860'>mentioned</span> <span m='829150'>this</span>
  <span m='829300'>before.</span> <span m='829750'>Did</span> <span m='829870'>I</span>
  <span m='830110'>mention</span> <span m='830710'>compressed</span> <span m='831250'>versus</span>
  <span m='831580'>uncompressed</span> <span m='832090'>pubkeys?</span> <span m='832780'>Yeah,</span>
  <span m='833020'>probably.</span> <span m='833350'>OK,</span> <span m='833560'>so</span>
  <span m='833680'>review.</span> </p><p><span m='834340'>The</span> <span m='834460'>idea</span>
  <span m='834730'>is</span> <span m='834970'>you've</span> <span m='835090'>got</span>
  <span m='835270'>this</span> <span m='835480'>whole</span> <span m='835780'>curve</span>
  <span m='836380'>kind</span> <span m='836590'>of</span> <span m='836650'>deal,</span>
  <span m='838180'>kind</span> <span m='838360'>of</span> <span m='838420'>thing--</span>
  <span m='841380'>usually</span> <span m='841680'>like</span> <span m='841890'>that.</span>
  <span m='844550'>Your</span> <span m='844710'>public</span> <span m='845060'>key</span>
  <span m='845160'>is</span> <span m='845280'>a</span> <span m='845340'>point</span>
  <span m='845610'>on</span> <span m='845730'>the</span> <span m='845790'>curve.</span>
  <span m='847290'>You</span> <span m='847500'>need</span> <span m='847770'>an</span>
  <span m='847890'>x</span> <span m='848100'>and</span> <span m='848190'>y-coordinate</span>
  <span m='848790'>to</span> <span m='848910'>represent</span> <span m='849300'>the</span>
  <span m='849360'>point.</span> <span m='849660'>However,</span> <span m='850320'>because</span>
  <span m='850830'>it's</span> <span m='851050'>symmetric,</span> <span m='852330'>you</span>
  <span m='852450'>can</span> <span m='852600'>just</span> <span m='852750'>say,</span>
  <span m='852930'>well,</span> <span m='853350'>I'll</span> <span m='853470'>tell</span>
  <span m='853740'>you</span> <span m='853860'>the</span> <span m='854010'>x-coordinate.</span>
  <span m='854940'>You</span> <span m='855030'>know,</span> <span m='855210'>x</span>
  <span m='855540'>equals</span> <span m='855840'>7.</span> <span m='856770'>I'm</span>
  <span m='856890'>not</span> <span m='857070'>going</span> <span m='857190'>to</span>
  <span m='857280'>tell</span> <span m='857430'>you</span> <span m='857490'>the</span>
  <span m='857580'>y-coordinate.</span> <span m='858180'>I'll</span> <span m='858300'>just</span>
  <span m='858450'>say</span> <span m='858630'>y</span> <span m='859020'>equals</span>
  <span m='859410'>plus.</span> <span m='861310'>So</span> <span m='861570'>go</span>
  <span m='861810'>up,</span> <span m='862260'>or</span> <span m='862380'>go</span>
  <span m='862560'>down.</span> <span m='863460'>That</span> <span m='863670'>way,</span>
  <span m='863820'>I</span> <span m='863910'>can</span> <span m='864120'>do</span>
  <span m='864470'>32</span> <span m='864960'>bytes</span> <span m='865230'>for</span>
  <span m='865350'>this</span> <span m='865770'>and</span> <span m='865920'>1</span>
  <span m='866280'>bit</span> <span m='866730'>for</span> <span m='866910'>that,</span>
  <span m='868840'>at</span> <span m='869130'>the</span> <span m='869220'>cost</span>
  <span m='869580'>of</span> <span m='869700'>a</span> <span m='869760'>little</span>
  <span m='870090'>bit</span> <span m='870240'>of</span> <span m='870330'>extra</span>
  <span m='870570'>computation.</span> </p><p><span m='873630'>So</span> <span m='873750'>I</span>
  <span m='873810'>can</span> <span m='873960'>say,</span> <span m='874140'>maybe</span>
  <span m='874440'>y</span> <span m='874770'>is</span> <span m='874920'>actually</span>
  <span m='875430'>5,</span> <span m='875820'>or</span> <span m='875880'>something.</span>
  <span m='877270'>So</span> <span m='877320'>if</span> <span m='877410'>I</span>
  <span m='877500'>say,</span> <span m='878310'>x</span> <span m='878610'>equals</span>
  <span m='878850'>7,</span> <span m='879360'>y</span> <span m='879780'>equals</span>
  <span m='880170'>5,</span> <span m='880920'>that's</span> <span m='881400'>quick</span>
  <span m='881730'>but</span> <span m='881880'>it</span> <span m='881940'>takes</span>
  <span m='882180'>more</span> <span m='882300'>space.</span> <span m='882990'>If</span>
  <span m='883110'>I</span> <span m='883170'>say</span> <span m='883380'>x</span>
  <span m='883650'>equals</span> <span m='883920'>7,</span> <span m='884400'>y</span>
  <span m='884940'>equals</span> <span m='885330'>plus,</span> <span m='886500'>I</span>
  <span m='886580'>now</span> <span m='886710'>have</span> <span m='886860'>to</span>
  <span m='886950'>compute</span> <span m='887370'>what</span> <span m='887520'>y</span>
  <span m='887790'>is</span> <span m='888870'>when</span> <span m='889050'>I</span>
  <span m='889110'>see</span> <span m='889290'>this--</span> <span m='889710'>which</span>
  <span m='890400'>is</span> <span m='890550'>pretty</span> <span m='890790'>quick,</span>
  <span m='891450'>but</span> <span m='891890'>take</span> <span m='892160'>some</span>
  <span m='892350'>time.</span> <span m='895020'>But</span> <span m='895110'>it's</span>
  <span m='895200'>a</span> <span m='895230'>good</span> <span m='895320'>tradeoff.</span>
  <span m='895650'>Anyway,</span> <span m='895890'>I</span> <span m='895920'>don't</span>
  <span m='896040'>think</span> <span m='896190'>Satoshi</span> <span m='896570'>knew</span>
  <span m='896700'>about</span> <span m='897030'>this</span> <span m='897960'>idea--</span>
  <span m='899130'>or</span> <span m='899520'>maybe</span> <span m='899970'>thought</span>
  <span m='900240'>of</span> <span m='900360'>it,</span> <span m='900460'>never</span>
  <span m='900720'>put</span> <span m='900990'>it</span> <span m='901080'>in.</span>
  <span m='901290'>So</span> <span m='901680'>the</span> <span m='901800'>public</span>
  <span m='902160'>keys</span> <span m='902400'>were</span> <span m='902550'>actually</span>
  <span m='902880'>65</span> <span m='903390'>bytes.</span> </p><p><span m='904050'>You</span>
  <span m='904170'>want</span> <span m='904350'>to</span> <span m='904440'>keep</span>
  <span m='904650'>the</span> <span m='904770'>output</span> <span m='905130'>small,</span>
  <span m='906300'>because</span> <span m='906600'>they're</span> <span m='907170'>in</span>
  <span m='907440'>the</span> <span m='907560'>UTF</span> <span m='907890'>subset.</span>
  <span m='908680'>They're</span> <span m='908850'>in</span> <span m='909000'>the</span>
  <span m='909090'>database.</span> <span m='910050'>And</span> <span m='910410'>you</span>
  <span m='910590'>need</span> <span m='910740'>to</span> <span m='910830'>be</span>
  <span m='910920'>able</span> <span m='911070'>to</span> <span m='911210'>think</span>
  <span m='911370'>through</span> <span m='911580'>this</span> <span m='912030'>and</span>
  <span m='912180'>read</span> <span m='912420'>it</span> <span m='912570'>randomly.</span>
  <span m='913260'>Like,</span> <span m='913410'>you</span> <span m='913470'>don't</span>
  <span m='913590'>know</span> <span m='913680'>when</span> <span m='913890'>it's</span>
  <span m='914010'>going</span> <span m='914090'>to</span> <span m='914190'>get</span>
  <span m='914280'>spent.</span> <span m='914640'>You</span> <span m='914700'>don't</span>
  <span m='914820'>know</span> <span m='914910'>what</span> <span m='915350'>transaction</span>
  <span m='915870'>is</span> <span m='915960'>going</span> <span m='916090'>to</span>
  <span m='916140'>query</span> <span m='916410'>this.</span> <span m='917190'>So</span>
  <span m='917370'>this</span> <span m='917550'>has</span> <span m='917700'>to</span>
  <span m='917790'>go</span> <span m='917940'>in</span> <span m='918210'>an</span>
  <span m='918270'>actual</span> <span m='918540'>database,</span> <span m='919140'>key</span>
  <span m='919320'>value</span> <span m='919620'>store</span> <span m='919860'>kind</span>
  <span m='920010'>of</span> <span m='920070'>thing.</span> </p><p><span m='920940'>The</span>
  <span m='921090'>signatures</span> <span m='921960'>don't</span> <span m='922320'>have</span>
  <span m='922410'>to</span> <span m='922500'>be</span> <span m='922590'>in</span>
  <span m='922680'>any</span> <span m='922920'>database.</span> <span m='923880'>They're</span>
  <span m='924060'>just</span> <span m='924270'>in</span> <span m='924360'>these</span>
  <span m='924510'>old</span> <span m='924660'>blocks,</span> <span m='925590'>and</span>
  <span m='925860'>you</span> <span m='926010'>read</span> <span m='926280'>from</span>
  <span m='926490'>them</span> <span m='926670'>linearly.</span> <span m='927460'>You</span>
  <span m='927750'>basically</span> <span m='928200'>read</span> <span m='928410'>through</span>
  <span m='928500'>the</span> <span m='928560'>whole</span> <span m='928710'>block</span>
  <span m='928950'>at</span> <span m='929010'>a</span> <span m='929070'>time.</span>
  <span m='929910'>And</span> <span m='930600'>high</span> <span m='930780'>latency</span>
  <span m='931200'>is</span> <span m='931320'>fine.</span> <span m='931710'>There's</span>
  <span m='931920'>never</span> <span m='932220'>any</span> <span m='932400'>timing-critical</span>
  <span m='933720'>reads</span> <span m='933990'>for</span> <span m='934110'>this.</span>
  </p><p><span m='934890'>So</span> <span m='935130'>basically,</span> <span m='936060'>you</span>
  <span m='936210'>could</span> <span m='936780'>store</span> <span m='937680'>the</span>
  <span m='937830'>blocks</span> <span m='938340'>as</span> <span m='938580'>just</span>
  <span m='938850'>files</span> <span m='939870'>on</span> <span m='939990'>your</span>
  <span m='940110'>hard</span> <span m='940290'>drive.</span> <span m='940840'>Block</span>
  <span m='941340'>1</span> <span m='941910'>dot</span> <span m='942225'>dat,</span>
  <span m='942540'>or</span> <span m='942630'>whatever--</span> <span m='942930'>block</span>
  <span m='943140'>2</span> <span m='943290'>dot</span> <span m='943440'>dat--</span>
  <span m='943710'>and</span> <span m='943830'>have</span> <span m='944190'>500,000</span>
  <span m='944940'>files,</span> <span m='946050'>because</span> <span m='946350'>you</span>
  <span m='946440'>basically</span> <span m='946830'>always</span> <span m='947280'>read</span>
  <span m='947430'>them</span> <span m='947820'>a</span> <span m='947880'>block</span>
  <span m='948120'>at</span> <span m='948210'>a</span> <span m='948240'>time.</span>
  <span m='950670'>And</span> <span m='951150'>you</span> <span m='951390'>only</span>
  <span m='951750'>have</span> <span m='951900'>to</span> <span m='951990'>read</span>
  <span m='952200'>them</span> <span m='952580'>when</span> <span m='952950'>other</span>
  <span m='953190'>people</span> <span m='953610'>are</span> <span m='953760'>doing</span>
  <span m='954360'>IBD--</span> <span m='954870'>initialization</span> <span m='955140'>block</span>
  <span m='955350'>download--</span> <span m='955980'>and</span> <span m='956130'>you're</span>
  <span m='956220'>serving</span> <span m='956550'>it</span> <span m='956640'>to</span>
  <span m='956740'>them.</span> <span m='957630'>So</span> <span m='957780'>you</span>
  <span m='957870'>can</span> <span m='958020'>prune</span> <span m='958280'>these,</span>
  <span m='959750'>if</span> <span m='959870'>you</span> <span m='959960'>run</span>
  <span m='960560'>Bitcoin</span> <span m='960830'>core</span> <span m='961040'>with</span>
  <span m='961190'>pruning.</span> </p><p><span m='962630'>Anyway,</span> <span m='962890'>so</span>
  <span m='963090'>the</span> <span m='963390'>main</span> <span m='963980'>idea</span>
  <span m='964280'>is,</span> <span m='964570'>OK,</span> <span m='964970'>even</span>
  <span m='965300'>if</span> <span m='965570'>it</span> <span m='965840'>overall</span>
  <span m='966650'>increases</span> <span m='967220'>the</span> <span m='967340'>size</span>
  <span m='968060'>of</span> <span m='968300'>transactions,</span> <span m='969920'>it</span>
  <span m='970100'>does</span> <span m='970430'>reduce</span> <span m='970790'>the</span>
  <span m='970880'>size</span> <span m='971180'>of</span> <span m='971270'>the</span>
  <span m='971420'>outputs--</span> <span m='972180'>which</span> <span m='972260'>is</span>
  <span m='972350'>the</span> <span m='972440'>thing</span> <span m='972650'>we</span>
  <span m='972770'>really</span> <span m='973010'>want</span> <span m='973160'>to</span>
  <span m='973220'>minimize,</span> <span m='974390'>for</span> <span m='974960'>keeping</span>
  <span m='975260'>the</span> <span m='975350'>speed</span> <span m='975570'>up.</span>
  <span m='977480'>Questions</span> <span m='977830'>about</span> <span m='977980'>that?</span>
  <span m='978360'>Cool?</span> <span m='979020'>OK.</span> </p><p><span m='980430'>So</span>
  <span m='981750'>similarly,</span> <span m='982680'>same</span> <span m='982890'>thing</span>
  <span m='983040'>with</span> <span m='983210'>pay to</span> <span m='983400'>pubkey</span>
  <span m='983730'>hashes</span> <span m='984510'>versus</span> <span m='984810'>pay</span>
  <span m='984890'>to</span> <span m='984990'>pubkey.</span> <span m='986250'>Instead</span>
  <span m='986580'>of</span> <span m='986700'>pay</span> <span m='986850'>to</span>
  <span m='986910'>script</span> <span m='987240'>hash,</span> <span m='987480'>you</span>
  <span m='987600'>could</span> <span m='987870'>put</span> <span m='988050'>the</span>
  <span m='988170'>whole</span> <span m='988410'>script</span> <span m='989220'>in</span>
  <span m='989370'>an</span> <span m='989460'>output--</span> <span m='990750'>like</span>
  <span m='991050'>a</span> <span m='991110'>multiset.</span> <span m='991620'>You</span>
  <span m='991740'>could</span> <span m='991860'>just</span> <span m='992040'>have</span>
  <span m='992280'>all</span> <span m='992490'>three</span> <span m='992820'>of</span>
  <span m='992940'>your</span> <span m='993030'>keys</span> <span m='993660'>in</span>
  <span m='993810'>your</span> <span m='994200'>output</span> <span m='994710'>script.</span>
  <span m='995850'>And</span> <span m='996000'>that</span> <span m='996180'>would</span>
  <span m='996570'>save</span> <span m='996870'>space</span> <span m='997230'>overall.</span>
  <span m='997980'>Your</span> <span m='998160'>output</span> <span m='998430'>is</span>
  <span m='998550'>20</span> <span m='998790'>bytes,</span> <span m='999150'>and</span>
  <span m='999240'>then</span> <span m='999360'>you</span> <span m='999450'>reveal</span>
  <span m='999780'>your</span> <span m='999900'>whole</span> <span m='1000500'>100-byte</span>
  <span m='1001220'>script,</span> <span m='1002180'>so</span> <span m='1002380'>you</span>
  <span m='1002450'>save</span> <span m='1002640'>those</span> <span m='1002810'>20</span>
  <span m='1003020'>bytes.</span> <span m='1003560'>Same</span> <span m='1004130'>amount,</span>
  <span m='1004430'>but</span> <span m='1004610'>proportionately</span> <span m='1005240'>less,</span>
  <span m='1005420'>sorry.</span> </p><p><span m='1007640'>It</span> <span m='1007720'>is</span>
  <span m='1007850'>some</span> <span m='1008030'>space</span> <span m='1008230'>savings</span>
  <span m='1008550'>overall,</span> <span m='1008810'>but</span> <span m='1008900'>it's</span>
  <span m='1008990'>better</span> <span m='1009200'>to</span> <span m='1009290'>keep</span>
  <span m='1009440'>the</span> <span m='1009560'>output</span> <span m='1010010'>size</span>
  <span m='1010250'>small.</span> <span m='1012800'>[INAUDIBLE]</span> <span m='1013580'>If</span>
  <span m='1014070'>you</span> <span m='1014190'>do</span> <span m='1014340'>this,</span>
  <span m='1014520'>does</span> <span m='1014660'>it</span> <span m='1014760'>actually</span>
  <span m='1015000'>work?</span> </p><p><span m='1015675'>AUDIENCE:</span> <span m='1015877'>[INAUDIBLE]</span>
  </p><p><span m='1016890'>TADGE DRYJA:</span> <span m='1016940'>OK,</span> <span
  m='1017500'>it's</span> <span m='1017620'>not</span> <span m='1017710'>standard,</span>
  <span m='1018030'>so</span> <span m='1018180'>it</span> <span m='1018420'>might</span>
  <span m='1018810'>not</span> <span m='1019110'>propagate.</span> </p><p><span m='1019630'>AUDIENCE:</span>
  <span m='1019862'>[INAUDIBLE]</span> </p><p><span m='1022830'>TADGE DRYJA:</span>
  <span m='1022875'>I</span> <span m='1022920'>wouldn't</span> <span m='1023130'>recommend</span>
  <span m='1023520'>this.</span> <span m='1023730'>It</span> <span m='1023850'>probably</span>
  <span m='1024359'>will</span> <span m='1024660'>not</span> <span m='1025109'>really</span>
  <span m='1025440'>work.</span> <span m='1026099'>Maybe</span> <span m='1026520'>eventually</span>
  <span m='1027069'>it</span> <span m='1027170'>will</span> <span m='1027270'>get</span>
  <span m='1027300'>confirmed,</span> <span m='1027810'>if</span> <span m='1027900'>you</span>
  <span m='1027990'>find</span> <span m='1028230'>people</span> <span m='1028589'>to</span>
  <span m='1029040'>confirm</span> <span m='1029400'>it</span> <span m='1029490'>for</span>
  <span m='1029640'>you,</span> <span m='1030119'>but</span> <span m='1030300'>most</span>
  <span m='1030540'>nodes</span> <span m='1030839'>will</span> <span m='1031470'>ignore</span>
  <span m='1031770'>these</span> <span m='1031920'>kinds</span> <span m='1032099'>of</span>
  <span m='1032160'>things.</span> </p><p><span m='1034210'>OK,</span> <span m='1034619'>so</span>
  <span m='1035430'>the</span> <span m='1035520'>question</span> <span m='1036000'>for</span>
  <span m='1036150'>today--</span> <span m='1037240'>what</span> <span m='1037349'>if</span>
  <span m='1037470'>we</span> <span m='1037589'>want</span> <span m='1037880'>really,</span>
  <span m='1038710'>really</span> <span m='1039089'>big</span> <span m='1039390'>scripts?</span>
  <span m='1040290'>So</span> <span m='1040530'>2</span> <span m='1040730'>of</span>
  <span m='1040780'>3</span> <span m='1040950'>multisig</span> <span m='1041400'>is</span>
  <span m='1041520'>cool.</span> <span m='1042720'>We</span> <span m='1042869'>can</span>
  <span m='1042990'>just</span> <span m='1043109'>show</span> <span m='1043319'>all</span>
  <span m='1043470'>three</span> <span m='1043680'>keys.</span> <span m='1044490'>And</span>
  <span m='1045390'>there's</span> <span m='1045630'>33</span> <span m='1046109'>bytes</span>
  <span m='1046470'>of</span> <span m='1046589'>data</span> <span m='1046920'>that</span>
  <span m='1047130'>don't</span> <span m='1047400'>really</span> <span m='1047609'>get</span>
  <span m='1047790'>used.</span> <span m='1048630'>If</span> <span m='1048780'>you're</span>
  <span m='1048930'>signing</span> <span m='1049710'>with</span> <span m='1049920'>2</span>
  <span m='1050100'>of</span> <span m='1050160'>the</span> <span m='1050220'>3</span>
  <span m='1050430'>keys,</span> <span m='1050700'>well,</span> <span m='1050790'>that</span>
  <span m='1050880'>means</span> <span m='1051090'>one</span> <span m='1051270'>of</span>
  <span m='1051330'>the</span> <span m='1051390'>keys</span> <span m='1052110'>never</span>
  <span m='1052500'>got</span> <span m='1052770'>used.</span> <span m='1053310'>It</span>
  <span m='1053430'>was</span> <span m='1053550'>sort</span> <span m='1053730'>of</span>
  <span m='1053850'>there</span> <span m='1054150'>and</span> <span m='1054390'>pointless.</span>
  <span m='1055990'>But</span> <span m='1056360'>whatever,</span> <span m='1056670'>it's</span>
  <span m='1056790'>33</span> <span m='1057090'>bytes.</span> </p><p><span m='1057750'>So</span>
  <span m='1057840'>what</span> <span m='1057960'>if</span> <span m='1058050'>you</span>
  <span m='1058110'>want</span> <span m='1058230'>to</span> <span m='1058290'>do,</span>
  <span m='1058440'>like,</span> <span m='1058680'>2</span> <span m='1059040'>of</span>
  <span m='1059160'>50</span> <span m='1059790'>multisig?</span> <span m='1060750'>So</span>
  <span m='1060870'>here's</span> <span m='1061080'>50</span> <span m='1061410'>different</span>
  <span m='1061650'>keys.</span> <span m='1062160'>Any</span> <span m='1062370'>two</span>
  <span m='1062940'>of</span> <span m='1063060'>these</span> <span m='1063240'>people</span>
  <span m='1063540'>can</span> <span m='1063720'>sign.</span> <span m='1065130'>Maybe</span>
  <span m='1065460'>you're</span> <span m='1065610'>in</span> <span m='1065700'>a</span>
  <span m='1065730'>company.</span> <span m='1066210'>There's</span> <span m='1066390'>50</span>
  <span m='1066630'>employees.</span> <span m='1067800'>And</span> <span m='1068040'>the</span>
  <span m='1068130'>policy</span> <span m='1068640'>is</span> <span m='1068790'>that,</span>
  <span m='1068880'>OK,</span> <span m='1069120'>any</span> <span m='1069300'>of</span>
  <span m='1069360'>these</span> <span m='1069510'>two</span> <span m='1069660'>people</span>
  <span m='1070020'>can</span> <span m='1070800'>use</span> <span m='1071130'>the</span>
  <span m='1071220'>coins</span> <span m='1071760'>for</span> <span m='1072090'>this</span>
  <span m='1073680'>spending</span> <span m='1074130'>to</span> <span m='1074190'>buy</span>
  <span m='1074370'>lunch,</span> <span m='1074700'>or</span> <span m='1074790'>whatever.</span>
  <span m='1078830'>So</span> <span m='1078980'>how</span> <span m='1079100'>would</span>
  <span m='1079220'>you</span> <span m='1079280'>2 of</span> <span m='1079460'>250</span>
  <span m='1079850'>multisig?</span> <span m='1081350'>Any</span> <span m='1081530'>ideas?</span>
  <span m='1083520'>You</span> <span m='1083650'>commit,</span> <span m='1084090'>and</span>
  <span m='1084210'>only</span> <span m='1084420'>reveal</span> <span m='1084720'>part</span>
  <span m='1084990'>of</span> <span m='1085080'>a</span> <span m='1085110'>commitment.</span>
  <span m='1086340'>So</span> <span m='1087800'>the cause</span> <span m='1088160'>of
  and</span> <span m='1088380'>solution</span> <span m='1088730'>to</span> <span m='1088940'>all</span>
  <span m='1089090'>of</span> <span m='1089220'>blockchain's</span> <span m='1089600'>problems--</span>
  <span m='1089990'>Merkle</span> <span m='1090230'>trees.</span> <span m='1090830'>That's</span>
  <span m='1091070'>sort</span> <span m='1091280'>of</span> <span m='1091400'>the</span>
  <span m='1091520'>solution</span> <span m='1092030'>for</span> <span m='1092300'>all--</span>
  <span m='1092930'>throw a</span> <span m='1093140'>Merkle</span> <span m='1093380'>tree</span>
  <span m='1093590'>on</span> <span m='1093710'>it,</span> <span m='1093960'>which</span>
  <span m='1094070'>is</span> <span m='1094160'>sort</span> <span m='1094400'>of</span>
  <span m='1095000'>actually</span> <span m='1095240'>what</span> <span m='1095330'>I'm</span>
  <span m='1095420'>working</span> <span m='1095630'>on</span> <span m='1095720'>now,</span>
  <span m='1097360'>for</span> <span m='1097490'>another</span> <span m='1097760'>thing.</span>
  </p><p><span m='1100180'>So</span> <span m='1100380'>you</span> <span m='1100550'>commit</span>
  <span m='1100910'>to</span> <span m='1101240'>some</span> <span m='1101450'>kind</span>
  <span m='1101660'>of</span> <span m='1101810'>root,</span> <span m='1102350'>and</span>
  <span m='1102680'>then</span> <span m='1103040'>you</span> <span m='1104900'>reveal</span>
  <span m='1105530'>only</span> <span m='1105890'>part</span> <span m='1106430'>of</span>
  <span m='1106610'>what</span> <span m='1106760'>you've</span> <span m='1106880'>committed</span>
  <span m='1107180'>to.</span> <span m='1108440'>So</span> <span m='1109250'>the</span>
  <span m='1109400'>idea,</span> <span m='1109940'>which</span> <span m='1110270'>is</span>
  <span m='1110450'>from--</span> <span m='1114240'>there's</span> <span m='1114540'>debate</span>
  <span m='1114870'>about</span> <span m='1115050'>who</span> <span m='1115260'>came</span>
  <span m='1115500'>up</span> <span m='1115620'>with</span> <span m='1115740'>this</span>
  <span m='1115860'>stuff--</span> <span m='1116430'>MAST.</span> <span m='1116970'>Like</span>
  <span m='1117750'>Peter</span> <span m='1118080'>[? Wohl ?]</span> <span m='1118440'>was</span>
  <span m='1118680'>into</span> <span m='1119010'>it,</span> <span m='1119150'>but</span>
  <span m='1119310'>then</span> <span m='1119550'>someone</span> <span m='1119850'>else</span>
  <span m='1119970'>said</span> <span m='1120150'>they</span> <span m='1120300'>wrote</span>
  <span m='1120480'>a</span> <span m='1120540'>paper</span> <span m='1120810'>about</span>
  <span m='1121050'>it.</span> <span m='1121270'>I</span> <span m='1121370'>don't</span>
  <span m='1121380'>know.</span> <span m='1121950'>It</span> <span m='1122040'>was</span>
  <span m='1122130'>like</span> <span m='1122280'>2013,</span> <span m='1123270'>2014.</span>
  </p><p><span m='1124170'>The</span> <span m='1125010'>original</span> <span m='1125340'>idea</span>
  <span m='1125580'>was</span> <span m='1126600'>make</span> <span m='1126960'>a</span>
  <span m='1127260'>merkelized</span> <span m='1128880'>abstract</span> <span m='1129540'>syntax</span>
  <span m='1130020'>tree.</span> <span m='1131340'>So</span> <span m='1131670'>if</span>
  <span m='1131820'>you</span> <span m='1132270'>have</span> <span m='1132630'>done</span>
  <span m='1132930'>any</span> <span m='1133380'>programming</span> <span m='1133890'>language</span>
  <span m='1134550'>courses,</span> <span m='1135270'>you</span> <span m='1135360'>probably</span>
  <span m='1135930'>recognize</span> <span m='1136440'>the</span> <span m='1136500'>term</span>
  <span m='1137250'>abstract</span> <span m='1137820'>syntax</span> <span m='1138360'>tree</span>
  <span m='1138630'>asked,</span> <span m='1139800'>which</span> <span m='1140010'>is</span>
  <span m='1140100'>sort</span> <span m='1140340'>of</span> <span m='1140430'>how</span>
  <span m='1140580'>compilers</span> <span m='1141180'>work.</span> <span m='1141510'>They</span>
  <span m='1141660'>make</span> <span m='1141840'>this</span> <span m='1142010'>tree.</span>
  </p><p><span m='1143040'>So</span> <span m='1143220'>the</span> <span m='1143310'>idea</span>
  <span m='1143490'>is,</span> <span m='1143640'>OK,</span> <span m='1143880'>we'll</span>
  <span m='1144000'>make</span> <span m='1144270'>every</span> <span m='1144690'>node</span>
  <span m='1145110'>in</span> <span m='1145290'>that</span> <span m='1145440'>tree</span>
  <span m='1146460'>like</span> <span m='1146670'>a</span> <span m='1146700'>Merkle</span>
  <span m='1147070'>root,</span> <span m='1148310'>so</span> <span m='1148500'>every</span>
  <span m='1148830'>single</span> <span m='1149130'>OP</span> <span m='1149340'>code</span>
  <span m='1149670'>can</span> <span m='1149910'>be</span> <span m='1150150'>revealed</span>
  <span m='1150710'>and</span> <span m='1150890'>be</span> <span m='1151230'>swapped</span>
  <span m='1151590'>out.</span> <span m='1152120'>And</span> <span m='1152220'>it's</span>
  <span m='1152490'>super</span> <span m='1153090'>crazy.</span> <span m='1153840'>That's</span>
  <span m='1154050'>sort</span> <span m='1154290'>of</span> <span m='1154380'>overkill.</span>
  <span m='1154920'>So</span> <span m='1155130'>that</span> <span m='1155310'>was</span>
  <span m='1155490'>part</span> <span m='1155820'>of</span> <span m='1155910'>the</span>
  <span m='1156030'>initial</span> <span m='1156600'>idea</span> <span m='1157110'>and</span>
  <span m='1157230'>paper.</span> <span m='1158760'>But</span> <span m='1159300'>a</span>
  <span m='1159390'>much</span> <span m='1159660'>simpler</span> <span m='1160320'>way</span>
  <span m='1160590'>to</span> <span m='1160680'>reason</span> <span m='1160980'>about</span>
  <span m='1161220'>it</span> <span m='1161340'>and</span> <span m='1161580'>program</span>
  <span m='1162000'>it</span> <span m='1162210'>would</span> <span m='1162360'>just</span>
  <span m='1162540'>be</span> <span m='1163380'>something</span> <span m='1163680'>like,</span>
  <span m='1163830'>pay</span> <span m='1164070'>to</span> <span m='1164220'>script</span>
  <span m='1164520'>Merkle</span> <span m='1164820'>root.</span> <span m='1165780'>Where</span>
  <span m='1167850'>in</span> <span m='1167940'>my</span> <span m='1168090'>output</span>
  <span m='1168420'>script</span> <span m='1168920'>I</span> <span m='1168960'>have</span>
  <span m='1169140'>a</span> <span m='1169200'>root,</span> <span m='1169830'>and</span>
  <span m='1169980'>then</span> <span m='1170100'>I</span> <span m='1170190'>reveal</span>
  <span m='1171120'>that</span> <span m='1171660'>there</span> <span m='1171870'>is</span>
  <span m='1172050'>a</span> <span m='1172110'>script</span> <span m='1172560'>that</span>
  <span m='1173250'>goes</span> <span m='1173580'>into</span> <span m='1173790'>that</span>
  <span m='1174000'>root,</span> <span m='1175460'>and</span> <span m='1175620'>then</span>
  <span m='1175760'>execute</span> <span m='1176160'>that</span> <span m='1176310'>script.</span>
  </p><p><span m='1178290'>So</span> <span m='1178370'>for</span> <span m='1178460'>example,</span>
  <span m='1179700'>I</span> <span m='1179800'>make</span> <span m='1180200'>four</span>
  <span m='1180440'>different</span> <span m='1180710'>scripts.</span> <span m='1181550'>So</span>
  <span m='1182000'>this</span> <span m='1182180'>would</span> <span m='1182330'>be--</span>
  <span m='1186810'>anyway,</span> <span m='1187170'>it's</span> <span m='1187320'>just</span>
  <span m='1187600'>four</span> <span m='1187740'>different</span> <span m='1188010'>scripts.</span>
  <span m='1189120'>There's</span> <span m='1189360'>an</span> <span m='1189780'>O-2</span>
  <span m='1190170'>choose n,</span> <span m='1191120'>that</span> <span m='1191460'>results</span>
  <span m='1191940'>in</span> <span m='1192090'>four.</span> <span m='1193080'>I</span>
  <span m='1193140'>don't</span> <span m='1193320'>think</span> <span m='1193470'>so.</span>
  <span m='1194580'>But</span> <span m='1194970'>you</span> <span m='1195060'>know,</span>
  <span m='1195240'>this</span> <span m='1195420'>is</span> <span m='1195630'>Alice
  and</span> <span m='1195910'>Bob.</span> <span m='1196260'>This</span> <span m='1196440'>is</span>
  <span m='1196530'>Bob and</span> <span m='1196760'>Carol.</span> <span m='1197100'>This</span>
  <span m='1197280'>is</span> <span m='1197370'>Carol and</span> <span m='1197700'>Dave.</span>
  <span m='1198010'>This</span> <span m='1198180'>is</span> <span m='1198300'>Dave</span>
  <span m='1198570'>and</span> <span m='1199440'>Edna,</span> <span m='1199890'>or</span>
  <span m='1199980'>something.</span> <span m='1201570'>And</span> <span m='1201840'>any</span>
  <span m='1203310'>of</span> <span m='1203400'>these</span> <span m='1203640'>two</span>
  <span m='1204360'>people,</span> <span m='1205050'>but</span> <span m='1205620'>four</span>
  <span m='1205830'>different</span> <span m='1206070'>groups,</span> <span m='1206610'>can</span>
  <span m='1206790'>sign.</span> </p><p><span m='1209820'>And</span> <span m='1209940'>then</span>
  <span m='1210180'>this</span> <span m='1210630'>is</span> <span m='1210780'>what</span>
  <span m='1210930'>you</span> <span m='1211050'>actually</span> <span m='1211350'>put</span>
  <span m='1211680'>in</span> <span m='1211830'>your</span> <span m='1211980'>output</span>
  <span m='1212280'>script.</span> <span m='1212940'>And</span> <span m='1213030'>then</span>
  <span m='1213150'>when</span> <span m='1213300'>you</span> <span m='1213360'>want</span>
  <span m='1213510'>to</span> <span m='1213570'>spend,</span> <span m='1214230'>you</span>
  <span m='1214350'>say,</span> <span m='1214530'>OK,</span> <span m='1214750'>I'm</span>
  <span m='1214880'>going</span> <span m='1215070'>to</span> <span m='1215130'>provide</span>
  <span m='1215460'>a</span> <span m='1215520'>proof.</span> <span m='1216690'>So</span>
  <span m='1216900'>to</span> <span m='1216980'>spend,</span> <span m='1217500'>reveal</span>
  <span m='1217890'>which</span> <span m='1218220'>I'm</span> <span m='1218340'>spending.</span>
  <span m='1218760'>So</span> <span m='1218940'>for</span> <span m='1219030'>example,</span>
  <span m='1219390'>I'm</span> <span m='1219600'>spending</span> <span m='1220050'>using</span>
  <span m='1220500'>script</span> <span m='1220800'>3.</span> <span m='1222060'>And</span>
  <span m='1222330'>then</span> <span m='1222510'>I</span> <span m='1222570'>reveal</span>
  <span m='1222900'>a</span> <span m='1222930'>path</span> <span m='1223560'>to</span>
  <span m='1223680'>the</span> <span m='1223770'>root,</span> <span m='1224220'>which</span>
  <span m='1224460'>would</span> <span m='1224640'>be</span> <span m='1225430'>I</span>
  <span m='1225520'>reveal</span> <span m='1225990'>4,</span> <span m='1226740'>and</span>
  <span m='1227580'>this,</span> <span m='1229470'>and</span> <span m='1229830'>then</span>
  <span m='1230280'>you</span> <span m='1230490'>compute.</span> </p><p><span m='1231120'>You</span>
  <span m='1231180'>say,</span> <span m='1231360'>OK,</span> <span m='1231870'>hash</span>
  <span m='1232180'>these</span> <span m='1232410'>two</span> <span m='1232560'>things</span>
  <span m='1232860'>together,</span> <span m='1234250'>you</span> <span m='1234350'>get</span>
  <span m='1234390'>that.</span> <span m='1235440'>Hash</span> <span m='1235690'>of</span>
  <span m='1235730'>these</span> <span m='1235920'>two</span> <span m='1236070'>things</span>
  <span m='1236340'>together,</span> <span m='1237670'>you</span> <span m='1237770'>get</span>
  <span m='1237870'>that.</span> <span m='1238710'>And</span> <span m='1239010'>confirm</span>
  <span m='1239880'>that</span> <span m='1240300'>the</span> <span m='1240450'>result</span>
  <span m='1241140'>is</span> <span m='1241350'>equal</span> <span m='1241740'>to</span>
  <span m='1242010'>what</span> <span m='1242220'>was</span> <span m='1242430'>in</span>
  <span m='1242520'>the</span> <span m='1242640'>output</span> <span m='1242910'>script.</span>
  <span m='1243880'>And</span> <span m='1243900'>if</span> <span m='1243990'>it</span>
  <span m='1244080'>is,</span> <span m='1244500'>OK,</span> <span m='1244830'>you've</span>
  <span m='1245010'>provided</span> <span m='1245430'>a</span> <span m='1245490'>valid</span>
  <span m='1247950'>inclusion</span> <span m='1248430'>proof</span> <span m='1248730'>that</span>
  <span m='1248850'>script</span> <span m='1249150'>3</span> <span m='1249810'>was</span>
  <span m='1250350'>inside</span> <span m='1251220'>this</span> <span m='1251460'>root.</span>
  </p><p><span m='1253890'>What's</span> <span m='1254130'>kind</span> <span m='1254370'>of</span>
  <span m='1254430'>cool--</span> <span m='1254910'>in</span> <span m='1255060'>this</span>
  <span m='1255270'>case,</span> <span m='1255670'>you</span> <span m='1255720'>do</span>
  <span m='1255840'>not</span> <span m='1256200'>need</span> <span m='1256620'>the</span>
  <span m='1257190'>binary</span> <span m='1257640'>tree</span> <span m='1257790'>to</span>
  <span m='1257880'>be</span> <span m='1258000'>perfect.</span> <span m='1258690'>You</span>
  <span m='1258810'>can</span> <span m='1258990'>have</span> <span m='1260630'>different</span>
  <span m='1260960'>heights,</span> <span m='1261770'>because</span> <span m='1262040'>you're</span>
  <span m='1262340'>not</span> <span m='1262490'>committing</span> <span m='1263030'>to</span>
  <span m='1263150'>the</span> <span m='1263270'>height</span> <span m='1263510'>of</span>
  <span m='1263600'>the</span> <span m='1263690'>tree</span> <span m='1264020'>when</span>
  <span m='1264170'>you're</span> <span m='1264290'>sending</span> <span m='1264590'>to</span>
  <span m='1264740'>it.</span> <span m='1265340'>So</span> <span m='1266180'>the</span>
  <span m='1268640'>default</span> <span m='1269210'>case</span> <span m='1269660'>could</span>
  <span m='1269840'>be</span> <span m='1269990'>here,</span> <span m='1271010'>and</span>
  <span m='1271160'>then</span> <span m='1271310'>a</span> <span m='1271370'>really</span>
  <span m='1271670'>big</span> <span m='1271910'>tree</span> <span m='1272210'>that</span>
  <span m='1272360'>goes</span> <span m='1272750'>down</span> <span m='1273020'>a</span>
  <span m='1273050'>lot</span> <span m='1273470'>over</span> <span m='1273710'>here.</span>
  </p><p><span m='1274340'>So</span> <span m='1274760'>in</span> <span m='1274880'>most</span>
  <span m='1275180'>cases</span> <span m='1276660'>it's</span> <span m='1276740'>going</span>
  <span m='1276890'>to</span> <span m='1276980'>be</span> <span m='1277130'>Alice</span>
  <span m='1277230'>and</span> <span m='1277490'>Bob</span> <span m='1277700'>signing.</span>
  <span m='1279080'>And</span> <span m='1279200'>then</span> <span m='1279650'>Carol
  and</span> <span m='1280040'>Dave,</span> <span m='1280910'>and</span> <span m='1281900'>Edna</span>
  <span m='1282350'>and</span> <span m='1282650'>whatever,</span> <span m='1283730'>are</span>
  <span m='1284660'>unlikely.</span> <span m='1285380'>So</span> <span m='1285680'>I'm</span>
  <span m='1286910'>going</span> <span m='1287030'>to</span> <span m='1287090'>put</span>
  <span m='1287270'>Alice</span> <span m='1287370'>and</span> <span m='1287570'>Bob</span>
  <span m='1287720'>here,</span> <span m='1288710'>and</span> <span m='1288800'>then</span>
  <span m='1288920'>have</span> <span m='1289040'>the</span> <span m='1289130'>tree</span>
  <span m='1289340'>sort</span> <span m='1289490'>of</span> <span m='1289580'>asymmetrically</span>
  <span m='1290240'>get</span> <span m='1290420'>longer</span> <span m='1290750'>over</span>
  <span m='1290900'>here.</span> <span m='1291470'>So</span> <span m='1291620'>that</span>
  <span m='1291710'>when</span> <span m='1291860'>Alice</span> <span m='1292010'>and</span>
  <span m='1292190'>Bob</span> <span m='1292460'>sign,</span> <span m='1293420'>they</span>
  <span m='1293630'>can</span> <span m='1293930'>just</span> <span m='1294260'>reveal</span>
  <span m='1294620'>this.</span> <span m='1295670'>And</span> <span m='1295850'>then</span>
  <span m='1295970'>when</span> <span m='1296240'>the</span> <span m='1296390'>other</span>
  <span m='1296570'>people</span> <span m='1296780'>sign,</span> <span m='1296960'>they're</span>
  <span m='1297050'>going</span> <span m='1297110'>to</span> <span m='1297170'>have</span>
  <span m='1297260'>to</span> <span m='1297350'>reveal</span> <span m='1297680'>this</span>
  <span m='1298160'>and</span> <span m='1298580'>this.</span> <span m='1299960'>And</span>
  <span m='1300140'>then</span> <span m='1300350'>I</span> <span m='1300620'>optimize</span>
  <span m='1301430'>my</span> <span m='1301720'>space</span> <span m='1302240'>for</span>
  <span m='1302510'>the</span> <span m='1302660'>most</span> <span m='1302900'>likely</span>
  <span m='1303200'>case.</span> <span m='1304490'>So</span> <span m='1304610'>that's</span>
  <span m='1304760'>kind</span> <span m='1304910'>of</span> <span m='1304970'>cool.</span>
  </p><p><span m='1308010'>What</span> <span m='1308220'>else?</span> <span m='1310020'>However,</span>
  <span m='1310590'>there</span> <span m='1310800'>are</span> <span m='1311850'>a</span>
  <span m='1311880'>bunch</span> <span m='1312060'>of</span> <span m='1312120'>problems.</span>
  <span m='1312530'>One,</span> <span m='1313170'>OK,</span> <span m='1313460'>2</span>
  <span m='1313610'>of</span> <span m='1313680'>50</span> <span m='1313980'>is</span>
  <span m='1314100'>cool.</span> <span m='1315400'>So</span> <span m='1315460'>in</span>
  <span m='1315720'>the</span> <span m='1315780'>case</span> <span m='1315990'>of</span>
  <span m='1316050'>250,</span> <span m='1316530'>let's</span> <span m='1316680'>just</span>
  <span m='1316860'>look</span> <span m='1317040'>through</span> <span m='1317190'>it.</span>
  <span m='1319230'>50</span> <span m='1319980'>choose</span> <span m='1320310'>2--</span>
  <span m='1320580'>I</span> <span m='1320670'>couldn't</span> <span m='1320970'>make</span>
  <span m='1321150'>the</span> <span m='1321240'>little</span> <span m='1321480'>numbers</span>
  <span m='1321870'>in</span> <span m='1321960'>parentheses</span> <span m='1322800'>the
  right--</span> <span m='1324000'>whatever.</span> <span m='1324960'>So</span> <span
  m='1325110'>that's</span> <span m='1325320'>1,225</span> <span m='1326730'>different</span>
  <span m='1327000'>scripts.</span> <span m='1327960'>And</span> <span m='1329430'>if</span>
  <span m='1329550'>you</span> <span m='1329670'>do</span> <span m='1330030'>a</span>
  <span m='1332830'>regular</span> <span m='1333190'>binary</span> <span m='1333520'>tree--</span>
  <span m='1334420'>balanced--</span> <span m='1335920'>I</span> <span m='1336070'>forget</span>
  <span m='1336340'>all</span> <span m='1336430'>the</span> <span m='1336490'>words--</span>
  <span m='1337690'>you</span> <span m='1337810'>get</span> <span m='1337900'>a</span>
  <span m='1337960'>tree</span> <span m='1338140'>height</span> <span m='1338290'>of</span>
  <span m='1338410'>11.</span> <span m='1339340'>Which</span> <span m='1339520'>is</span>
  <span m='1341110'>kind</span> <span m='1341380'>of</span> <span m='1341620'>like,</span>
  <span m='1341770'>oh,</span> <span m='1342010'>it's so</span> <span m='1342220'>close,</span>
  <span m='1342580'>right?</span> <span m='1342780'>If</span> <span m='1342850'>it</span>
  <span m='1342910'>was</span> <span m='1343050'>1,024,</span> <span m='1343630'>it'd</span>
  <span m='1343740'>be</span> <span m='1343840'>10,</span> <span m='1344110'>but</span>
  <span m='1344610'>a</span> <span m='1344660'>little</span> <span m='1344980'>over.</span>
  </p><p><span m='1348120'>And</span> <span m='1348300'>actually,</span> <span m='1348540'>since</span>
  <span m='1348780'>it</span> <span m='1348870'>doesn't</span> <span m='1349140'>have</span>
  <span m='1349260'>to</span> <span m='1349350'>be</span> <span m='1349440'>symmetric,</span>
  <span m='1349860'>you</span> <span m='1349950'>can</span> <span m='1350100'>get</span>
  <span m='1350250'>like</span> <span m='1350580'>tree</span> <span m='1350760'>height</span>
  <span m='1350910'>10</span> <span m='1351390'>for</span> <span m='1351510'>most</span>
  <span m='1351750'>leaves,</span> <span m='1352110'>and</span> <span m='1352200'>then</span>
  <span m='1352320'>11</span> <span m='1352620'>for</span> <span m='1352740'>some</span>
  <span m='1352920'>of</span> <span m='1353010'>them.</span> <span m='1353800'>Anyway,</span>
  <span m='1354120'>so</span> <span m='1354240'>your</span> <span m='1354320'>proof</span>
  <span m='1354530'>size</span> <span m='1354810'>is</span> <span m='1354930'>going</span>
  <span m='1355020'>to</span> <span m='1355110'>be</span> <span m='1355250'>352</span>
  <span m='1355920'>bytes,</span> <span m='1356860'>which</span> <span m='1356940'>is</span>
  <span m='1357890'>OK.</span> <span m='1358740'>And</span> <span m='1359010'>if</span>
  <span m='1359130'>you</span> <span m='1359250'>didn't</span> <span m='1360180'>use</span>
  <span m='1360420'>MAST,</span> <span m='1361200'>you</span> <span m='1361330'>can
  say,</span> <span m='1361470'>well,</span> <span m='1361620'>I'm</span> <span m='1361770'>just</span>
  <span m='1361920'>going</span> <span m='1362030'>to</span> <span m='1362280'>have</span>
  <span m='1362600'>a</span> <span m='1362800'>pay</span> <span m='1362970'>to</span>
  <span m='1363030'>script</span> <span m='1363330'>hash.</span> </p><p><span m='1364120'>And</span>
  <span m='1364410'>this</span> <span m='1364560'>script</span> <span m='1365070'>is</span>
  <span m='1365220'>just</span> <span m='1365400'>going</span> <span m='1365540'>to</span>
  <span m='1365580'>show</span> <span m='1365910'>all</span> <span m='1366060'>50</span>
  <span m='1366390'>keys,</span> <span m='1367380'>and</span> <span m='1367500'>have</span>
  <span m='1367740'>OP_2,</span> <span m='1368930'>all</span> <span m='1369090'>50</span>
  <span m='1369360'>keys,</span> <span m='1370080'>OP_3.</span> <span m='1370780'>And</span>
  <span m='1370900'>that</span> <span m='1370980'>would</span> <span m='1371070'>be</span>
  <span m='1371190'>about</span> <span m='1372210'>plus</span> <span m='1372690'>3,</span>
  <span m='1372960'>or</span> <span m='1373050'>something,</span> <span m='1373410'>but</span>
  <span m='1373740'>1,650</span> <span m='1374910'>bytes.</span> <span m='1376690'>So</span>
  <span m='1376880'>MAST</span> <span m='1377410'>is</span> <span m='1377620'>an</span>
  <span m='1377680'>improvement.</span> <span m='1379980'>And</span> <span m='1380170'>it's</span>
  <span m='1380260'>sort</span> <span m='1380440'>of</span> <span m='1380500'>like,</span>
  <span m='1380780'>hey,</span> <span m='1380990'>I'm</span> <span m='1381010'>doing</span>
  <span m='1381280'>log</span> <span m='1381550'>n.</span> <span m='1382250'>And</span>
  <span m='1382390'>for</span> <span m='1382570'>all</span> <span m='1382690'>the</span>
  <span m='1382810'>different</span> <span m='1383170'>scripts,</span> <span m='1383660'>I
  have</span> <span m='1383860'>log</span> <span m='1384070'>n.</span> <span m='1384220'>If</span>
  <span m='1384370'>I</span> <span m='1384460'>actually</span> <span m='1384730'>committed</span>
  <span m='1385090'>to</span> <span m='1385240'>all</span> <span m='1385660'>the</span>
  <span m='1385780'>1,225</span> <span m='1387010'>scripts</span> <span m='1387310'>with</span>
  <span m='1387460'>each</span> <span m='1387670'>of</span> <span m='1387760'>the</span>
  <span m='1387850'>two</span> <span m='1388000'>keys,</span> <span m='1388530'>it'd</span>
  <span m='1388630'>be</span> <span m='1388720'>much</span> <span m='1388930'>bigger.</span>
  <span m='1389650'>But</span> <span m='1389920'>I</span> <span m='1390010'>don't</span>
  <span m='1390280'>actually</span> <span m='1390580'>have</span> <span m='1390730'>to,</span>
  <span m='1390880'>because</span> <span m='1391120'>I've</span> <span m='1391210'>got</span>
  <span m='1391390'>this</span> <span m='1391570'>whole</span> <span m='1392080'>50</span>
  <span m='1392380'>choose</span> <span m='1392650'>2</span> <span m='1392830'>in</span>
  <span m='1392950'>here.</span> <span m='1393520'>So</span> <span m='1393640'>I've</span>
  <span m='1393700'>got</span> <span m='1393850'>two</span> <span m='1394090'>things.</span>
  <span m='1394540'>I've</span> <span m='1394630'>got</span> <span m='1394750'>this</span>
  <span m='1394870'>combinatorial</span> <span m='1395410'>thing,</span> <span m='1395770'>and</span>
  <span m='1396040'>then</span> <span m='1396190'>this</span> <span m='1396310'>log</span>
  <span m='1396610'>thing.</span> <span m='1397710'>And</span> <span m='1397870'>in</span>
  <span m='1397960'>balance,</span> <span m='1398350'>it's</span> <span m='1398470'>like,</span>
  <span m='1398650'>OK,</span> <span m='1399580'>meh--</span> <span m='1400030'>like,</span>
  <span m='1400330'>better,</span> <span m='1400930'>but</span> <span m='1401230'>not</span>
  <span m='1401620'>actually</span> <span m='1401980'>that</span> <span m='1402190'>awesome.</span>
  <span m='1403360'>You're</span> <span m='1403450'>going</span> <span m='1403690'>from</span>
  <span m='1403960'>1.6k</span> <span m='1405050'>to</span> <span m='1405620'>350</span>
  <span m='1405850'>bytes.</span> </p><p><span m='1407050'>It</span> <span m='1407140'>gets</span>
  <span m='1407290'>worse.</span> <span m='1408130'>Let's</span> <span m='1408280'>say</span>
  <span m='1408340'>I</span> <span m='1408400'>want</span> <span m='1408520'>to</span>
  <span m='1408580'>do</span> <span m='1408670'>25</span> <span m='1409270'>of</span>
  <span m='1409330'>50.</span> <span m='1410230'>Well,</span> <span m='1410380'>that's</span>
  <span m='1410590'>50</span> <span m='1411010'>choose</span> <span m='1411080'>25,</span>
  <span m='1411580'>which</span> <span m='1411730'>is</span> <span m='1411820'>around</span>
  <span m='1412000'>100</span> <span m='1412300'>trillion</span> <span m='1412930'>different</span>
  <span m='1413230'>combinations.</span> <span m='1414990'>The</span> <span m='1415120'>tree</span>
  <span m='1415360'>height</span> <span m='1415540'>would</span> <span m='1415630'>now</span>
  <span m='1415750'>be</span> <span m='1415870'>47.</span> <span m='1417340'>The</span>
  <span m='1417430'>proof</span> <span m='1417730'>size</span> <span m='1418090'>is</span>
  <span m='1418210'>going</span> <span m='1418290'>to</span> <span m='1418390'>be--</span>
  <span m='1419960'>wait,</span> <span m='1420660'>did</span> <span m='1420830'>I</span>
  <span m='1421700'>do</span> <span m='1421820'>that</span> <span m='1421970'>wrong?</span>
  <span m='1423140'>Hold</span> <span m='1423350'>on.</span> <span m='1426400'>47</span>
  <span m='1427160'>by</span> <span m='1428050'>32</span> <span m='1429170'>is</span>
  <span m='1429320'>1,504.</span> <span m='1429980'>OK,</span> <span m='1430260'>sorry,</span>
  <span m='1432080'>for</span> <span m='1432170'>some</span> <span m='1432320'>reason
  I have</span> <span m='1432650'>22</span> <span m='1432950'>there.</span> <span
  m='1433160'>Sorry,</span> <span m='1433820'>I'll</span> <span m='1433880'>fix</span>
  <span m='1434060'>that.</span> <span m='1435230'>But</span> <span m='1435440'>that</span>
  <span m='1435650'>is</span> <span m='1435920'>correct.</span> <span m='1437360'>Yeah,</span>
  <span m='1438110'>1,504.</span> <span m='1439070'>So</span> <span m='1439340'>1.5k,</span>
  <span m='1440720'>whereas</span> <span m='1440990'>the</span> <span m='1441080'>raw</span>
  <span m='1441320'>would</span> <span m='1441470'>still</span> <span m='1441650'>be</span>
  <span m='1441800'>1,650.</span> <span m='1443270'>These</span> <span m='1443450'>are</span>
  <span m='1443540'>about</span> <span m='1443750'>the</span> <span m='1443810'>same.</span>
  <span m='1444560'>This</span> <span m='1444740'>is</span> <span m='1444860'>not</span>
  <span m='1445190'>a</span> <span m='1445250'>great</span> <span m='1445490'>space</span>
  <span m='1445730'>savings.</span> <span m='1446550'>Your</span> <span m='1446840'>proofs</span>
  <span m='1447710'>are</span> <span m='1447800'>huge.</span> </p><p><span m='1449150'>In</span>
  <span m='1449300'>fact,</span> <span m='1449990'>I</span> <span m='1450110'>would</span>
  <span m='1450290'>say</span> <span m='1450770'>it's</span> <span m='1450920'>not</span>
  <span m='1451100'>only</span> <span m='1451250'>not</span> <span m='1451400'>much</span>
  <span m='1451580'>better,</span> <span m='1452420'>it's</span> <span m='1452570'>worse.</span>
  <span m='1453280'>You're</span> <span m='1453370'>going</span> <span m='1453430'>to</span>
  <span m='1453500'>have</span> <span m='1453590'>to</span> <span m='1453710'>compute</span>
  <span m='1454370'>200</span> <span m='1454820'>trillion</span> <span m='1455210'>hashes</span>
  <span m='1455990'>in</span> <span m='1456110'>order</span> <span m='1456290'>to</span>
  <span m='1456350'>compute</span> <span m='1456650'>that</span> <span m='1456830'>root,</span>
  <span m='1457520'>as</span> <span m='1457640'>the</span> <span m='1457730'>person</span>
  <span m='1457970'>creating</span> <span m='1458420'>the</span> <span m='1458540'>output</span>
  <span m='1458780'>script.</span> <span m='1459500'>To</span> <span m='1459650'>verify</span>
  <span m='1460520'>inclusion,</span> <span m='1462020'>you</span> <span m='1462170'>have</span>
  <span m='1462260'>to</span> <span m='1462350'>compute</span> <span m='1462770'>47</span>
  <span m='1463310'>hashes,</span> <span m='1463610'>which</span> <span m='1463760'>is</span>
  <span m='1464060'>fine.</span> <span m='1465050'>200</span> <span m='1465410'>trillion</span>
  <span m='1465620'>hashes</span> <span m='1466040'>is</span> <span m='1466760'>doable,</span>
  <span m='1467450'>but</span> <span m='1467660'>that's</span> <span m='1467870'>going</span>
  <span m='1467960'>to</span> <span m='1468050'>take</span> <span m='1468230'>a</span>
  <span m='1468300'>while.</span> <span m='1468680'>And</span> <span m='1469010'>that's</span>
  <span m='1469250'>annoying.</span> <span m='1472140'>How</span> <span m='1472320'>long?</span>
  <span m='1473770'>Hours,</span> <span m='1474980'>days?</span> <span m='1475510'>I</span>
  <span m='1475570'>don't</span> <span m='1475690'>know.</span> <span m='1476020'>Doable,</span>
  <span m='1476470'>but</span> <span m='1476680'>not</span> <span m='1476860'>fun.</span>
  </p><p><span m='1478900'>So</span> <span m='1479080'>MAST</span> <span m='1479470'>doesn't</span>
  <span m='1479920'>really</span> <span m='1480610'>get</span> <span m='1480850'>you</span>
  <span m='1481510'>necessarily</span> <span m='1482050'>what</span> <span m='1482230'>you</span>
  <span m='1482320'>want</span> <span m='1482560'>here,</span> <span m='1483010'>although</span>
  <span m='1483220'>this</span> <span m='1483400'>is</span> <span m='1483520'>kind</span>
  <span m='1483730'>of</span> <span m='1483850'>a</span> <span m='1485820'>silly</span>
  <span m='1486330'>case.</span> <span m='1487020'>None</span> <span m='1487260'>of</span>
  <span m='1487350'>the</span> <span m='1487470'>things</span> <span m='1487770'>really</span>
  <span m='1488130'>get</span> <span m='1488310'>you</span> <span m='1488430'>what</span>
  <span m='1488580'>you</span> <span m='1488670'>want</span> <span m='1488880'>here,</span>
  <span m='1489600'>because</span> <span m='1489960'>of</span> <span m='1490380'>these</span>
  <span m='1490530'>sort</span> <span m='1490710'>of</span> <span m='1490800'>combinatorial</span>
  <span m='1491310'>problems.</span> <span m='1492810'>Any</span> <span m='1492990'>questions,</span>
  <span m='1496730'>or</span> <span m='1496850'>oppositions</span> <span m='1497460'>if</span>
  <span m='1497600'>I</span> <span m='1497700'>have</span> <span m='1497870'>screwed</span>
  <span m='1498170'>up</span> <span m='1498380'>some</span> <span m='1498620'>math</span>
  <span m='1499010'>somewhere?</span> </p><p><span m='1501345'>AUDIENCE:</span> <span
  m='1501578'>[INAUDIBLE]</span> </p><p></p><p><span m='1511290'>TADGE DRYJA:</span>
  <span m='1511455'>So</span> <span m='1512160'>compare</span> <span m='1512460'>these</span>
  <span m='1512640'>two.</span> <span m='1513210'>If</span> <span m='1513390'>I</span>
  <span m='1513660'>show</span> <span m='1514170'>a</span> <span m='1514260'>tree</span>
  <span m='1514530'>height</span> <span m='1514740'>of</span> <span m='1514920'>10</span>
  <span m='1515130'>or</span> <span m='1515190'>11,</span> <span m='1515930'>huh,</span>
  <span m='1516750'>that's</span> <span m='1517020'>weird.</span> <span m='1517600'>There's</span>
  <span m='1517770'>like</span> <span m='1518760'>1,000</span> <span m='1519150'>different</span>
  <span m='1519570'>scripts</span> <span m='1520530'>around</span> <span m='1520860'>in</span>
  <span m='1520950'>this</span> <span m='1521130'>tree.</span> <span m='1521910'>If</span>
  <span m='1522000'>I</span> <span m='1522090'>show</span> <span m='1522300'>a</span>
  <span m='1522330'>tree</span> <span m='1522570'>height</span> <span m='1522750'>of</span>
  <span m='1522810'>47,</span> <span m='1523860'>that's</span> <span m='1524160'>really</span>
  <span m='1524460'>weird.</span> <span m='1524820'>Someone</span> <span m='1525420'>either</span>
  <span m='1525750'>was</span> <span m='1525900'>just</span> <span m='1526080'>joking</span>
  <span m='1526410'>around</span> <span m='1527340'>and</span> <span m='1527490'>made</span>
  <span m='1527790'>this</span> <span m='1528000'>weird</span> <span m='1528540'>sparse</span>
  <span m='1529080'>tree</span> <span m='1529410'>with</span> <span m='1529560'>all</span>
  <span m='1529650'>these</span> <span m='1529800'>branches</span> <span m='1530220'>to</span>
  <span m='1530340'>just</span> <span m='1530850'>screw</span> <span m='1531060'>around</span>
  <span m='1531360'>and</span> <span m='1531450'>have</span> <span m='1532040'>a</span>
  <span m='1532110'>height</span> <span m='1532230'>of</span> <span m='1532290'>47,</span>
  <span m='1533250'>or</span> <span m='1533440'>there's</span> <span m='1533930'>200</span>
  <span m='1534570'>trillion</span> <span m='1535140'>possible</span> <span m='1535860'>spending</span>
  <span m='1537210'>outcomes.</span> <span m='1538560'>So</span> <span m='1538740'>it</span>
  <span m='1538830'>reveals</span> <span m='1539310'>information</span> <span m='1539820'>about</span>
  <span m='1540030'>the</span> <span m='1540120'>things</span> <span m='1540480'>that</span>
  <span m='1540660'>were</span> <span m='1540840'>not</span> <span m='1541320'>spent.</span>
  <span m='1542070'>Even</span> <span m='1542280'>though</span> <span m='1542400'>it</span>
  <span m='1542460'>doesn't</span> <span m='1542730'>reveal</span> <span m='1543180'>what</span>
  <span m='1543510'>the</span> <span m='1543630'>scripts</span> <span m='1543930'>were,</span>
  <span m='1544260'>it</span> <span m='1544470'>to</span> <span m='1544620'>some</span>
  <span m='1544800'>extent</span> <span m='1545070'>reveals</span> <span m='1545430'>how</span>
  <span m='1545550'>many</span> <span m='1545790'>there</span> <span m='1545940'>were.</span>
  </p><p><span m='1552150'>But</span> <span m='1552360'>still</span> <span m='1552750'>it</span>
  <span m='1552870'>is</span> <span m='1553020'>kind</span> <span m='1553260'>of</span>
  <span m='1553320'>useful,</span> <span m='1553620'>right?</span> <span m='1553830'>In</span>
  <span m='1553950'>the</span> <span m='1554010'>2</span> <span m='1554265'>of 50</span>
  <span m='1554520'>case,</span> <span m='1555120'>yes,</span> <span m='1555390'>this</span>
  <span m='1555540'>is</span> <span m='1555630'>better.</span> <span m='1557030'>You</span>
  <span m='1557200'>have</span> <span m='1557290'>to</span> <span m='1557350'>compute</span>
  <span m='1557680'>a</span> <span m='1558170'>thousand-something</span> <span m='1558850'>hashes.</span>
  <span m='1559510'>No</span> <span m='1559660'>big</span> <span m='1559810'>deal.</span>
  <span m='1560740'>You</span> <span m='1561190'>reduce</span> <span m='1561580'>your</span>
  <span m='1561700'>size</span> <span m='1562060'>from</span> <span m='1562630'>1.6k</span>
  <span m='1563590'>to</span> <span m='1563680'>353</span> <span m='1564040'>bytes.</span>
  <span m='1564580'>That's</span> <span m='1564790'>a</span> <span m='1564850'>good</span>
  <span m='1565000'>deal.</span> <span m='1566880'>Here</span> <span m='1567550'>kind</span>
  <span m='1567760'>of</span> <span m='1567850'>not,</span> <span m='1568190'>but</span>
  <span m='1568540'>this</span> <span m='1568780'>is</span> <span m='1568840'>also</span>
  <span m='1569080'>sort</span> <span m='1569290'>of</span> <span m='1569360'>a</span>
  <span m='1569380'>crazy--</span> <span m='1570340'>there's</span> <span m='1570730'>other</span>
  <span m='1570910'>ways</span> <span m='1571120'>to</span> <span m='1571210'>address</span>
  <span m='1571510'>this,</span> <span m='1571690'>but</span> <span m='1572530'>it's</span>
  <span m='1572650'>pretty</span> <span m='1572830'>good.</span> </p><p><span m='1574100'>There's</span>
  <span m='1574750'>sort</span> <span m='1575020'>of</span> <span m='1575320'>two,</span>
  <span m='1576580'>or</span> <span m='1576700'>more</span> <span m='1576910'>than</span>
  <span m='1577060'>two</span> <span m='1577720'>different</span> <span m='1578050'>ways</span>
  <span m='1578650'>to</span> <span m='1579250'>implement</span> <span m='1579670'>this.</span>
  <span m='1580630'>You</span> <span m='1580720'>could</span> <span m='1580840'>just</span>
  <span m='1580960'>say,</span> <span m='1581180'>OK,</span> <span m='1581360'>we're</span>
  <span m='1581370'>going</span> <span m='1581440'>to</span> <span m='1581530'>have</span>
  <span m='1581890'>pay</span> <span m='1582140'>to</span> <span m='1582220'>script</span>
  <span m='1582460'>Merkle</span> <span m='1582730'>root,</span> <span m='1583330'>where</span>
  <span m='1584680'>you</span> <span m='1584800'>have</span> <span m='1584980'>a</span>
  <span m='1585040'>template--</span> <span m='1585760'>where</span> <span m='1585970'>it's</span>
  <span m='1586120'>like</span> <span m='1586360'>OP_2,</span> <span m='1588520'>or</span>
  <span m='1588640'>OP_3,</span> <span m='1589300'>or</span> <span m='1589390'>something,</span>
  <span m='1590050'>and</span> <span m='1590170'>then</span> <span m='1590290'>some</span>
  <span m='1590500'>data.</span> <span m='1591160'>And</span> <span m='1591250'>the</span>
  <span m='1591310'>idea</span> <span m='1591550'>is</span> <span m='1591640'>when</span>
  <span m='1591820'>you</span> <span m='1591940'>spend</span> <span m='1592240'>it,</span>
  <span m='1592390'>you</span> <span m='1592510'>have</span> <span m='1592600'>to</span>
  <span m='1592690'>provide</span> <span m='1593020'>a</span> <span m='1593080'>proof,</span>
  <span m='1594190'>and</span> <span m='1594310'>then</span> <span m='1594430'>the</span>
  <span m='1594520'>script</span> <span m='1594760'>itself.</span> <span m='1595540'>And</span>
  <span m='1595630'>then,</span> <span m='1595750'>you</span> <span m='1595840'>execute</span>
  <span m='1596200'>the</span> <span m='1596260'>script.</span> </p><p><span m='1597340'>Another</span>
  <span m='1597670'>way</span> <span m='1598150'>which</span> <span m='1598330'>is</span>
  <span m='1598720'>kind</span> <span m='1598900'>of</span> <span m='1598990'>cool--</span>
  <span m='1599350'>and</span> <span m='1599620'>people</span> <span m='1599830'>were</span>
  <span m='1599920'>talking</span> <span m='1600130'>about</span> <span m='1600340'>it</span>
  <span m='1600780'>recently--</span> <span m='1601750'>you</span> <span m='1601810'>have</span>
  <span m='1601900'>this</span> <span m='1602470'>tail</span> <span m='1602770'>call</span>
  <span m='1603010'>recursion-looking</span> <span m='1603760'>thing.</span> <span
  m='1604510'>Where</span> <span m='1604780'>the</span> <span m='1604900'>idea</span>
  <span m='1605110'>is,</span> <span m='1605230'>if</span> <span m='1605440'>you</span>
  <span m='1605770'>evaluate</span> <span m='1607480'>your</span> <span m='1607630'>script</span>
  <span m='1608740'>and</span> <span m='1608860'>then</span> <span m='1608980'>there's</span>
  <span m='1609160'>two</span> <span m='1609610'>items</span> <span m='1610030'>left</span>
  <span m='1610270'>on</span> <span m='1610390'>the</span> <span m='1610450'>stack</span>
  <span m='1610750'>at</span> <span m='1610840'>the</span> <span m='1610960'>end,</span>
  <span m='1611740'>what</span> <span m='1611860'>you</span> <span m='1611980'>say</span>
  <span m='1612220'>is,</span> <span m='1612400'>OK--</span> <span m='1614050'>whichever</span>
  <span m='1614380'>is</span> <span m='1614470'>bottom</span> <span m='1614740'>or</span>
  <span m='1614800'>top--</span> <span m='1615400'>one</span> <span m='1615640'>of</span>
  <span m='1615730'>these</span> <span m='1615940'>items,</span> <span m='1616300'>the</span>
  <span m='1616390'>bottom</span> <span m='1616690'>one,</span> <span m='1617260'>is</span>
  <span m='1618280'>a</span> <span m='1620250'>Merkle</span> <span m='1620670'>root.</span>
  </p><p><span m='1621750'>And</span> <span m='1621900'>then</span> <span m='1622080'>the</span>
  <span m='1622200'>other</span> <span m='1623100'>item</span> <span m='1623370'>on</span>
  <span m='1623460'>the</span> <span m='1623520'>stack</span> <span m='1623910'>is</span>
  <span m='1624090'>the</span> <span m='1624210'>proof</span> <span m='1624690'>and</span>
  <span m='1624840'>arguments--</span> <span m='1626610'>another</span> <span m='1627000'>script.</span>
  <span m='1627270'>So</span> <span m='1627390'>you</span> <span m='1627510'>can</span>
  <span m='1627630'>sort</span> <span m='1627780'>of</span> <span m='1627870'>recursively</span>
  <span m='1628710'>say,</span> <span m='1629400'>OK,</span> <span m='1630180'>well,</span>
  <span m='1630330'>I</span> <span m='1630390'>went</span> <span m='1630570'>down</span>
  <span m='1630810'>into</span> <span m='1630990'>this</span> <span m='1631140'>script</span>
  <span m='1631950'>with</span> <span m='1632130'>this</span> <span m='1632280'>proof</span>
  <span m='1632910'>and</span> <span m='1633000'>then</span> <span m='1633120'>executed</span>
  <span m='1633660'>it.</span> <span m='1633750'>And</span> <span m='1633900'>then</span>
  <span m='1634050'>things</span> <span m='1634440'>were</span> <span m='1634560'>left</span>
  <span m='1634950'>on</span> <span m='1635100'>the</span> <span m='1635190'>stack,</span>
  <span m='1635580'>and</span> <span m='1635670'>it</span> <span m='1635760'>was</span>
  <span m='1635880'>another</span> <span m='1636270'>proof,</span> <span m='1637170'>for</span>
  <span m='1637320'>another</span> <span m='1637620'>Merkle</span> <span m='1637940'>root.</span>
  <span m='1639600'>So</span> <span m='1639750'>that's</span> <span m='1639960'>kind</span>
  <span m='1640110'>of</span> <span m='1640170'>cool.</span> <span m='1641170'>You</span>
  <span m='1641220'>can</span> <span m='1642580'>make</span> <span m='1642850'>all</span>
  <span m='1642940'>sorts</span> <span m='1643210'>of</span> <span m='1643270'>crazy</span>
  <span m='1643570'>things</span> <span m='1643780'>with</span> <span m='1643870'>that.</span>
  </p><p><span m='1645010'>I</span> <span m='1645070'>don't</span> <span m='1645220'>know</span>
  <span m='1645310'>how</span> <span m='1645640'>useful</span> <span m='1646990'>recursion</span>
  <span m='1647530'>is</span> <span m='1647710'>in</span> <span m='1647800'>this</span>
  <span m='1647950'>case,</span> <span m='1648220'>but</span> <span m='1648640'>there</span>
  <span m='1648760'>could</span> <span m='1648910'>be</span> <span m='1649060'>cases.</span>
  <span m='1649390'>You're</span> <span m='1649540'>already</span> <span m='1649960'>in</span>
  <span m='1650080'>a</span> <span m='1650110'>binary</span> <span m='1650440'>tree.</span>
  <span m='1650780'>So</span> <span m='1652690'>my</span> <span m='1652900'>personal</span>
  <span m='1653380'>thing</span> <span m='1653590'>is,</span> <span m='1653830'>why</span>
  <span m='1653980'>not</span> <span m='1654100'>just</span> <span m='1654280'>keep</span>
  <span m='1654460'>it</span> <span m='1654520'>simple</span> <span m='1654940'>and</span>
  <span m='1655060'>pay</span> <span m='1655240'>to</span> <span m='1655330'>a</span>
  <span m='1655380'>script</span> <span m='1655600'>Merkle</span> <span m='1655840'>root?</span>
  <span m='1656110'>But</span> <span m='1657070'>there's</span> <span m='1657310'>people</span>
  <span m='1657610'>who</span> <span m='1657850'>think,</span> <span m='1658660'>no,</span>
  <span m='1658810'>this</span> <span m='1658930'>should</span> <span m='1659080'>be</span>
  <span m='1659200'>more</span> <span m='1659560'>expressive,</span> <span m='1660190'>like</span>
  <span m='1660670'>programming</span> <span m='1661150'>language-y</span> <span m='1661570'>wise.</span>
  </p><p><span m='1663560'>Anyway,</span> <span m='1663910'>so</span> <span m='1664060'>that's</span>
  <span m='1664540'>the</span> <span m='1664930'>state</span> <span m='1665290'>of</span>
  <span m='1665380'>MAST.</span> <span m='1665670'>MAST</span> <span m='1666190'>has</span>
  <span m='1666580'>code.</span> <span m='1667720'>There's</span> <span m='1667930'>a</span>
  <span m='1668860'>pull</span> <span m='1669040'>request</span> <span m='1669460'>in</span>
  <span m='1669580'>bip,</span> <span m='1669850'>right?</span> <span m='1670110'>Yeah.</span>
  <span m='1670380'>So</span> <span m='1670780'>there's</span> <span m='1670930'>some</span>
  <span m='1671080'>people</span> <span m='1671320'>who</span> <span m='1671440'>are</span>
  <span m='1671500'>really</span> <span m='1671740'>into</span> <span m='1671890'>MAST.</span>
  <span m='1672850'>And</span> <span m='1673240'>like,</span> <span m='1673660'>let's</span>
  <span m='1674005'>get</span> <span m='1674350'>this</span> <span m='1674530'>into</span>
  <span m='1674680'>Bitcoin.</span> <span m='1675130'>Let's</span> <span m='1675310'>make</span>
  <span m='1675490'>a</span> <span m='1675650'>soft</span> <span m='1675760'>fork.</span>
  <span m='1678080'>And</span> <span m='1678530'>there's</span> <span m='1678770'>also</span>
  <span m='1679010'>people</span> <span m='1679815'>who</span> <span m='1680080'>are</span>
  <span m='1680180'>not</span> <span m='1680360'>as</span> <span m='1680450'>enthusiastic</span>
  <span m='1680730'>about</span> <span m='1681010'>it.</span> <span m='1682100'>And</span>
  <span m='1682490'>so</span> <span m='1682700'>it's</span> <span m='1682820'>like</span>
  <span m='1683360'>no</span> <span m='1683540'>one's</span> <span m='1683960'>opposed</span>
  <span m='1684500'>to</span> <span m='1684680'>it--</span> <span m='1684800'>like,</span>
  <span m='1685010'>this</span> <span m='1685190'>is</span> <span m='1685340'>a</span>
  <span m='1685400'>bad</span> <span m='1685640'>idea,</span> <span m='1686070'>this</span>
  <span m='1686120'>will</span> <span m='1686240'>break</span> <span m='1686510'>Bitcoin.</span>
  <span m='1687380'>But</span> <span m='1687650'>there's</span> <span m='1688250'>varying</span>
  <span m='1688790'>levels</span> <span m='1689390'>of</span> <span m='1690680'>let's</span>
  <span m='1691250'>get</span> <span m='1691400'>this</span> <span m='1691610'>in,</span>
  <span m='1691790'>you</span> <span m='1691880'>can</span> <span m='1692000'>do</span>
  <span m='1692090'>all</span> <span m='1692180'>these</span> <span m='1692330'>cool</span>
  <span m='1692480'>things,</span> <span m='1692920'>versus</span> <span m='1693890'>eh,</span>
  <span m='1694250'>is</span> <span m='1694400'>this</span> <span m='1694550'>really</span>
  <span m='1694800'>a</span> <span m='1694820'>priority?</span> <span m='1695970'>What</span>
  <span m='1696080'>are</span> <span m='1696140'>we</span> <span m='1696260'>going</span>
  <span m='1696380'>to</span> <span m='1696470'>use</span> <span m='1696680'>with</span>
  <span m='1696920'>it,</span> <span m='1697210'>kind</span> <span m='1697390'>of</span>
  <span m='1697550'>thing.</span> </p><p><span m='1698380'>OK,</span> <span m='1698720'>any</span>
  <span m='1698900'>questions</span> <span m='1699230'>about</span> <span m='1699350'>this?</span>
  <span m='1699590'>I</span> <span m='1699650'>think</span> <span m='1699890'>we</span>
  <span m='1700010'>have</span> <span m='1701492'>a</span> <span m='1701900'>quick</span>
  <span m='1702140'>break,</span> <span m='1702470'>and</span> <span m='1702590'>then</span>
  <span m='1702710'>I'll</span> <span m='1703160'>do</span> <span m='1706220'>OP_RETURN,</span>
  <span m='1707450'>which</span> <span m='1707690'>seems</span> <span m='1708380'>unconnected.</span>
  <span m='1708920'>But</span> <span m='1709070'>I</span> <span m='1709160'>will</span>
  <span m='1709280'>show</span> <span m='1709490'>you</span> <span m='1709730'>how</span>
  <span m='1709940'>this</span> <span m='1710690'>connects</span> <span m='1711170'>to</span>
  <span m='1711290'>these</span> <span m='1712400'>issues</span> <span m='1712730'>we</span>
  <span m='1712840'>have.</span> </p><p><span m='1713730'>OK,</span> <span m='1713960'>so</span>
  <span m='1714290'>OP_RETURN,</span> <span m='1715360'>it</span> <span m='1715490'>was</span>
  <span m='1715640'>in</span> <span m='1715820'>the</span> <span m='1715910'>problem</span>
  <span m='1716210'>set.</span> <span m='1716420'>You</span> <span m='1716780'>basically</span>
  <span m='1717260'>put</span> <span m='1717470'>this</span> <span m='1717680'>OP</span>
  <span m='1717830'>code</span> <span m='1718070'>in</span> <span m='1718190'>the</span>
  <span m='1718250'>front</span> <span m='1718550'>of</span> <span m='1718670'>your</span>
  <span m='1718790'>script,</span> <span m='1719630'>and</span> <span m='1719780'>that</span>
  <span m='1719930'>flags</span> <span m='1720530'>it</span> <span m='1720770'>as</span>
  <span m='1721520'>forever</span> <span m='1722000'>unspendable</span> <span m='1723080'>as</span>
  <span m='1723200'>an</span> <span m='1723290'>output.</span> <span m='1724350'>So</span>
  <span m='1724370'>you</span> <span m='1724790'>shouldn't</span> <span m='1725120'>put</span>
  <span m='1725480'>much</span> <span m='1725750'>money</span> <span m='1726140'>into</span>
  <span m='1726380'>these</span> <span m='1726560'>outputs,</span> <span m='1726980'>because</span>
  <span m='1728000'>they</span> <span m='1728360'>are</span> <span m='1728630'>basically</span>
  <span m='1729110'>destroyed.</span> <span m='1729940'>OP_RETURN</span> <span m='1730460'>means</span>
  <span m='1730800'>you</span> <span m='1731930'>immediately</span> <span m='1732440'>return</span>
  <span m='1733040'>from</span> <span m='1733640'>the</span> <span m='1734210'>script</span>
  <span m='1734510'>evaluation,</span> <span m='1735530'>and</span> <span m='1735710'>you</span>
  <span m='1735830'>return a</span> <span m='1736130'>false.</span> </p><p><span m='1736880'>I</span>
  <span m='1736970'>think</span> <span m='1737120'>it</span> <span m='1737210'>used</span>
  <span m='1737630'>to</span> <span m='1737720'>be</span> <span m='1737900'>return</span>
  <span m='1738320'>whatever</span> <span m='1738740'>is</span> <span m='1739010'>on</span>
  <span m='1739130'>the</span> <span m='1739220'>top</span> <span m='1739430'>of</span>
  <span m='1739490'>the</span> <span m='1739550'>stack,</span> <span m='1741080'>which</span>
  <span m='1741410'>meant</span> <span m='1741770'>you</span> <span m='1741890'>could</span>
  <span m='1742040'>just</span> <span m='1742190'>spend</span> <span m='1742400'>anyone's</span>
  <span m='1742760'>money</span> <span m='1743240'>by</span> <span m='1743390'>using</span>
  <span m='1743690'>OP_RETURN.</span> <span m='1744800'>So</span> <span m='1744980'>they</span>
  <span m='1746180'>soft</span> <span m='1746440'>forked</span> <span m='1746600'>that</span>
  <span m='1746870'>to</span> <span m='1747260'>say,</span> <span m='1747470'>no,</span>
  <span m='1747800'>OP_RETURN</span> <span m='1748190'>always</span> <span m='1748430'>fails</span>
  <span m='1748880'>instead</span> <span m='1749180'>of</span> <span m='1749270'>OP_RETURN</span>
  <span m='1749690'>always</span> <span m='1750410'>trivially</span> <span m='1750890'>succeeds--</span>
  <span m='1751460'>which</span> <span m='1751610'>means</span> <span m='1751820'>you</span>
  <span m='1751880'>just</span> <span m='1752030'>put</span> <span m='1752180'>an</span>
  <span m='1752300'>OP_RETURN</span> <span m='1752690'>and</span> <span m='1752760'>take</span>
  <span m='1752880'>anyone's</span> <span m='1753110'>money.</span> <span m='1754460'>So</span>
  <span m='1754550'>they</span> <span m='1754640'>figured</span> <span m='1754850'>that</span>
  <span m='1755000'>one</span> <span m='1755120'>out</span> <span m='1755240'>pretty</span>
  <span m='1755420'>quick.</span> </p><p><span m='1756860'>So</span> <span m='1757070'>people</span>
  <span m='1757430'>use</span> <span m='1757610'>OP_RETURN</span> <span m='1758360'>to</span>
  <span m='1758480'>put</span> <span m='1758660'>data</span> <span m='1759170'>into</span>
  <span m='1759380'>the</span> <span m='1759470'>blockchain.</span> <span m='1760940'>Why</span>
  <span m='1761090'>do</span> <span m='1761210'>people</span> <span m='1761450'>do</span>
  <span m='1761600'>this?</span> <span m='1764480'>You</span> <span m='1764600'>can't</span>
  <span m='1764870'>spend</span> <span m='1765290'>it.</span> <span m='1765470'>You</span>
  <span m='1765560'>can't</span> <span m='1766430'>do</span> <span m='1767030'>anything</span>
  <span m='1767450'>with</span> <span m='1767600'>this</span> <span m='1767810'>data.</span>
  <span m='1768140'>But</span> <span m='1768290'>why</span> <span m='1768530'>do</span>
  <span m='1768650'>people</span> <span m='1768890'>do</span> <span m='1769010'>this?</span>
  <span m='1771600'>It's</span> <span m='1771690'>kind</span> <span m='1771840'>of</span>
  <span m='1771900'>cool,</span> <span m='1772170'>right?</span> <span m='1773580'>To</span>
  <span m='1773730'>prove</span> <span m='1773910'>it's</span> <span m='1774000'>there.</span>
  <span m='1775380'>You</span> <span m='1775590'>want</span> <span m='1775740'>to</span>
  <span m='1775800'>put</span> <span m='1775980'>some</span> <span m='1776160'>data</span>
  <span m='1776400'>in.</span> <span m='1777630'>And</span> <span m='1777810'>you</span>
  <span m='1777990'>just</span> <span m='1778140'>want</span> <span m='1778290'>to</span>
  <span m='1778350'>say,</span> <span m='1778470'>hey,</span> <span m='1778620'>I</span>
  <span m='1778740'>thought</span> <span m='1778920'>of</span> <span m='1778980'>this</span>
  <span m='1779400'>first,</span> <span m='1779820'>or</span> <span m='1779880'>I'm</span>
  <span m='1779970'>making</span> <span m='1780240'>a</span> <span m='1780270'>patent,</span>
  <span m='1783150'>whatever.</span> <span m='1783770'>You</span> <span m='1784140'>put</span>
  <span m='1784290'>data.</span> <span m='1784530'>People</span> <span m='1785280'>use</span>
  <span m='1785430'>a</span> <span m='1785460'>lot</span> <span m='1785700'>of</span>
  <span m='1785790'>OP_RETURN.</span> <span m='1786820'>What</span> <span m='1786900'>was</span>
  <span m='1787080'>it?</span> <span m='1787200'>Like,</span> <span m='1787410'>10%?</span>
  </p><p><span m='1788564'>AUDIENCE:</span> <span m='1788795'>[INAUDIBLE]</span> <span
  m='1789950'>set.</span> <span m='1792650'>[INAUDIBLE]</span> <span m='1793740'>the</span>
  <span m='1794030'>current</span> <span m='1794980'>[INAUDIBLE]</span> <span m='1795220'>set,</span>
  <span m='1795690'>if</span> <span m='1795870'>you</span> <span m='1796050'>remove,</span>
  <span m='1798510'>or</span> <span m='1798600'>if</span> <span m='1798720'>you</span>
  <span m='1798810'>don't</span> <span m='1799515'>for</span> <span m='1799920'>the</span>
  <span m='1800220'>unspendables,</span> <span m='1801030'>it</span> <span m='1801210'>would</span>
  <span m='1801300'>account</span> <span m='1801570'>for</span> <span m='1801720'>about</span>
  <span m='1801960'>10%</span> <span m='1802110'>of</span> <span m='1802552'>[INAUDIBLE]</span>
  <span m='1802994'>data</span> <span m='1803436'>set.</span> </p><p><span m='1803880'>TADGE
  DRYJA:</span> <span m='1804105'>So</span> <span m='1804330'>that's</span> <span
  m='1804570'>a</span> <span m='1804600'>lot</span> <span m='1804780'>of</span> <span
  m='1804840'>data.</span> <span m='1805260'>People</span> <span m='1805530'>were
  using</span> <span m='1805710'>it.</span> <span m='1807160'>There</span> <span m='1807480'>is</span>
  <span m='1807660'>a</span> <span m='1807720'>better</span> <span m='1808020'>way.</span>
  <span m='1810970'>So</span> <span m='1811090'>what</span> <span m='1811210'>if</span>
  <span m='1811300'>you</span> <span m='1811360'>wanted</span> <span m='1811570'>to</span>
  <span m='1811630'>do</span> <span m='1811870'>a</span> <span m='1811990'>0</span>
  <span m='1812410'>byte</span> <span m='1812730'>OP_RETURN?</span> <span m='1814420'>It's</span>
  <span m='1814600'>not</span> <span m='1814750'>quite</span> <span m='1815170'>the</span>
  <span m='1815290'>same.</span> <span m='1815770'>Because</span> <span m='1815980'>an</span>
  <span m='1816070'>OP_RETURN,</span> <span m='1816610'>everyone</span> <span m='1817000'>can</span>
  <span m='1817180'>see</span> <span m='1817510'>it.</span> <span m='1818440'>And</span>
  <span m='1818590'>in</span> <span m='1818710'>some</span> <span m='1818920'>cases,</span>
  <span m='1819350'>you</span> <span m='1819370'>might</span> <span m='1819610'>want</span>
  <span m='1819910'>that.</span> <span m='1820180'>You</span> <span m='1820270'>might</span>
  <span m='1820450'>want</span> <span m='1820630'>to</span> <span m='1820690'>put</span>
  <span m='1820810'>an</span> <span m='1820900'>opportunity</span> <span m='1821410'>so</span>
  <span m='1821590'>it's</span> <span m='1821920'>publicly</span> <span m='1822340'>visible.</span>
  <span m='1824830'>But</span> <span m='1824980'>in</span> <span m='1827630'>most</span>
  <span m='1827990'>cases,</span> <span m='1828710'>I</span> <span m='1828860'>don't</span>
  <span m='1829100'>care</span> <span m='1829340'>about</span> <span m='1829550'>someone's</span>
  <span m='1829910'>random</span> <span m='1830210'>OP_RETURN.</span> <span m='1830900'>Usually,</span>
  <span m='1831320'>what</span> <span m='1831440'>you're</span> <span m='1831530'>putting</span>
  <span m='1831770'>into</span> <span m='1831950'>OP_RETURNs</span> <span m='1832580'>are,</span>
  <span m='1832670'>like,</span> <span m='1832850'>hashes.</span> <span m='1834410'>Because</span>
  <span m='1834620'>you</span> <span m='1834680'>don't</span> <span m='1834830'>have</span>
  <span m='1834920'>much</span> <span m='1835070'>space</span> <span m='1835340'>anyway.</span>
  <span m='1835640'>You</span> <span m='1835700'>have,</span> <span m='1835820'>like,</span>
  <span m='1836030'>40</span> <span m='1836360'>bytes</span> <span m='1836600'>or</span>
  <span m='1836690'>something.</span> <span m='1837410'>So</span> <span m='1838700'>usually</span>
  <span m='1839480'>your</span> <span m='1839770'>space</span> <span m='1840000'>constraint</span>
  <span m='1840290'>so</span> <span m='1840470'>you</span> <span m='1840530'>put</span>
  <span m='1840710'>the</span> <span m='1840800'>hash</span> <span m='1841130'>of</span>
  <span m='1841190'>some</span> <span m='1841460'>document.</span> <span m='1842420'>And</span>
  <span m='1842570'>then</span> <span m='1842930'>someone</span> <span m='1843230'>can</span>
  <span m='1843380'>prove,</span> <span m='1843670'>no,</span> <span m='1843870'>look,</span>
  <span m='1844100'>I</span> <span m='1844190'>put</span> <span m='1844430'>the</span>
  <span m='1844550'>document</span> <span m='1845030'>on</span> <span m='1845150'>the</span>
  <span m='1845210'>blockchain,</span> <span m='1845690'>by</span> <span m='1845870'>putting</span>
  <span m='1846140'>the</span> <span m='1846230'>hash</span> <span m='1846470'>of</span>
  <span m='1846590'>it.</span> <span m='1847280'>That's</span> <span m='1847490'>a</span>
  <span m='1847550'>commitment</span> <span m='1847940'>to</span> <span m='1848150'>that</span>
  <span m='1848330'>document</span> <span m='1848720'>itself.</span> </p><p><span
  m='1849170'>So</span> <span m='1849410'>I</span> <span m='1849500'>show</span> <span
  m='1849890'>that</span> <span m='1850160'>I</span> <span m='1850460'>had</span>
  <span m='1850730'>this</span> <span m='1850970'>data</span> <span m='1852140'>at</span>
  <span m='1852290'>some</span> <span m='1852650'>time</span> <span m='1853070'>before</span>
  <span m='1853610'>this</span> <span m='1853820'>block</span> <span m='1854180'>came</span>
  <span m='1854450'>out.</span> <span m='1855260'>That's</span> <span m='1855500'>essentially</span>
  <span m='1855920'>what</span> <span m='1856070'>you're</span> <span m='1856160'>proving.</span>
  <span m='1856490'>You're</span> <span m='1856610'>proving</span> <span m='1856940'>you</span>
  <span m='1857060'>knew</span> <span m='1857270'>it</span> <span m='1857690'>before</span>
  <span m='1858020'>a</span> <span m='1858050'>certain</span> <span m='1858350'>time,</span>
  <span m='1860810'>which</span> <span m='1860990'>is</span> <span m='1861170'>in</span>
  <span m='1861830'>many</span> <span m='1862040'>cases</span> <span m='1862370'>really</span>
  <span m='1862550'>useful.</span> <span m='1863000'>I</span> <span m='1863030'>mean,</span>
  <span m='1863150'>that's</span> <span m='1863300'>sort</span> <span m='1863570'>of</span>
  <span m='1863870'>the</span> <span m='1863990'>whole</span> <span m='1864110'>point</span>
  <span m='1864320'>of</span> <span m='1864380'>the</span> <span m='1864430'>blockchain,</span>
  <span m='1864800'>to</span> <span m='1864890'>prove</span> <span m='1865310'>that</span>
  <span m='1865430'>you</span> <span m='1865610'>knew</span> <span m='1865820'>about</span>
  <span m='1866060'>this</span> <span m='1866240'>transaction</span> <span m='1867170'>before</span>
  <span m='1868190'>a</span> <span m='1868280'>future</span> <span m='1868730'>transaction</span>
  <span m='1869300'>tries</span> <span m='1869480'>to</span> <span m='1869570'>double</span>
  <span m='1869780'>spend</span> <span m='1870020'>it.</span> <span m='1870960'>You</span>
  <span m='1871040'>want</span> <span m='1871160'>to</span> <span m='1871250'>file</span>
  <span m='1871580'>a</span> <span m='1871610'>patent,</span> <span m='1872030'>and</span>
  <span m='1872200'>I</span> <span m='1872450'>had</span> <span m='1872600'>this</span>
  <span m='1872750'>idea</span> <span m='1872990'>first--</span> <span m='1873410'>or</span>
  <span m='1874340'>prove</span> <span m='1874550'>these</span> <span m='1874670'>things.</span>
  </p><p><span m='1876260'>But</span> <span m='1876410'>how</span> <span m='1876530'>can</span>
  <span m='1876650'>we</span> <span m='1876770'>do</span> <span m='1876890'>this</span>
  <span m='1877100'>with</span> <span m='1877370'>0</span> <span m='1877760'>bytes</span>
  <span m='1878090'>overhead?</span> <span m='1881500'>OK,</span> <span m='1881830'>it's</span>
  <span m='1881950'>not</span> <span m='1882100'>obvious.</span> <span m='1883780'>You</span>
  <span m='1883870'>put</span> <span m='1884020'>it</span> <span m='1884110'>in</span>
  <span m='1884170'>the</span> <span m='1884230'>signature.</span> <span m='1885450'>And</span>
  <span m='1885550'>this</span> <span m='1885700'>was</span> <span m='1885790'>not</span>
  <span m='1885970'>obvious,</span> <span m='1886330'>and</span> <span m='1886570'>no</span>
  <span m='1886690'>one</span> <span m='1887170'>thought</span> <span m='1887380'>of</span>
  <span m='1887440'>this</span> <span m='1887800'>until</span> <span m='1889810'>a</span>
  <span m='1889870'>year</span> <span m='1890230'>or</span> <span m='1890290'>two</span>
  <span m='1890500'>ago.</span> <span m='1891070'>I</span> <span m='1891160'>think</span>
  <span m='1891280'>it</span> <span m='1891340'>was</span> <span m='1891470'>Andrew</span>
  <span m='1891640'>Poelstra,</span> <span m='1892150'>but</span> <span m='1892420'>I</span>
  <span m='1892720'>could</span> <span m='1892960'>be</span> <span m='1893110'>wrong.</span>
  <span m='1893590'>But</span> <span m='1893830'>I</span> <span m='1893950'>just</span>
  <span m='1894300'>associate</span> <span m='1894820'>it</span> <span m='1894940'>with</span>
  <span m='1895090'>him,</span> <span m='1895510'>because</span> <span m='1895810'>he</span>
  <span m='1895960'>worked</span> <span m='1896230'>on</span> <span m='1896380'>it.</span>
  <span m='1898170'>But</span> <span m='1898360'>I'm</span> <span m='1898420'>not</span>
  <span m='1898510'>100%</span> <span m='1899020'>sure.</span> <span m='1899350'>And</span>
  <span m='1899440'>he</span> <span m='1899620'>called</span> <span m='1899900'>it</span>
  <span m='1900190'>pay</span> <span m='1900460'>to</span> <span m='1900610'>contract</span>
  <span m='1901090'>hash,</span> <span m='1901790'>which</span> <span m='1901830'>is</span>
  <span m='1901930'>confusing.</span> <span m='1902860'>It's</span> <span m='1904540'>not</span>
  <span m='1904840'>at</span> <span m='1904930'>all</span> <span m='1905230'>the</span>
  <span m='1905350'>same</span> <span m='1905890'>as</span> <span m='1906100'>pay</span>
  <span m='1906290'>to</span> <span m='1906370'>script</span> <span m='1906640'>hash.</span>
  <span m='1907030'>It's</span> <span m='1907510'>not</span> <span m='1907730'>at</span>
  <span m='1907810'>all</span> <span m='1907930'>the</span> <span m='1908020'>same</span>
  <span m='1908230'>as</span> <span m='1908290'>pay</span> <span m='1908390'>to</span>
  <span m='1908510'>pubkey</span> <span m='1908750'>hash.</span> <span m='1909310'>But</span>
  <span m='1909610'>it's</span> <span m='1909700'>called</span> <span m='1909940'>pay</span>
  <span m='1910110'>to</span> <span m='1910180'>contract</span> <span m='1910570'>hash,</span>
  <span m='1910970'>which</span> <span m='1911050'>makes</span> <span m='1911260'>it</span>
  <span m='1911320'>really</span> <span m='1911500'>confusing.</span> <span m='1911890'>Bitcoin</span>
  <span m='1912280'>has</span> <span m='1912490'>really</span> <span m='1912940'>confusing</span>
  <span m='1913480'>names,</span> <span m='1914770'>like</span> <span m='1918620'>script</span>
  <span m='1919000'>pubkey.</span> </p><p><span m='1920440'>Script</span> <span m='1920770'>pubkey</span>
  <span m='1921190'>does</span> <span m='1921370'>not</span> <span m='1921580'>have</span>
  <span m='1921730'>to</span> <span m='1921820'>have</span> <span m='1921970'>a</span>
  <span m='1922030'>pubkey</span> <span m='1922330'>in</span> <span m='1922450'>it.</span>
  <span m='1922900'>In</span> <span m='1923020'>most</span> <span m='1923260'>cases,</span>
  <span m='1923740'>it</span> <span m='1923830'>doesn't.</span> <span m='1924340'>It</span>
  <span m='1924460'>has</span> <span m='1924640'>a</span> <span m='1924770'>pubkey</span>
  <span m='1925000'>hash,</span> <span m='1925510'>or</span> <span m='1925660'>a</span>
  <span m='1925720'>script</span> <span m='1925960'>hash.</span> <span m='1927760'>It</span>
  <span m='1927880'>doesn't</span> <span m='1928090'>have</span> <span m='1928180'>to</span>
  <span m='1928240'>have</span> <span m='1928360'>anything</span> <span m='1928720'>in</span>
  <span m='1928840'>it,</span> <span m='1929530'>but</span> <span m='1929710'>it's</span>
  <span m='1929830'>called</span> <span m='1930070'>script</span> <span m='1930430'>pubkey.</span>
  <span m='1931270'>And</span> <span m='1931450'>then</span> <span m='1932020'>script</span>
  <span m='1932410'>sig</span> <span m='1934120'>usually</span> <span m='1934510'>has</span>
  <span m='1934630'>signatures,</span> <span m='1935140'>but</span> <span m='1935590'>again,</span>
  <span m='1935830'>not</span> <span m='1936040'>always.</span> <span m='1938350'>And</span>
  <span m='1938450'>there's</span> <span m='1938630'>all</span> <span m='1938720'>sorts</span>
  <span m='1938930'>of</span> <span m='1938990'>confusing</span> <span m='1939360'>names.</span>
  </p><p><span m='1939590'>Anyway,</span> <span m='1939920'>here's</span> <span m='1940340'>our</span>
  <span m='1940430'>new</span> <span m='1940610'>contribution</span> <span m='1941240'>to</span>
  <span m='1941570'>confusing</span> <span m='1942050'>names--</span> <span m='1942750'>pay</span>
  <span m='1942950'>to</span> <span m='1943040'>contract</span> <span m='1943520'>hash,</span>
  <span m='1943860'>which</span> <span m='1943970'>is</span> <span m='1944120'>not</span>
  <span m='1944450'>really</span> <span m='1944780'>paying</span> <span m='1945110'>to</span>
  <span m='1945230'>anything.</span> <span m='1946280'>There</span> <span m='1946490'>doesn't</span>
  <span m='1946700'>have</span> <span m='1946820'>to</span> <span m='1946910'>be</span>
  <span m='1947030'>a</span> <span m='1947090'>contract.</span> <span m='1948350'>There</span>
  <span m='1948590'>is</span> <span m='1948770'>a</span> <span m='1948830'>hash</span>
  <span m='1949370'>involved.</span> <span m='1952390'>So</span> <span m='1952670'>it's</span>
  <span m='1952850'>a</span> <span m='1952910'>weird</span> <span m='1953090'>name,</span>
  <span m='1953360'>as</span> <span m='1953480'>you</span> <span m='1953570'>can't</span>
  <span m='1953750'>actually</span> <span m='1953990'>detect</span> <span m='1954320'>the</span>
  <span m='1954410'>contract,</span> <span m='1954860'>you're not</span> <span m='1954950'>paying</span>
  <span m='1955040'>to</span> <span m='1955250'>it.</span> <span m='1955480'>But</span>
  <span m='1956570'>to</span> <span m='1956710'>review,</span> <span m='1958190'>I'm</span>
  <span m='1958360'>going</span> <span m='1958440'>to</span> <span m='1958640'>use</span>
  <span m='1959060'>Schnoor</span> <span m='1959240'>signatures.</span> <span m='1959690'>This</span>
  <span m='1959870'>still</span> <span m='1960200'>works</span> <span m='1960500'>in</span>
  <span m='1960890'>ECDSA.</span> <span m='1961730'>But</span> <span m='1962450'>ECDSA</span>
  <span m='1962750'>is</span> <span m='1962850'>weird and</span> <span m='1963030'>annoying,</span>
  <span m='1963590'>and</span> <span m='1964550'>it</span> <span m='1964880'>also</span>
  <span m='1965450'>makes</span> <span m='1965750'>more</span> <span m='1965900'>sense</span>
  <span m='1966130'>in</span> <span m='1966270'>Schnoor</span> <span m='1966490'>signatures,</span>
  <span m='1966980'>so</span> <span m='1967400'>I'll</span> <span m='1967730'>explain</span>
  <span m='1968060'>that.</span> <span m='1969170'>But</span> <span m='1969650'>it</span>
  <span m='1969740'>totally</span> <span m='1970100'>works</span> <span m='1970910'>in</span>
  <span m='1971150'>ECDSA.</span> </p><p><span m='1972470'>The</span> <span m='1972590'>idea</span>
  <span m='1972770'>of</span> <span m='1972860'>the</span> <span m='1972950'>Schnoor</span>
  <span m='1973340'>signatures--</span> <span m='1973610'>OK,</span> <span m='1974330'>this</span>
  <span m='1974510'>is</span> <span m='1974570'>my</span> <span m='1974690'>private</span>
  <span m='1975020'>key.</span> <span m='1976770'>This</span> <span m='1976850'>is</span>
  <span m='1976940'>the</span> <span m='1977000'>message</span> <span m='1977360'>I</span>
  <span m='1977420'>want</span> <span m='1977540'>to</span> <span m='1977600'>sign.</span>
  <span m='1978770'>This</span> <span m='1979010'>is</span> <span m='1979220'>a</span>
  <span m='1979370'>random</span> <span m='1980090'>sort</span> <span m='1980270'>of</span>
  <span m='1980360'>temporary</span> <span m='1980900'>private</span> <span m='1981200'>key</span>
  <span m='1981350'>I</span> <span m='1981440'>come</span> <span m='1981650'>up</span>
  <span m='1981800'>with.</span> <span m='1982760'>And</span> <span m='1982910'>then</span>
  <span m='1983120'>this</span> <span m='1983600'>is</span> <span m='1983870'>that</span>
  <span m='1984920'>temporary</span> <span m='1985430'>private</span> <span m='1985760'>key</span>
  <span m='1986150'>turned</span> <span m='1986450'>into</span> <span m='1986660'>a</span>
  <span m='1986720'>public</span> <span m='1987040'>key.</span> <span m='1988430'>Multiply</span>
  <span m='1988880'>by</span> <span m='1989000'>G</span> <span m='1989180'>to</span>
  <span m='1989270'>get</span> <span m='1989510'>the</span> <span m='1989630'>public
  key</span> <span m='1990050'>version.</span> <span m='1991040'>And</span> <span
  m='1991220'>then</span> <span m='1991760'>to</span> <span m='1994940'>verify</span>
  <span m='1995510'>the</span> <span m='1995600'>signature,</span> <span m='1996830'>the</span>
  <span m='1997130'>verifier</span> <span m='1997610'>multiplies</span> <span m='1998060'>both</span>
  <span m='1998240'>sides</span> <span m='1998480'>by</span> <span m='1998600'>G.</span>
  <span m='1998990'>So</span> <span m='1999200'>you</span> <span m='1999290'>get</span>
  <span m='1999560'>s</span> <span m='1999710'>times</span> <span m='1999950'>G.</span>
  <span m='2000340'>k</span> <span m='2000640'>turns</span> <span m='2000880'>in</span>
  <span m='2001030'>R.</span> <span m='2001720'>Little</span> <span m='2001940'>a</span>
  <span m='2002260'>turns</span> <span m='2002330'>into</span> <span m='2002410'>big</span>
  <span m='2002590'>A.</span> <span m='2003190'>This</span> <span m='2003940'>is</span>
  <span m='2004210'>just</span> <span m='2004480'>the</span> <span m='2005870'>32-byte</span>
  <span m='2006370'>hash,</span> <span m='2006580'>so</span> <span m='2007000'>it</span>
  <span m='2007120'>stays</span> <span m='2007360'>the</span> <span m='2007420'>same.</span>
  <span m='2009080'>So</span> <span m='2009180'>the</span> <span m='2012610'>R</span>
  <span m='2012760'>and</span> <span m='2013330'>s</span> <span m='2013530'>are</span>
  <span m='2013720'>the</span> <span m='2013810'>signature,</span> <span m='2014320'>and</span>
  <span m='2014500'>the</span> <span m='2014600'>pub key</span> <span m='2014870'>is
  A,</span> <span m='2015250'>and</span> <span m='2015370'>the</span> <span m='2015430'>message</span>
  <span m='2015650'>is</span> <span m='2015790'>m.</span> <span m='2017390'>So</span>
  <span m='2017740'>that's</span> <span m='2017980'>the</span> <span m='2018130'>signing,</span>
  <span m='2019330'>or</span> <span m='2019420'>close</span> <span m='2019690'>enough</span>
  <span m='2019930'>to</span> <span m='2020050'>the</span> <span m='2020140'>signing</span>
  <span m='2020440'>that's</span> <span m='2020620'>used in</span> <span m='2020860'>Bitcoin.</span>
  </p><p><span m='2022680'>So</span> <span m='2023550'>pay</span> <span m='2023790'>to</span>
  <span m='2023910'>contract</span> <span m='2024420'>hash</span> <span m='2024870'>says,</span>
  <span m='2025240'>OK,</span> <span m='2025510'>I</span> <span m='2025530'>want</span>
  <span m='2025680'>to</span> <span m='2025740'>put</span> <span m='2026220'>arbitrary</span>
  <span m='2026790'>data</span> <span m='2027270'>into</span> <span m='2027540'>my</span>
  <span m='2027690'>signature,</span> <span m='2028320'>in</span> <span m='2028440'>a</span>
  <span m='2028470'>way</span> <span m='2028590'>that</span> <span m='2028710'>I</span>
  <span m='2028770'>can</span> <span m='2028920'>prove</span> <span m='2029280'>it</span>
  <span m='2029340'>was</span> <span m='2029520'>there.</span> <span m='2031230'>So</span>
  <span m='2032120'>here's</span> <span m='2032390'>the</span> <span m='2032450'>normal</span>
  <span m='2032750'>equation.</span> <span m='2033920'>Now,</span> <span m='2034220'>what</span>
  <span m='2034490'>if</span> <span m='2034730'>I</span> <span m='2034970'>redefine</span>
  <span m='2035810'>k.</span> <span m='2036350'>Normally,</span> <span m='2036740'>k</span>
  <span m='2037010'>is</span> <span m='2037130'>just</span> <span m='2037310'>a</span>
  <span m='2037370'>random</span> <span m='2037850'>number.</span> <span m='2039050'>But</span>
  <span m='2039170'>now</span> <span m='2039290'>I'm</span> <span m='2039350'>going</span>
  <span m='2039470'>to</span> <span m='2039530'>redefine</span> <span m='2040250'>k.</span>
  <span m='2041090'>k</span> <span m='2041570'>is</span> <span m='2041750'>now</span>
  <span m='2042140'>j.</span> <span m='2042590'>So</span> <span m='2042770'>j</span>
  <span m='2043080'>is</span> <span m='2043220'>my</span> <span m='2043430'>new</span>
  <span m='2043730'>real</span> <span m='2044120'>random</span> <span m='2044480'>number.</span>
  <span m='2045620'>And</span> <span m='2045890'>then</span> <span m='2046220'>I'm</span>
  <span m='2046430'>going</span> <span m='2046670'>to</span> <span m='2046940'>add</span>
  <span m='2047610'>the</span> <span m='2047880'>hash...</span> <span m='2050480'>There's</span>
  <span m='2050630'>no</span> <span m='2050750'>G</span> <span m='2050929'>there,</span>
  <span m='2051110'>shoot.</span> <span m='2051800'>Anyway,</span> <span m='2052679'>G</span>
  <span m='2053230'>should</span> <span m='2053389'>not</span> <span m='2053600'>be</span>
  <span m='2053719'>there,</span> <span m='2053870'>but</span> <span m='2053960'>it</span>
  <span m='2054050'>should</span> <span m='2054199'>be</span> <span m='2054320'>there.</span>
  <span m='2054540'>Sorry.</span> </p><p><span m='2059310'>So</span> <span m='2059449'>I</span>
  <span m='2059540'>redefine</span> <span m='2059960'>k</span> <span m='2061280'>as</span>
  <span m='2062239'>j,</span> <span m='2062840'>which</span> <span m='2063020'>is</span>
  <span m='2063139'>an</span> <span m='2063230'>actual</span> <span m='2063530'>random</span>
  <span m='2063800'>number,</span> <span m='2064250'>plus</span> <span m='2065150'>the</span>
  <span m='2065300'>hash</span> <span m='2065750'>of</span> <span m='2065840'>the</span>
  <span m='2065929'>data</span> <span m='2066170'>I</span> <span m='2066260'>want</span>
  <span m='2066409'>to</span> <span m='2066469'>commit</span> <span m='2066710'>to--</span>
  <span m='2067469'>and</span> <span m='2067650'>j</span> <span m='2067989'>times</span>
  <span m='2068469'>G.</span> <span m='2070010'>You</span> <span m='2070100'>get</span>
  <span m='2070280'>the</span> <span m='2070370'>idea.</span> <span m='2070739'>That</span>
  <span m='2070840'>should have</span> <span m='2070949'>been</span> <span m='2071080'>there.</span>
  </p><p><span m='2077409'>And--</span> <span m='2077530'>then</span> <span m='2077770'>the</span>
  <span m='2077889'>signature--</span> <span m='2079210'>it's</span> <span m='2079360'>still</span>
  <span m='2079630'>the</span> <span m='2079750'>same</span> <span m='2079960'>equation.</span>
  <span m='2080590'>I'm</span> <span m='2080679'>just</span> <span m='2080800'>saying,</span>
  <span m='2081010'>OK,</span> <span m='2081340'>it's</span> <span m='2082120'>this</span>
  <span m='2082449'>new</span> <span m='2082870'>k</span> <span m='2084370'>minus</span>
  <span m='2085434'>this</span> <span m='2085899'>thing.</span> <span m='2087760'>And</span>
  <span m='2087880'>so</span> <span m='2088719'>nobody</span> <span m='2089170'>necessarily</span>
  <span m='2089830'>knows</span> <span m='2090190'>that</span> <span m='2090340'>I'm</span>
  <span m='2090460'>doing</span> <span m='2090760'>this.</span> <span m='2091480'>If</span>
  <span m='2091630'>I</span> <span m='2091780'>just</span> <span m='2091960'>tell</span>
  <span m='2092230'>you</span> <span m='2094820'>tell</span> <span m='2095030'>you</span>
  <span m='2095320'>R</span> <span m='2095659'>and</span> <span m='2095989'>s,</span>
  <span m='2096889'>the</span> <span m='2097040'>equation</span> <span m='2097460'>still</span>
  <span m='2097670'>holds.</span> <span m='2098570'>It's</span> <span m='2098750'>just</span>
  <span m='2098930'>that</span> <span m='2099080'>k</span> <span m='2099500'>is</span>
  <span m='2099650'>a</span> <span m='2099710'>little</span> <span m='2100040'>special.</span>
  <span m='2101720'>For</span> <span m='2102290'>anyone</span> <span m='2102590'>else,</span>
  <span m='2103100'>it</span> <span m='2103220'>looks</span> <span m='2103430'>like</span>
  <span m='2103610'>a</span> <span m='2103640'>random</span> <span m='2103940'>number.</span>
  <span m='2104660'>It's</span> <span m='2104840'>a</span> <span m='2104900'>random</span>
  <span m='2105260'>number</span> <span m='2105950'>plus</span> <span m='2106460'>this</span>
  <span m='2106760'>other</span> <span m='2107000'>hash--</span> <span m='2107870'>not</span>
  <span m='2108080'>times</span> <span m='2108340'>G.</span> </p><p><span m='2110600'>So</span>
  <span m='2110780'>it's</span> <span m='2110870'>a</span> <span m='2110900'>random</span>
  <span m='2111140'>number</span> <span m='2111380'>plus</span> <span m='2111890'>a</span>
  <span m='2111950'>hash.</span> <span m='2112530'>Which</span> <span m='2112970'>hashes</span>
  <span m='2113330'>look</span> <span m='2113480'>pretty</span> <span m='2113720'>random--</span>
  <span m='2114470'>so</span> <span m='2114650'>it's</span> <span m='2114770'>a</span>
  <span m='2114830'>random</span> <span m='2115070'>number</span> <span m='2115310'>plus</span>
  <span m='2115520'>some</span> <span m='2115670'>other</span> <span m='2115850'>random</span>
  <span m='2116090'>number.</span> <span m='2116780'>No</span> <span m='2116930'>one's</span>
  <span m='2117090'>going</span> <span m='2117180'>to</span> <span m='2117440'>tell</span>
  <span m='2117710'>that</span> <span m='2117830'>anything's</span> <span m='2118220'>weird</span>
  <span m='2118370'>about</span> <span m='2118580'>this.</span> <span m='2119630'>However,</span>
  <span m='2121340'>it</span> <span m='2121460'>is</span> <span m='2121910'>unique,</span>
  <span m='2122420'>in</span> <span m='2122540'>that</span> <span m='2122690'>I've</span>
  <span m='2122960'>got</span> <span m='2124010'>this</span> <span m='2124190'>random</span>
  <span m='2124460'>number</span> <span m='2124730'>plus</span> <span m='2125180'>the</span>
  <span m='2125360'>hash</span> <span m='2125990'>of</span> <span m='2126230'>that</span>
  <span m='2126470'>random</span> <span m='2126800'>number</span> <span m='2127130'>times</span>
  <span m='2127610'>G</span> <span m='2127910'>in</span> <span m='2128030'>it,</span>
  <span m='2128860'>and</span> <span m='2128990'>this</span> <span m='2129200'>extra</span>
  <span m='2129440'>data</span> <span m='2129740'>I've</span> <span m='2129830'>put</span>
  <span m='2130010'>in.</span> </p><p><span m='2131420'>So</span> <span m='2131600'>to</span>
  <span m='2131690'>verify</span> <span m='2131995'>it,</span> <span m='2132740'>if</span>
  <span m='2132860'>I</span> <span m='2132920'>don't</span> <span m='2133040'>tell</span>
  <span m='2133220'>you</span> <span m='2133280'>about</span> <span m='2133460'>this,</span>
  <span m='2134090'>verification</span> <span m='2134690'>looks</span> <span m='2134870'>the</span>
  <span m='2134930'>same.</span> <span m='2135950'>What</span> <span m='2136070'>if</span>
  <span m='2136160'>I</span> <span m='2136250'>do</span> <span m='2136520'>tell</span>
  <span m='2136730'>you</span> <span m='2136820'>about</span> <span m='2137000'>it,</span>
  <span m='2137090'>though?</span> <span m='2138630'>So</span> <span m='2138940'>normally</span>
  <span m='2139300'>the</span> <span m='2139370'>sig--</span> <span m='2139690'>R,</span>
  <span m='2139780'>s--</span> <span m='2140230'>pubkey</span> <span m='2140380'>is</span>
  <span m='2140470'>A,</span> <span m='2140770'>message</span> <span m='2141070'>is</span>
  <span m='2141170'>m.</span> <span m='2142380'>But</span> <span m='2142530'>the</span>
  <span m='2142620'>signer</span> <span m='2143040'>can</span> <span m='2143550'>prove</span>
  <span m='2144810'>that</span> <span m='2145170'>R</span> <span m='2146160'>is</span>
  <span m='2146310'>not</span> <span m='2146640'>kG--</span> <span m='2147120'>that</span>
  <span m='2147330'>there's</span> <span m='2147540'>this</span> <span m='2147810'>other</span>
  <span m='2149130'>k.</span> <span m='2150330'>Well,</span> <span m='2150690'>it's</span>
  <span m='2150840'>k,</span> <span m='2151020'>but</span> <span m='2151450'>there's</span>
  <span m='2151770'>something</span> <span m='2152070'>else</span> <span m='2152280'>in</span>
  <span m='2152360'>R.</span> <span m='2152640'>I</span> <span m='2152730'>can</span>
  <span m='2152850'>prove</span> <span m='2153050'>that</span> <span m='2153150'>R
  is</span> <span m='2153320'>special</span> <span m='2153750'>after</span> <span
  m='2153960'>the</span> <span m='2154050'>fact,</span> <span m='2154290'>right?</span>
  <span m='2154680'>Everyone</span> <span m='2154950'>knows</span> <span m='2155130'>what</span>
  <span m='2155230'>R</span> <span m='2155400'>is.</span> <span m='2156510'>But</span>
  <span m='2156600'>I</span> <span m='2156690'>can</span> <span m='2156820'>then</span>
  <span m='2156990'>prove</span> <span m='2157290'>that</span> <span m='2157410'>something</span>
  <span m='2157710'>was</span> <span m='2157860'>in</span> <span m='2158100'>R.</span>
  <span m='2158760'>Also,</span> <span m='2159090'>never</span> <span m='2159390'>reveal</span>
  <span m='2159630'>k,</span> <span m='2160470'>even</span> <span m='2160680'>after</span>
  <span m='2160890'>the</span> <span m='2160950'>fact.</span> <span m='2161190'>That</span>
  <span m='2161290'>will</span> <span m='2161340'>let</span> <span m='2161490'>you</span>
  <span m='2162270'>figure</span> <span m='2162600'>out</span> <span m='2162720'>the</span>
  <span m='2162840'>person's</span> <span m='2163170'>private</span> <span m='2163320'>key.</span>
  </p><p><span m='2164250'>So</span> <span m='2164310'>the</span> <span m='2164430'>idea</span>
  <span m='2164670'>is</span> <span m='2166270'>I</span> <span m='2166360'>can</span>
  <span m='2166510'>prove</span> <span m='2166780'>that</span> <span m='2167020'>R</span>
  <span m='2167530'>equals</span> <span m='2168670'>J</span> <span m='2169570'>plus</span>
  <span m='2170050'>the</span> <span m='2170200'>hash</span> <span m='2170440'>of</span>
  <span m='2170530'>the</span> <span m='2170620'>data</span> <span m='2171910'>in</span>
  <span m='2172260'>J</span> <span m='2173450'>times</span> <span m='2173760'>G.</span>
  <span m='2175630'>Here's</span> <span m='2175810'>where</span> <span m='2175930'>it's</span>
  <span m='2176020'>a</span> <span m='2176080'>little</span> <span m='2176260'>confusing,</span>
  <span m='2176650'>right?</span> <span m='2176800'>Because</span> <span m='2177010'>this</span>
  <span m='2177190'>is</span> <span m='2177950'>already</span> <span m='2178280'>a</span>
  <span m='2178320'>pubkey,</span> <span m='2179050'>and</span> <span m='2179140'>you're</span>
  <span m='2179230'>multiplying</span> <span m='2179680'>by</span> <span m='2179800'>G</span>
  <span m='2179980'>again,</span> <span m='2180430'>right?</span> <span m='2180640'>So</span>
  <span m='2180790'>it's</span> <span m='2181090'>a</span> <span m='2181420'>little</span>
  <span m='2181910'>weird?</span> <span m='2184330'>Anyone</span> <span m='2184630'>can</span>
  <span m='2184780'>compute</span> <span m='2185110'>this,</span> <span m='2185320'>right?</span>
  <span m='2185500'>Because</span> <span m='2185680'>I</span> <span m='2185740'>can</span>
  <span m='2185860'>say,</span> <span m='2186110'>hey,</span> <span m='2186790'>you</span>
  <span m='2186970'>already</span> <span m='2187180'>know</span> <span m='2187330'>R.</span>
  <span m='2188080'>I</span> <span m='2188200'>can</span> <span m='2188380'>give</span>
  <span m='2188650'>you</span> <span m='2188800'>a</span> <span m='2188860'>J</span>
  <span m='2190030'>and</span> <span m='2190270'>some</span> <span m='2190540'>data,</span>
  <span m='2191390'>such</span> <span m='2191650'>that</span> <span m='2192370'>j</span>
  <span m='2192790'>plus</span> <span m='2193180'>the</span> <span m='2193270'>hash</span>
  <span m='2193510'>of</span> <span m='2193600'>this</span> <span m='2193780'>data,</span>
  <span m='2194050'>and</span> <span m='2194140'>j</span> <span m='2194320'>itself</span>
  <span m='2194740'>times</span> <span m='2195130'>G,</span> <span m='2195970'>equals</span>
  <span m='2196240'>R.</span> <span m='2197380'>And</span> <span m='2197530'>I</span>
  <span m='2197650'>can't</span> <span m='2198850'>forge</span> <span m='2199210'>this.</span>
  <span m='2200080'>If</span> <span m='2200200'>I</span> <span m='2200260'>try</span>
  <span m='2200490'>to</span> <span m='2200590'>forge</span> <span m='2200890'>this,</span>
  <span m='2201070'>and</span> <span m='2201160'>I say</span> <span m='2201340'>after</span>
  <span m='2201640'>the</span> <span m='2201700'>fact--</span> <span m='2203440'>I</span>
  <span m='2203560'>just</span> <span m='2203740'>made</span> <span m='2203980'>R</span>
  <span m='2204100'>randomly.</span> <span m='2205030'>I</span> <span m='2205090'>didn't</span>
  <span m='2205330'>have</span> <span m='2205510'>any</span> <span m='2205690'>actual</span>
  <span m='2206020'>data.</span> <span m='2207130'>And</span> <span m='2207220'>then</span>
  <span m='2207340'>after</span> <span m='2207640'>the</span> <span m='2207730'>fact,</span>
  <span m='2208120'>I</span> <span m='2208360'>want</span> <span m='2208630'>to</span>
  <span m='2208810'>come</span> <span m='2209170'>up</span> <span m='2209350'>and</span>
  <span m='2209830'>lie,</span> <span m='2210100'>and</span> <span m='2210190'>say,</span>
  <span m='2210700'>I</span> <span m='2210760'>put</span> <span m='2210940'>this</span>
  <span m='2211090'>data</span> <span m='2211300'>in</span> <span m='2211720'>to</span>
  <span m='2212190'>this R.</span> </p><p><span m='2212890'>OK,</span> <span m='2213100'>now</span>
  <span m='2213220'>we</span> <span m='2213280'>need</span> <span m='2213400'>to</span>
  <span m='2213460'>solve</span> <span m='2213670'>for</span> <span m='2213790'>J.</span>
  <span m='2214330'>Because</span> <span m='2214480'>my</span> <span m='2214600'>proof</span>
  <span m='2215050'>is</span> <span m='2215290'>going</span> <span m='2215380'>to</span>
  <span m='2215470'>be</span> <span m='2215560'>J</span> <span m='2215830'>in</span>
  <span m='2215920'>this</span> <span m='2216070'>data.</span> <span m='2216440'>So</span>
  <span m='2217090'>I've</span> <span m='2217180'>got</span> <span m='2217330'>the</span>
  <span m='2217390'>data</span> <span m='2217660'>I</span> <span m='2217720'>want,</span>
  <span m='2218850'>and</span> <span m='2218980'>I</span> <span m='2219040'>want</span>
  <span m='2219220'>to</span> <span m='2219280'>figure</span> <span m='2219580'>out</span>
  <span m='2219670'>what</span> <span m='2219760'>J</span> <span m='2220090'>is.</span>
  <span m='2220370'>So</span> <span m='2220540'>J</span> <span m='2221050'>is</span>
  <span m='2221230'>the</span> <span m='2221320'>hash</span> <span m='2222250'>of</span>
  <span m='2222340'>this</span> <span m='2222520'>data.</span> <span m='2222820'>And</span>
  <span m='2223270'>J</span> <span m='2223830'>times</span> <span m='2224140'>G</span>
  <span m='2224590'>minus</span> <span m='2225100'>R--</span> <span m='2225340'>oh,</span>
  <span m='2225610'>shoot.</span> <span m='2227530'>That</span> <span m='2227650'>would</span>
  <span m='2227770'>be</span> <span m='2227860'>the</span> <span m='2227950'>equation</span>
  <span m='2228290'>I</span> <span m='2228340'>have</span> <span m='2228430'>to</span>
  <span m='2228520'>solve,</span> <span m='2228940'>if</span> <span m='2229060'>I</span>
  <span m='2229150'>want</span> <span m='2229300'>to</span> <span m='2229510'>falsely</span>
  <span m='2230080'>prove</span> <span m='2230500'>that</span> <span m='2230620'>this</span>
  <span m='2230800'>data</span> <span m='2231010'>went</span> <span m='2231160'>into</span>
  <span m='2231400'>it.</span> <span m='2232030'>The</span> <span m='2232120'>problem</span>
  <span m='2232450'>is</span> <span m='2232510'>I've</span> <span m='2232660'>got</span>
  <span m='2232840'>this</span> <span m='2232960'>thing</span> <span m='2233140'>where</span>
  <span m='2233230'>it's</span> <span m='2233320'>like,</span> <span m='2233470'>J</span>
  <span m='2233980'>is</span> <span m='2234160'>defined</span> <span m='2234610'>in</span>
  <span m='2234700'>terms</span> <span m='2234970'>of</span> <span m='2235030'>the</span>
  <span m='2235120'>hash</span> <span m='2235390'>of</span> <span m='2235480'>J.</span>
  </p><p><span m='2238050'>That's</span> <span m='2238530'>going</span> <span m='2238650'>to</span>
  <span m='2238710'>be</span> <span m='2238770'>hard,</span> <span m='2239160'>right?</span>
  <span m='2240840'>If</span> <span m='2240990'>I'm</span> <span m='2241110'>defining</span>
  <span m='2241530'>J</span> <span m='2241800'>in</span> <span m='2241890'>terms</span>
  <span m='2242100'>of</span> <span m='2242160'>the</span> <span m='2242250'>hash</span>
  <span m='2242460'>of</span> <span m='2242520'>J,</span> <span m='2242775'>then</span>
  <span m='2243030'>I'm</span> <span m='2243150'>stuck,</span> <span m='2243960'>because</span>
  <span m='2245220'>hash</span> <span m='2245370'>functions</span> <span m='2245700'>don't</span>
  <span m='2245850'>let</span> <span m='2245970'>me</span> <span m='2246090'>do</span>
  <span m='2246180'>that.</span> <span m='2247560'>So</span> <span m='2247740'>this</span>
  <span m='2247980'>is</span> <span m='2248250'>actually</span> <span m='2248640'>kind</span>
  <span m='2248850'>of</span> <span m='2248940'>cool,</span> <span m='2249150'>because</span>
  <span m='2249480'>it's</span> <span m='2249690'>a</span> <span m='2249840'>proof</span>
  <span m='2251130'>that</span> <span m='2251430'>there</span> <span m='2251670'>was</span>
  <span m='2251850'>some</span> <span m='2252090'>extra</span> <span m='2252360'>data</span>
  <span m='2252660'>that</span> <span m='2252810'>went</span> <span m='2253230'>in</span>
  <span m='2253620'>to</span> <span m='2254010'>the</span> <span m='2254550'>random</span>
  <span m='2255010'>R</span> <span m='2255180'>point,</span> <span m='2255900'>before</span>
  <span m='2256620'>the</span> <span m='2256740'>signing</span> <span m='2257100'>happened.</span>
  <span m='2260850'>Yeah,</span> <span m='2261120'>it</span> <span m='2261240'>had</span>
  <span m='2261390'>to</span> <span m='2261480'>be</span> <span m='2261600'>before</span>
  <span m='2261870'>the</span> <span m='2261960'>signing</span> <span m='2262230'>happened,</span>
  <span m='2262470'>because</span> <span m='2262680'>the</span> <span m='2262770'>signature</span>
  <span m='2263340'>has</span> <span m='2263790'>R</span> <span m='2264030'>in</span>
  <span m='2264180'>it,</span> <span m='2264320'>and</span> <span m='2264570'>S</span>
  <span m='2264930'>is</span> <span m='2265080'>a</span> <span m='2265140'>function</span>
  <span m='2265530'>of</span> <span m='2265650'>R.</span> </p><p><span m='2268660'>And</span>
  <span m='2268780'>this</span> <span m='2268930'>is</span> <span m='2269020'>cool.</span>
  <span m='2269230'>Because</span> <span m='2269620'>if</span> <span m='2269800'>you</span>
  <span m='2269890'>don't</span> <span m='2270100'>know</span> <span m='2270490'>about</span>
  <span m='2270760'>it,</span> <span m='2270970'>it</span> <span m='2271060'>just</span>
  <span m='2271240'>looks</span> <span m='2271450'>like</span> <span m='2271570'>a</span>
  <span m='2271630'>regular</span> <span m='2272320'>signature</span> <span m='2272770'>with</span>
  <span m='2272920'>a</span> <span m='2273160'>regular</span> <span m='2273490'>R</span>
  <span m='2273640'>value.</span> <span m='2274580'>But</span> <span m='2274660'>if</span>
  <span m='2274780'>I</span> <span m='2274870'>tell</span> <span m='2275110'>you</span>
  <span m='2275230'>about</span> <span m='2275470'>it--</span> <span m='2275830'>like,</span>
  <span m='2275880'>yeah,</span> <span m='2276250'>when</span> <span m='2276460'>I</span>
  <span m='2276580'>signed</span> <span m='2276870'>that,</span> <span m='2277120'>I</span>
  <span m='2277210'>actually</span> <span m='2277510'>put</span> <span m='2277690'>some</span>
  <span m='2277840'>extra</span> <span m='2278050'>data</span> <span m='2278320'>in</span>
  <span m='2278450'>here.</span> <span m='2279940'>So</span> <span m='2280240'>that's</span>
  <span m='2280750'>kind</span> <span m='2281020'>of</span> <span m='2281380'>better</span>
  <span m='2281650'>than</span> <span m='2281770'>OP_RETURN.</span> <span m='2282640'>There's</span>
  <span m='2282820'>0</span> <span m='2283180'>bytes</span> <span m='2283420'>overhead.</span>
  <span m='2283990'>You were</span> <span m='2284130'>going</span> <span m='2284200'>to</span>
  <span m='2284290'>sign</span> <span m='2284530'>anyway.</span> <span m='2287410'>So</span>
  <span m='2287530'>you</span> <span m='2287620'>can</span> <span m='2287710'>put</span>
  <span m='2287830'>data</span> <span m='2288130'>inside</span> <span m='2288400'>a</span>
  <span m='2288460'>signature's</span> <span m='2288820'>R</span> <span m='2288940'>point.</span>
  <span m='2289840'>You</span> <span m='2289960'>can</span> <span m='2290170'>even</span>
  <span m='2290470'>do</span> <span m='2290620'>it</span> <span m='2290920'>with</span>
  <span m='2291280'>other</span> <span m='2291460'>people's</span> <span m='2291690'>signatures.</span>
  <span m='2293260'>There's</span> <span m='2293470'>no</span> <span m='2293620'>real</span>
  <span m='2293830'>private</span> <span m='2294430'>information</span> <span m='2294970'>here.</span>
  <span m='2295090'>If</span> <span m='2295210'>I</span> <span m='2295330'>just</span>
  <span m='2295510'>hand</span> <span m='2295930'>you</span> <span m='2296080'>some</span>
  <span m='2296260'>data,</span> <span m='2297010'>it's</span> <span m='2297220'>totally</span>
  <span m='2297610'>safe.</span> <span m='2299500'>Hey,</span> <span m='2299840'>here's</span>
  <span m='2299920'>some</span> <span m='2300070'>data.</span> <span m='2300620'>OK,</span>
  <span m='2301600'>here's</span> <span m='2301930'>the</span> <span m='2302020'>J</span>
  <span m='2302200'>point,</span> <span m='2303660'>that</span> <span m='2304270'>constructs</span>
  <span m='2304660'>this,</span> <span m='2304960'>and</span> <span m='2305080'>the</span>
  <span m='2305200'>R.</span> <span m='2305470'>It's like,</span> <span m='2305650'>OK,</span>
  <span m='2306010'>sounds</span> <span m='2306280'>good.</span> </p><p><span m='2307120'>I</span>
  <span m='2307210'>can</span> <span m='2307330'>put</span> <span m='2307480'>someone</span>
  <span m='2307750'>else's</span> <span m='2308050'>data</span> <span m='2308440'>into</span>
  <span m='2308620'>this.</span> <span m='2309960'>You</span> <span m='2310180'>just</span>
  <span m='2310330'>hand</span> <span m='2310440'>them</span> <span m='2310540'>the</span>
  <span m='2310630'>data.</span> <span m='2311350'>They</span> <span m='2311470'>give</span>
  <span m='2311590'>you</span> <span m='2311680'>the</span> <span m='2311740'>proof,</span>
  <span m='2312160'>which</span> <span m='2312370'>in</span> <span m='2312460'>that</span>
  <span m='2312550'>case</span> <span m='2312790'>is</span> <span m='2312910'>just</span>
  <span m='2313120'>J.</span> <span m='2314710'>So</span> <span m='2315490'>it's</span>
  <span m='2315640'>OP_RETURN</span> <span m='2316150'>with</span> <span m='2316390'>0</span>
  <span m='2316690'>byte</span> <span m='2316930'>overhead.</span> <span m='2317810'>This</span>
  <span m='2317890'>is</span> <span m='2317980'>really</span> <span m='2318190'>cool.</span>
  <span m='2318670'>I</span> <span m='2318820'>believe</span> <span m='2319510'>this</span>
  <span m='2319780'>is</span> <span m='2320020'>being</span> <span m='2320380'>used</span>
  <span m='2321520'>for</span> <span m='2321880'>open</span> <span m='2322090'>timestamps</span>
  <span m='2322550'>now,</span> <span m='2323800'>as</span> <span m='2323950'>of</span>
  <span m='2324100'>a</span> <span m='2324160'>few--</span> <span m='2324520'>I</span>
  <span m='2324580'>think,</span> <span m='2325060'>right?</span> </p><p><span m='2325690'>AUDIENCE:</span>
  <span m='2325905'>I</span> <span m='2326120'>wasn't aware</span> <span m='2326550'>of
  that.</span> </p><p><span m='2326980'>TADGE DRYJA:</span> <span m='2327010'>I</span>
  <span m='2327040'>think</span> <span m='2327700'>they</span> <span m='2327820'>got</span>
  <span m='2327970'>it</span> <span m='2328060'>in.</span> <span m='2328360'>I</span>
  <span m='2328390'>don't</span> <span m='2328510'>know.</span> <span m='2329260'>But</span>
  <span m='2329470'>it's</span> <span m='2329590'>also</span> <span m='2329770'>nice--</span>
  <span m='2330010'>it's</span> <span m='2330160'>not</span> <span m='2330310'>like</span>
  <span m='2330430'>a</span> <span m='2330460'>soft fork</span> <span m='2330910'>or</span>
  <span m='2330970'>anything.</span> <span m='2331300'>This</span> <span m='2331480'>is</span>
  <span m='2331570'>just</span> <span m='2331750'>a</span> <span m='2331960'>fun</span>
  <span m='2332260'>trick</span> <span m='2332560'>you</span> <span m='2332680'>can</span>
  <span m='2332830'>do</span> <span m='2333130'>with</span> <span m='2333370'>your</span>
  <span m='2333490'>signatures.</span> <span m='2334540'>So</span> <span m='2334720'>you</span>
  <span m='2334870'>could</span> <span m='2335020'>do</span> <span m='2335140'>this</span>
  <span m='2335320'>today</span> <span m='2336820'>if</span> <span m='2336940'>you</span>
  <span m='2337030'>wanted,</span> <span m='2337480'>and</span> <span m='2337630'>then</span>
  <span m='2337780'>prove</span> <span m='2338050'>to</span> <span m='2338170'>people</span>
  <span m='2338410'>later,</span> <span m='2338770'>that,</span> <span m='2339090'>hey,</span>
  <span m='2339340'>I</span> <span m='2339430'>put</span> <span m='2339730'>my</span>
  <span m='2339880'>name</span> <span m='2340330'>into</span> <span m='2340600'>my</span>
  <span m='2340750'>signature.</span> </p><p><span m='2342765'>AUDIENCE:</span> <span
  m='2342992'>[INAUDIBLE]</span> <span m='2343675'>the</span> <span m='2344130'>hash,</span>
  <span m='2345300'>wouldn't</span> <span m='2345690'>proving</span> <span m='2346190'>one</span>
  <span m='2346520'>essentially</span> <span m='2346940'>refer to</span> <span m='2347360'>all</span>
  <span m='2347710'>in</span> <span m='2348070'>the</span> <span m='2348320'>batch</span>
  <span m='2348570'>stuff?</span> </p><p><span m='2351860'>TADGE DRYJA:</span> <span
  m='2351910'>This</span> <span m='2351960'>is</span> <span m='2352120'>direct</span>
  <span m='2352420'>replacement</span> <span m='2352810'>for</span> <span m='2352960'>the</span>
  <span m='2353080'>OP_RETURN.</span> <span m='2353590'>You</span> <span m='2354280'>commit</span>
  <span m='2354610'>to</span> <span m='2354730'>the</span> <span m='2354890'>root.</span>
  <span m='2356780'>And</span> <span m='2357200'>in</span> <span m='2357540'>their</span>
  <span m='2357730'>case,</span> <span m='2358730'>this</span> <span m='2359120'>data</span>
  <span m='2359810'>is</span> <span m='2359960'>a</span> <span m='2360020'>Merkle</span>
  <span m='2360250'>root.</span> <span m='2361770'>And</span> <span m='2361890'>then</span>
  <span m='2362700'>you</span> <span m='2362820'>can</span> <span m='2363000'>improve.</span>
  <span m='2363480'>So</span> <span m='2363660'>you</span> <span m='2363810'>can</span>
  <span m='2365340'>put</span> <span m='2365490'>a</span> <span m='2365550'>Merkle</span>
  <span m='2365790'>root</span> <span m='2365970'>here.</span> </p><p><span m='2366630'>And</span>
  <span m='2366810'>then</span> <span m='2367320'>I</span> <span m='2367440'>prove</span>
  <span m='2367680'>that</span> <span m='2367770'>there's</span> <span m='2367950'>a</span>
  <span m='2367980'>Merkle</span> <span m='2368280'>root</span> <span m='2368460'>inside</span>
  <span m='2368820'>my</span> <span m='2368940'>signature.</span> <span m='2369400'>And</span>
  <span m='2369570'>then</span> <span m='2369900'>I</span> <span m='2369990'>also</span>
  <span m='2370350'>prove</span> <span m='2370650'>a</span> <span m='2370710'>branch,</span>
  <span m='2372390'>so</span> <span m='2372570'>that</span> <span m='2372690'>the</span>
  <span m='2372780'>data</span> <span m='2373110'>is</span> <span m='2373320'>in</span>
  <span m='2373470'>the</span> <span m='2373560'>Merkle</span> <span m='2373830'>root,</span>
  <span m='2374010'>which</span> <span m='2374190'>is</span> <span m='2374280'>then</span>
  <span m='2374430'>in</span> <span m='2374610'>the</span> <span m='2375000'>R</span>
  <span m='2375150'>point--</span> <span m='2375450'>which</span> <span m='2375600'>is
  in</span> <span m='2375810'>the</span> <span m='2375870'>signature,</span> <span
  m='2376440'>which</span> <span m='2376620'>is</span> <span m='2376740'>in</span>
  <span m='2376830'>the</span> <span m='2376950'>block's</span> <span m='2377460'>Merkle</span>
  <span m='2377700'>tree,</span> <span m='2378120'>which</span> <span m='2378330'>is</span>
  <span m='2378420'>in</span> <span m='2378510'>the</span> <span m='2378570'>blockchain.</span>
  <span m='2379530'>So</span> <span m='2379650'>you've</span> <span m='2379770'>got,</span>
  <span m='2379980'>like,</span> <span m='2380580'>four</span> <span m='2380850'>or</span>
  <span m='2380880'>five</span> <span m='2381150'>different</span> <span m='2381420'>proofs</span>
  <span m='2381690'>going</span> <span m='2382233'>on,</span> <span m='2382920'>but</span>
  <span m='2383280'>they</span> <span m='2383520'>should</span> <span m='2383790'>all</span>
  <span m='2383910'>be</span> <span m='2384060'>working.</span> </p><p><span m='2385240'>OK,</span>
  <span m='2385530'>so</span> <span m='2385930'>this</span> <span m='2386080'>is</span>
  <span m='2386550'>kind</span> <span m='2386700'>of</span> <span m='2386760'>cool.</span>
  <span m='2389130'>Any</span> <span m='2389340'>idea</span> <span m='2389580'>why</span>
  <span m='2390090'>I</span> <span m='2390240'>was</span> <span m='2390390'>explaining</span>
  <span m='2390840'>all</span> <span m='2390930'>this</span> <span m='2391230'>in</span>
  <span m='2391380'>terms</span> <span m='2391860'>of</span> <span m='2392250'>MAST</span>
  <span m='2393000'>and</span> <span m='2393210'>multisig?</span> <span m='2394350'>These</span>
  <span m='2394590'>seem</span> <span m='2394980'>totally</span> <span m='2395370'>unconnected,</span>
  <span m='2396030'>right?</span> <span m='2398100'>Any</span> <span m='2398310'>idea?</span>
  </p><p><span m='2403220'>It</span> <span m='2403340'>took</span> <span m='2403550'>Bitcoin</span>
  <span m='2404000'>people</span> <span m='2404300'>like</span> <span m='2404840'>well</span>
  <span m='2405230'>over</span> <span m='2405530'>a</span> <span m='2405620'>year</span>
  <span m='2406340'>to</span> <span m='2406490'>see</span> <span m='2406730'>the,</span>
  <span m='2407780'>in</span> <span m='2407870'>retrospect,</span> <span m='2408410'>really</span>
  <span m='2408830'>obvious</span> <span m='2409220'>connection,</span> <span m='2409760'>and</span>
  <span m='2409970'>thing</span> <span m='2410180'>to</span> <span m='2410300'>do</span>
  <span m='2410480'>with</span> <span m='2410600'>this.</span> <span m='2412950'>But</span>
  <span m='2413880'>it</span> <span m='2413970'>took</span> <span m='2414120'>a</span>
  <span m='2414180'>year</span> <span m='2414300'>or</span> <span m='2414370'>two.</span>
  <span m='2414780'>And</span> <span m='2414870'>then</span> <span m='2415710'>Greg</span>
  <span m='2415950'>posted</span> <span m='2416280'>on</span> <span m='2416370'>the</span>
  <span m='2416460'>mailing</span> <span m='2416760'>list</span> <span m='2417450'>in</span>
  <span m='2417690'>January--</span> <span m='2418380'>like,</span> <span m='2418560'>hey</span>
  <span m='2418710'>wait,</span> <span m='2419640'>you</span> <span m='2419850'>can</span>
  <span m='2420270'>use</span> <span m='2420510'>this</span> <span m='2420780'>for</span>
  <span m='2420900'>something</span> <span m='2421170'>else.</span> <span m='2421680'>And</span>
  <span m='2421900'>then</span> <span m='2422010'>it</span> <span m='2422070'>was</span>
  <span m='2422160'>like,</span> <span m='2422310'>oh</span> <span m='2422550'>shoot,</span>
  <span m='2424080'>how</span> <span m='2424170'>did</span> <span m='2424260'>no one</span>
  <span m='2424500'>think</span> <span m='2424650'>of</span> <span m='2424710'>that?</span>
  </p><p><span m='2426330'>So</span> <span m='2426570'>it's</span> <span m='2426690'>called</span>
  <span m='2426900'>taproot,</span> <span m='2428580'>and</span> <span m='2429510'>I</span>
  <span m='2429630'>don't</span> <span m='2429750'>know</span> <span m='2429870'>why</span>
  <span m='2430020'>Greg</span> <span m='2430200'>called</span> <span m='2430470'>it</span>
  <span m='2430560'>that.</span> <span m='2431250'>Greg</span> <span m='2431550'>Maxwell,</span>
  <span m='2432060'>he's</span> <span m='2432510'>a</span> <span m='2432840'>guy</span>
  <span m='2432990'>with</span> <span m='2433110'>a</span> <span m='2433140'>big</span>
  <span m='2433290'>beard,</span> <span m='2433560'>who</span> <span m='2433650'>works</span>
  <span m='2433890'>on</span> <span m='2434010'>Bitcoin.</span> <span m='2434460'>He's</span>
  <span m='2434730'>super</span> <span m='2434970'>smart</span> <span m='2435180'>and</span>
  <span m='2435270'>stuff.</span> <span m='2437160'>And</span> <span m='2437280'>it</span>
  <span m='2437340'>uses</span> <span m='2437700'>this</span> <span m='2437850'>pay</span>
  <span m='2438010'>to</span> <span m='2438090'>contract</span> <span m='2438510'>hash</span>
  <span m='2439200'>construction.</span> <span m='2440340'>And</span> <span m='2440610'>it's</span>
  <span m='2440730'>the</span> <span m='2440790'>same</span> <span m='2441000'>equation,</span>
  <span m='2441810'>but</span> <span m='2441960'>it</span> <span m='2442020'>took</span>
  <span m='2442170'>us</span> <span m='2442260'>a</span> <span m='2442590'>year</span>
  <span m='2442710'>or</span> <span m='2442770'>two</span> <span m='2442920'>to</span>
  <span m='2442980'>figure</span> <span m='2443220'>out</span> <span m='2443370'>that</span>
  <span m='2443460'>you</span> <span m='2443550'>could</span> <span m='2443640'>do</span>
  <span m='2443700'>this.</span> </p><p><span m='2445320'>So</span> <span m='2446280'>the</span>
  <span m='2446370'>motivation</span> <span m='2446940'>here</span> <span m='2447150'>is</span>
  <span m='2448460'>pay</span> <span m='2448720'>to</span> <span m='2448830'>pubkey</span>
  <span m='2449190'>hash</span> <span m='2450060'>and</span> <span m='2450630'>pay</span>
  <span m='2450990'>to</span> <span m='2451260'>script</span> <span m='2451560'>hash</span>
  <span m='2452220'>look</span> <span m='2452700'>different.</span> <span m='2453960'>You</span>
  <span m='2454080'>can</span> <span m='2454230'>tell</span> <span m='2454530'>just</span>
  <span m='2454710'>looking</span> <span m='2454950'>at</span> <span m='2455010'>the</span>
  <span m='2455100'>output,</span> <span m='2455500'>these</span> <span m='2455610'>are</span>
  <span m='2455670'>totally</span> <span m='2456450'>different</span> <span m='2457440'>output</span>
  <span m='2457710'>scripts.</span> <span m='2458430'>One</span> <span m='2458610'>of</span>
  <span m='2458700'>them has</span> <span m='2458850'>got</span> <span m='2459000'>a</span>
  <span m='2459060'>pubkey</span> <span m='2459510'>hash.</span> <span m='2459640'>One</span>
  <span m='2459750'>of</span> <span m='2459900'>them has</span> <span m='2460010'>got
  a</span> <span m='2460050'>script</span> <span m='2460260'>hash.</span> <span m='2461700'>Different</span>
  <span m='2461970'>is</span> <span m='2462060'>bad.</span> <span m='2462700'>We</span>
  <span m='2462720'>don't</span> <span m='2462870'>want</span> <span m='2463020'>everything</span>
  <span m='2463290'>to</span> <span m='2463350'>look</span> <span m='2463500'>different.</span>
  <span m='2464310'>Then,</span> <span m='2464700'>you</span> <span m='2464850'>can</span>
  <span m='2465090'>sort</span> <span m='2465495'>of sort</span> <span m='2465900'>things.</span>
  <span m='2466350'>You</span> <span m='2466470'>can</span> <span m='2466590'>try</span>
  <span m='2466770'>to</span> <span m='2466860'>differentiate,</span> <span m='2467870'>try</span>
  <span m='2468070'>to</span> <span m='2468180'>track</span> <span m='2468570'>people's</span>
  <span m='2468930'>coins,</span> <span m='2469500'>things</span> <span m='2469710'>like</span>
  <span m='2469830'>that.</span> <span m='2470070'>You</span> <span m='2470190'>want</span>
  <span m='2470410'>it</span> <span m='2470490'>to</span> <span m='2470580'>all</span>
  <span m='2470710'>look</span> <span m='2470910'>uniform,</span> <span m='2471630'>to</span>
  <span m='2471780'>make</span> <span m='2471990'>it</span> <span m='2472110'>more</span>
  <span m='2472440'>anonymous.</span> </p><p><span m='2475170'>So</span> <span m='2475290'>one</span>
  <span m='2475440'>thing</span> <span m='2475560'>you</span> <span m='2475650'>could</span>
  <span m='2475890'>do</span> <span m='2476520'>is</span> <span m='2476640'>just</span>
  <span m='2476790'>use</span> <span m='2476970'>pay</span> <span m='2477140'>to</span>
  <span m='2477180'>script</span> <span m='2477570'>for</span> <span m='2477660'>everything.</span>
  <span m='2478740'>You</span> <span m='2478860'>can</span> <span m='2479010'>put</span>
  <span m='2479250'>a</span> <span m='2479380'>pubkey</span> <span m='2480240'>single--</span>
  <span m='2480930'>essentially,</span> <span m='2481320'>1</span> <span m='2481500'>of</span>
  <span m='2481620'>1</span> <span m='2481830'>multisig,</span> <span m='2482460'>or</span>
  <span m='2482550'>just</span> <span m='2485560'>pay</span> <span m='2485780'>to</span>
  <span m='2485940'>pubkey</span> <span m='2486220'>hash</span> <span m='2486380'>script</span>
  <span m='2487460'>in</span> <span m='2487940'>pay</span> <span m='2488190'>to</span>
  <span m='2488270'>script</span> <span m='2488570'>hash.</span> <span m='2491040'>You</span>
  <span m='2491290'>wouldn't</span> <span m='2491480'>do</span> <span m='2491630'>that.</span>
  <span m='2492320'>You'd</span> <span m='2492470'>have</span> <span m='2492720'>that</span>
  <span m='2493160'>you'd</span> <span m='2493280'>have</span> <span m='2493460'>the</span>
  <span m='2493550'>direct</span> <span m='2494120'>pay</span> <span m='2494420'>to</span>
  <span m='2494690'>pubkey</span> <span m='2496010'>put</span> <span m='2496330'>into</span>
  <span m='2496640'>a</span> <span m='2496700'>script</span> <span m='2497030'>hash.</span>
  <span m='2497890'>So</span> <span m='2498110'>that</span> <span m='2498350'>like</span>
  <span m='2498620'>it</span> <span m='2498680'>looks</span> <span m='2498950'>like</span>
  <span m='2499100'>a</span> <span m='2499130'>script</span> <span m='2499370'>hash,</span>
  <span m='2499670'>and</span> <span m='2499790'>then</span> <span m='2499880'>the</span>
  <span m='2499940'>script</span> <span m='2500270'>is</span> <span m='2500700'>public</span>
  <span m='2500980'>key</span> <span m='2501340'>OP_CHECKSIG.</span> <span m='2503090'>It's</span>
  <span m='2503300'>actually</span> <span m='2504020'>not</span> <span m='2504440'>really</span>
  <span m='2504860'>any</span> <span m='2505100'>overhead.</span> <span m='2505460'>I</span>
  <span m='2505580'>think</span> <span m='2505790'>you</span> <span m='2505910'>actually</span>
  <span m='2506510'>save</span> <span m='2507800'>a</span> <span m='2507920'>byte</span>
  <span m='2508370'>or</span> <span m='2508550'>two.</span> <span m='2509850'>Nobody</span>
  <span m='2510080'>does</span> <span m='2510320'>that.</span> <span m='2511210'>You</span>
  <span m='2511655'>could.</span> <span m='2513435'>That</span> <span m='2513880'>might</span>
  <span m='2514220'>solve</span> <span m='2514510'>like</span> <span m='2515200'>80%</span>
  <span m='2515770'>of</span> <span m='2515860'>what</span> <span m='2515980'>this</span>
  <span m='2516160'>is</span> <span m='2516280'>trying</span> <span m='2516520'>to</span>
  <span m='2516580'>solve.</span> <span m='2517450'>But</span> <span m='2517680'>it's</span>
  <span m='2517780'>kind</span> <span m='2517930'>of</span> <span m='2517990'>boring</span>
  <span m='2518320'>and</span> <span m='2518410'>doesn't</span> <span m='2518590'>use</span>
  <span m='2518740'>cool</span> <span m='2518890'>math,</span> <span m='2519130'>so</span>
  <span m='2519280'>anyway.</span> </p><p><span m='2521140'>OK,</span> <span m='2522670'>the</span>
  <span m='2522910'>other</span> <span m='2523090'>observation</span> <span m='2523840'>is</span>
  <span m='2523990'>that</span> <span m='2524290'>in</span> <span m='2524500'>most</span>
  <span m='2524830'>cases</span> <span m='2525850'>scripts--</span> <span m='2526930'>you</span>
  <span m='2527050'>have</span> <span m='2527140'>these</span> <span m='2527260'>sort</span>
  <span m='2527440'>of</span> <span m='2527500'>scripts.</span> <span m='2528340'>And</span>
  <span m='2528480'>there's</span> <span m='2529020'>a</span> <span m='2529210'>hidden</span>
  <span m='2530050'>option,</span> <span m='2530440'>which</span> <span m='2530620'>is,</span>
  <span m='2531280'>or</span> <span m='2531670'>everyone</span> <span m='2532210'>signs.</span>
  <span m='2532780'>So</span> <span m='2532960'>in</span> <span m='2533050'>the</span>
  <span m='2533110'>case</span> <span m='2533380'>of</span> <span m='2533500'>2</span>
  <span m='2533920'>of</span> <span m='2533980'>50</span> <span m='2534310'>multisig--</span>
  <span m='2535330'>well,</span> <span m='2535480'>if</span> <span m='2535720'>all</span>
  <span m='2536020'>50</span> <span m='2536410'>people</span> <span m='2536770'>sign,</span>
  <span m='2537490'>that's</span> <span m='2537730'>OK,</span> <span m='2538330'>right?</span>
  <span m='2538750'>That's</span> <span m='2538960'>no</span> <span m='2539110'>worse.</span>
  <span m='2540020'>So</span> <span m='2540040'>if</span> <span m='2540130'>it's</span>
  <span m='2540250'>25</span> <span m='2540720'>of</span> <span m='2540790'>50</span>
  <span m='2541090'>multisig,</span> <span m='2541900'>if</span> <span m='2542080'>all</span>
  <span m='2542230'>50</span> <span m='2542560'>people</span> <span m='2542890'>happen</span>
  <span m='2543130'>to</span> <span m='2543220'>sign,</span> <span m='2543660'>sure,</span>
  <span m='2544180'>that's</span> <span m='2544930'>no</span> <span m='2545740'>loss</span>
  <span m='2546400'>of</span> <span m='2546490'>security</span> <span m='2546850'>there.</span>
  </p><p><span m='2548110'>The</span> <span m='2548200'>idea</span> <span m='2548470'>is</span>
  <span m='2549220'>you</span> <span m='2549370'>use</span> <span m='2550630'>this</span>
  <span m='2551240'>pay</span> <span m='2551420'>to</span> <span m='2551500'>script,</span>
  <span m='2551890'>pay</span> <span m='2552090'>to</span> <span m='2552160'>contract</span>
  <span m='2552500'>hash</span> <span m='2552670'>construction</span> <span m='2553120'>to</span>
  <span m='2553240'>merge</span> <span m='2553780'>pay</span> <span m='2554090'>to</span>
  <span m='2554440'>pubkey</span> <span m='2554830'>hash</span> <span m='2555130'>and</span>
  <span m='2555340'>pay</span> <span m='2555550'>to</span> <span m='2555580'>script</span>
  <span m='2555850'>hash,</span> <span m='2556480'>so</span> <span m='2556600'>that</span>
  <span m='2556750'>a</span> <span m='2556810'>single</span> <span m='2557200'>output</span>
  <span m='2557560'>can</span> <span m='2557740'>do</span> <span m='2557890'>both.</span>
  <span m='2558565'>The</span> <span m='2558880'>idea</span> <span m='2559090'>is</span>
  <span m='2559300'>you</span> <span m='2559360'>make</span> <span m='2559570'>a</span>
  <span m='2559630'>key,</span> <span m='2559900'>J,</span> <span m='2560470'>and</span>
  <span m='2560770'>J</span> <span m='2561130'>is</span> <span m='2561280'>an</span>
  <span m='2561460'>actual</span> <span m='2561940'>key.</span> <span m='2562210'>Like,</span>
  <span m='2562420'>you</span> <span m='2562540'>have</span> <span m='2562720'>the</span>
  <span m='2562780'>private</span> <span m='2563110'>key</span> <span m='2563230'>for</span>
  <span m='2563470'>it.</span> <span m='2564160'>It's</span> <span m='2564280'>a</span>
  <span m='2564340'>regular</span> <span m='2564640'>old</span> <span m='2564790'>pubkey.</span>
  <span m='2565810'>And</span> <span m='2565930'>you</span> <span m='2565990'>have</span>
  <span m='2566080'>a</span> <span m='2566140'>script</span> <span m='2566620'>z.</span>
  <span m='2568470'>And</span> <span m='2568920'>instead</span> <span m='2569310'>of</span>
  <span m='2569400'>sending</span> <span m='2570240'>either</span> <span m='2570780'>to</span>
  <span m='2571310'>the</span> <span m='2571410'>script</span> <span m='2571680'>z,</span>
  <span m='2572040'>in</span> <span m='2572160'>a</span> <span m='2572200'>pay</span>
  <span m='2572340'>to</span> <span m='2572430'>script</span> <span m='2572670'>hash</span>
  <span m='2572860'>construction,</span> <span m='2573690'>or</span> <span m='2574020'>to</span>
  <span m='2574710'>hash</span> <span m='2575070'>this</span> <span m='2575430'>key</span>
  <span m='2575670'>J</span> <span m='2576290'>inside</span> <span m='2576750'>the</span>
  <span m='2577130'>pubkey</span> <span m='2577420'>hash,</span> <span m='2578050'>you</span>
  <span m='2578220'>say,</span> <span m='2578370'>I'm</span> <span m='2578460'>going</span>
  <span m='2578580'>to</span> <span m='2578640'>compute</span> <span m='2578970'>key</span>
  <span m='2579170'>C--</span> <span m='2579780'>which</span> <span m='2580020'>is</span>
  <span m='2580740'>J</span> <span m='2581280'>plus</span> <span m='2581730'>the</span>
  <span m='2581850'>hash</span> <span m='2582360'>of</span> <span m='2582660'>my</span>
  <span m='2582840'>script,</span> <span m='2583650'>concatenated</span> <span m='2584310'>with</span>
  <span m='2584490'>J,</span> <span m='2585190'>times</span> <span m='2585550'>G.</span>
  </p><p><span m='2586620'>So</span> <span m='2587130'>this</span> <span m='2588270'>is</span>
  <span m='2588720'>the</span> <span m='2588840'>same</span> <span m='2589170'>as</span>
  <span m='2589290'>the</span> <span m='2589380'>thing</span> <span m='2589560'>I</span>
  <span m='2589620'>just</span> <span m='2590190'>did</span> <span m='2590370'>with</span>
  <span m='2590580'>the</span> <span m='2590710'>OP_RETURN</span> <span m='2591180'>and</span>
  <span m='2591310'>0</span> <span m='2591480'>bytes,</span> <span m='2591780'>right?</span>
  <span m='2593160'>And</span> <span m='2593250'>then</span> <span m='2593370'>I</span>
  <span m='2593430'>send</span> <span m='2593790'>money</span> <span m='2594120'>to</span>
  <span m='2594300'>it.</span> <span m='2597030'>And</span> <span m='2597150'>then,</span>
  <span m='2597420'>what</span> <span m='2597540'>do</span> <span m='2597630'>I</span>
  <span m='2597690'>do?</span> <span m='2598960'>I've</span> <span m='2599050'>sent</span>
  <span m='2599260'>money</span> <span m='2599530'>to</span> <span m='2599680'>this</span>
  <span m='2599860'>C</span> <span m='2600370'>point.</span> <span m='2602120'>Can</span>
  <span m='2602270'>I</span> <span m='2602360'>sign</span> <span m='2603500'>with</span>
  <span m='2603890'>C's</span> <span m='2605240'>private</span> <span m='2605540'>key?</span>
  <span m='2611270'>I</span> <span m='2611360'>know</span> <span m='2611750'>I</span>
  <span m='2611870'>know</span> <span m='2612030'>a</span> <span m='2612050'>little</span>
  <span m='2612290'>j.</span> <span m='2614160'>That's</span> <span m='2614340'>a</span>
  <span m='2614400'>regular</span> <span m='2614700'>key.</span> <span m='2615180'>Do</span>
  <span m='2615420'>I</span> <span m='2615540'>know</span> <span m='2615840'>a</span>
  <span m='2615870'>little</span> <span m='2616110'>c?</span> </p><p><span m='2621170'>Sure,</span>
  <span m='2622230'>yeah.</span> <span m='2624660'>I</span> <span m='2624750'>know</span>
  <span m='2624870'>that</span> <span m='2624990'>little</span> <span m='2625260'>c</span>
  <span m='2625860'>is</span> <span m='2626070'>just</span> <span m='2626730'>the</span>
  <span m='2626820'>j</span> <span m='2627210'>private</span> <span m='2627600'>key</span>
  <span m='2627900'>plus</span> <span m='2628290'>this</span> <span m='2628560'>hash.</span>
  <span m='2633820'>So</span> <span m='2634150'>if</span> <span m='2634300'>I</span>
  <span m='2634420'>want</span> <span m='2634690'>to</span> <span m='2635440'>treat</span>
  <span m='2635680'>it</span> <span m='2635800'>as</span> <span m='2635980'>a</span>
  <span m='2636100'>pay</span> <span m='2636330'>to</span> <span m='2636400'>pubkey</span>
  <span m='2636770'>hash,</span> <span m='2637720'>I</span> <span m='2637780'>just</span>
  <span m='2637960'>sign</span> <span m='2638260'>with</span> <span m='2638380'>little</span>
  <span m='2638580'>c.</span> <span m='2638880'>I</span> <span m='2639180'>sign</span>
  <span m='2639370'>my</span> <span m='2639490'>transaction</span> <span m='2640120'>and</span>
  <span m='2640210'>I'm</span> <span m='2640300'>good.</span> <span m='2640960'>Nobody</span>
  <span m='2641230'>has</span> <span m='2641410'>to</span> <span m='2641470'>know</span>
  <span m='2641860'>that</span> <span m='2642010'>I</span> <span m='2642070'>did</span>
  <span m='2642280'>this.</span> <span m='2643420'>However,</span> <span m='2643900'>if</span>
  <span m='2644050'>I</span> <span m='2644140'>want</span> <span m='2644380'>to</span>
  <span m='2644470'>make</span> <span m='2645310'>it</span> <span m='2645430'>into</span>
  <span m='2645670'>pay</span> <span m='2645820'>to</span> <span m='2645910'>script</span>
  <span m='2646180'>hash,</span> <span m='2646780'>I</span> <span m='2646960'>reveal</span>
  <span m='2648190'>the</span> <span m='2648280'>script</span> <span m='2648910'>z</span>
  <span m='2649720'>and</span> <span m='2650200'>the</span> <span m='2651130'>subkey</span>
  <span m='2651960'>J.</span> <span m='2653800'>And</span> <span m='2654100'>then</span>
  <span m='2654250'>I</span> <span m='2654400'>put</span> <span m='2654640'>some</span>
  <span m='2654820'>arguments</span> <span m='2655240'>on,</span> <span m='2655570'>and</span>
  <span m='2655690'>then</span> <span m='2655810'>run</span> <span m='2655960'>the</span>
  <span m='2656050'>script.</span> </p><p><span m='2657890'>So</span> <span m='2658210'>if</span>
  <span m='2658330'>I</span> <span m='2658420'>don't</span> <span m='2658600'>want</span>
  <span m='2658900'>to</span> <span m='2659020'>show</span> <span m='2659470'>that</span>
  <span m='2659620'>there</span> <span m='2659770'>was</span> <span m='2660460'>a</span>
  <span m='2660520'>script,</span> <span m='2661210'>I</span> <span m='2661270'>don't</span>
  <span m='2661480'>have</span> <span m='2661690'>to.</span> <span m='2663820'>I</span>
  <span m='2663980'>just</span> <span m='2664130'>sign</span> <span m='2664400'>with</span>
  <span m='2664550'>this.</span> <span m='2665540'>Private</span> <span m='2665840'>key's</span>
  <span m='2666080'>that.</span> <span m='2666770'>Nobody</span> <span m='2667070'>knows</span>
  <span m='2667370'>that</span> <span m='2667460'>there</span> <span m='2667580'>was</span>
  <span m='2667700'>a</span> <span m='2667730'>script</span> <span m='2667970'>at</span>
  <span m='2668060'>all.</span> <span m='2669320'>So</span> <span m='2670550'>if</span>
  <span m='2670670'>everyone's</span> <span m='2671000'>using</span> <span m='2671270'>this,</span>
  <span m='2671510'>80%</span> <span m='2671960'>of</span> <span m='2672020'>the</span>
  <span m='2672110'>time</span> <span m='2672680'>that's</span> <span m='2672920'>what</span>
  <span m='2673010'>happens.</span> <span m='2674270'>Maybe</span> <span m='2674540'>there</span>
  <span m='2674660'>was</span> <span m='2674780'>a</span> <span m='2674840'>script</span>
  <span m='2675140'>in</span> <span m='2675230'>there.</span> <span m='2675410'>Maybe</span>
  <span m='2675650'>there</span> <span m='2675740'>wasn't.</span> <span m='2676470'>Can't</span>
  <span m='2676700'>tell,</span> <span m='2677240'>right?</span> </p><p><span m='2678530'>However,</span>
  <span m='2678860'>if</span> <span m='2678950'>I</span> <span m='2679040'>want</span>
  <span m='2679310'>to</span> <span m='2679370'>reveal,</span> <span m='2679640'>hey,</span>
  <span m='2679950'>actually</span> <span m='2680210'>this</span> <span m='2680360'>time,</span>
  <span m='2680930'>I'm</span> <span m='2681110'>using</span> <span m='2681410'>the</span>
  <span m='2681500'>script.</span> <span m='2682280'>So</span> <span m='2682430'>I</span>
  <span m='2682530'>revealed</span> <span m='2684260'>J</span> <span m='2684640'>and</span>
  <span m='2684780'>z.</span> <span m='2686030'>Everyone</span> <span m='2686420'>computes--</span>
  <span m='2686960'>OK,</span> <span m='2687230'>well,</span> <span m='2687830'>if</span>
  <span m='2688130'>I</span> <span m='2689670'>add</span> <span m='2689970'>J</span>
  <span m='2690750'>to</span> <span m='2690870'>the</span> <span m='2690960'>hash</span>
  <span m='2691290'>of</span> <span m='2691380'>z</span> <span m='2691590'>and</span>
  <span m='2691710'>J</span> <span m='2692040'>times</span> <span m='2692310'>g,</span>
  <span m='2693030'>does</span> <span m='2693390'>that</span> <span m='2693660'>equal</span>
  <span m='2694020'>c--</span> <span m='2694500'>the</span> <span m='2694590'>key</span>
  <span m='2694890'>that</span> <span m='2695070'>is</span> <span m='2695250'>in</span>
  <span m='2695370'>the</span> <span m='2695490'>output</span> <span m='2695790'>script</span>
  <span m='2696060'>itself?</span> <span m='2697410'>And</span> <span m='2697560'>if</span>
  <span m='2697650'>it</span> <span m='2697710'>does,</span> <span m='2698040'>cool,</span>
  <span m='2698760'>that</span> <span m='2698970'>was</span> <span m='2699150'>a</span>
  <span m='2699180'>valid</span> <span m='2699510'>proof</span> <span m='2699990'>that</span>
  <span m='2700230'>you</span> <span m='2700470'>actually</span> <span m='2700830'>committed</span>
  <span m='2701310'>to</span> <span m='2701460'>z.</span> <span m='2702810'>And</span>
  <span m='2702960'>now</span> <span m='2703110'>I</span> <span m='2703200'>run</span>
  <span m='2703530'>the</span> <span m='2703650'>script</span> <span m='2703990'>z.</span>
  <span m='2706480'>Any</span> <span m='2707110'>questions</span> <span m='2707410'>about</span>
  <span m='2707560'>this?</span> <span m='2707710'>Make</span> <span m='2707900'>sense?</span>
  </p><p><span m='2709400'>So</span> <span m='2709480'>it's</span> <span m='2709600'>actually</span>
  <span m='2710080'>pretty</span> <span m='2710320'>simple.</span> <span m='2710710'>It</span>
  <span m='2710950'>follows</span> <span m='2711340'>directly</span> <span m='2711820'>from</span>
  <span m='2712150'>the</span> <span m='2712360'>proofs,</span> <span m='2713530'>from</span>
  <span m='2713860'>the</span> <span m='2714160'>contract</span> <span m='2714610'>hash.</span>
  <span m='2715170'>And</span> <span m='2715300'>it's</span> <span m='2715810'>really</span>
  <span m='2716350'>cool</span> <span m='2716950'>because--</span> <span m='2719131'>oh,</span>
  <span m='2719550'>P.</span> <span m='2720160'>I</span> <span m='2720220'>thought</span>
  <span m='2720400'>I</span> <span m='2720990'>was</span> <span m='2721180'>doing</span>
  <span m='2721430'>C.</span> <span m='2721730'>Oops.</span> <span m='2722180'>Anyway.</span>
  </p><p><span m='2722920'>So</span> <span m='2723190'>what</span> <span m='2723340'>you</span>
  <span m='2723430'>can</span> <span m='2723520'>do</span> <span m='2723640'>is</span>
  <span m='2723730'>you</span> <span m='2723790'>can</span> <span m='2723910'>make</span>
  <span m='2724060'>the</span> <span m='2724120'>sum</span> <span m='2724480'>of</span>
  <span m='2724600'>everyone's</span> <span m='2725020'>keys.</span> <span m='2726970'>And</span>
  <span m='2727180'>so in</span> <span m='2727520'>Schnoor</span> <span m='2727930'>signatures</span>
  <span m='2728440'>we</span> <span m='2728590'>can</span> <span m='2728710'>do</span>
  <span m='2728800'>this,</span> <span m='2729070'>and</span> <span m='2729190'>we</span>
  <span m='2729280'>can</span> <span m='2729430'>sign</span> <span m='2730480'>without</span>
  <span m='2730930'>revealing</span> <span m='2731320'>each</span> <span m='2731470'>other's</span>
  <span m='2731680'>private</span> <span m='2731950'>keys.</span> <span m='2732200'>So</span>
  <span m='2732250'>you</span> <span m='2732340'>can</span> <span m='2732460'>say,</span>
  <span m='2732580'>OK,</span> <span m='2734140'>what</span> <span m='2734290'>I'm</span>
  <span m='2734350'>going</span> <span m='2734470'>to</span> <span m='2734530'>do</span>
  <span m='2734650'>is</span> <span m='2734800'>J</span> <span m='2735550'>is</span>
  <span m='2736420'>the</span> <span m='2736510'>sum</span> <span m='2736840'>of,</span>
  <span m='2737020'>like,</span> <span m='2738070'>50</span> <span m='2738400'>different</span>
  <span m='2738720'>pubkeys.</span> <span m='2740560'>And</span> <span m='2740770'>then</span>
  <span m='2742630'>z</span> <span m='2743310'>is</span> <span m='2743670'>that</span>
  <span m='2744060'>Merkle</span> <span m='2744450'>tree</span> <span m='2745140'>of</span>
  <span m='2745830'>2</span> <span m='2746250'>of</span> <span m='2746400'>50</span>
  <span m='2746790'>signatures.</span> </p><p><span m='2747880'>So</span> <span m='2747930'>if</span>
  <span m='2747990'>I</span> <span m='2748080'>want</span> <span m='2748290'>to</span>
  <span m='2748350'>use</span> <span m='2748590'>2</span> <span m='2748880'>of</span>
  <span m='2748960'>50,</span> <span m='2749910'>I</span> <span m='2750000'>have</span>
  <span m='2750150'>to</span> <span m='2750270'>reveal,</span> <span m='2751060'>and</span>
  <span m='2751170'>then</span> <span m='2751290'>I</span> <span m='2751320'>have</span>
  <span m='2751410'>to</span> <span m='2751500'>do</span> <span m='2751620'>the</span>
  <span m='2751710'>proof.</span> <span m='2752340'>But</span> <span m='2752490'>if</span>
  <span m='2752610'>I</span> <span m='2752720'>can get</span> <span m='2752970'>all</span>
  <span m='2753180'>50</span> <span m='2753720'>of</span> <span m='2753810'>50</span>
  <span m='2754140'>people</span> <span m='2754410'>to</span> <span m='2754470'>sign,</span>
  <span m='2755130'>they</span> <span m='2755370'>can</span> <span m='2755550'>produce</span>
  <span m='2755880'>a</span> <span m='2755910'>signature</span> <span m='2756360'>with</span>
  <span m='2756540'>private</span> <span m='2756810'>key</span> <span m='2757140'>little</span>
  <span m='2757320'>C.</span> <span m='2758810'>So</span> <span m='2758960'>when</span>
  <span m='2759080'>everyone's</span> <span m='2759440'>cooperating,</span> <span
  m='2762410'>you</span> <span m='2762560'>don't</span> <span m='2762680'>even</span>
  <span m='2762860'>see</span> <span m='2763130'>that</span> <span m='2763280'>there</span>
  <span m='2763400'>was</span> <span m='2764630'>a</span> <span m='2764930'>script</span>
  <span m='2765260'>involved.</span> <span m='2767210'>And</span> <span m='2767330'>you</span>
  <span m='2767420'>can</span> <span m='2767510'>do</span> <span m='2767630'>this</span>
  <span m='2767780'>Schnoor</span> <span m='2768080'>signatures.</span> <span m='2768440'>You</span>
  <span m='2768560'>cannot</span> <span m='2768890'>do</span> <span m='2769040'>this</span>
  <span m='2769190'>with</span> <span m='2769970'>ECDSA.</span> <span m='2770180'>So</span>
  <span m='2771560'>probably</span> <span m='2772190'>this</span> <span m='2772430'>would</span>
  <span m='2772670'>be</span> <span m='2775070'>put</span> <span m='2775280'>into</span>
  <span m='2775520'>Bitcoin</span> <span m='2776000'>alongside</span> <span m='2776600'>a</span>
  <span m='2777310'>Schnoor</span> <span m='2777470'>signature</span> <span m='2777890'>kind</span>
  <span m='2778100'>of</span> <span m='2778220'>construction.</span> </p><p><span
  m='2780530'>This</span> <span m='2780650'>seems</span> <span m='2780920'>useful</span>
  <span m='2781220'>because</span> <span m='2781430'>in</span> <span m='2781520'>most</span>
  <span m='2781790'>cases,</span> <span m='2783000'>most</span> <span m='2783230'>smart</span>
  <span m='2783470'>contracts,</span> <span m='2783980'>most</span> <span m='2784220'>multisig</span>
  <span m='2784850'>does</span> <span m='2785120'>have</span> <span m='2785300'>sort</span>
  <span m='2785480'>of</span> <span m='2785540'>an</span> <span m='2785720'>all-participants-sign</span>
  <span m='2786770'>clause.</span> <span m='2787610'>Even</span> <span m='2787790'>if</span>
  <span m='2787880'>we</span> <span m='2788000'>don't</span> <span m='2788300'>code</span>
  <span m='2788560'>it</span> <span m='2788720'>in</span> <span m='2788870'>right</span>
  <span m='2789140'>now,</span> <span m='2790340'>it's</span> <span m='2790490'>generally</span>
  <span m='2790850'>the</span> <span m='2790940'>case.</span> <span m='2791390'>Like,</span>
  <span m='2791690'>2</span> <span m='2792140'>of</span> <span m='2792200'>3</span>
  <span m='2792350'>multisig--</span> <span m='2792760'>well,</span> <span m='2792920'>3</span>
  <span m='2793160'>of</span> <span m='2793250'>3</span> <span m='2793430'>is</span>
  <span m='2793520'>good.</span> <span m='2794300'>And</span> <span m='2794390'>if</span>
  <span m='2794480'>you</span> <span m='2794570'>do</span> <span m='2794690'>3</span>
  <span m='2794870'>of</span> <span m='2794960'>3,</span> <span m='2795260'>hey,</span>
  <span m='2795590'>you</span> <span m='2795740'>don't</span> <span m='2796160'>even</span>
  <span m='2796490'>see</span> <span m='2796700'>that</span> <span m='2796820'>there</span>
  <span m='2796940'>was</span> <span m='2797210'>2</span> <span m='2797390'>of</span>
  <span m='2797480'>3.</span> <span m='2798920'>And</span> <span m='2799010'>so</span>
  <span m='2799130'>that</span> <span m='2799280'>preserves</span> <span m='2799670'>privacy.</span>
  <span m='2800330'>It</span> <span m='2800480'>saves</span> <span m='2800710'>space.</span>
  <span m='2801710'>And</span> <span m='2801890'>most</span> <span m='2802340'>of</span>
  <span m='2802400'>the</span> <span m='2802520'>time</span> <span m='2803600'>all</span>
  <span m='2803810'>the</span> <span m='2803900'>participants</span> <span m='2804500'>can</span>
  <span m='2804650'>be</span> <span m='2804800'>online.</span> <span m='2807110'>So</span>
  <span m='2807230'>that's</span> <span m='2807410'>the</span> <span m='2807470'>same</span>
  <span m='2808340'>basic</span> <span m='2808670'>idea</span> <span m='2808930'>as
  in</span> <span m='2809060'>lightning.</span> <span m='2811340'>If</span> <span
  m='2811760'>everyone's</span> <span m='2812180'>co-operative,</span> <span m='2812840'>you</span>
  <span m='2812990'>don't</span> <span m='2813140'>even</span> <span m='2813320'>see</span>
  <span m='2813470'>that</span> <span m='2813590'>there</span> <span m='2813680'>was</span>
  <span m='2813800'>a</span> <span m='2813860'>lightning</span> <span m='2814100'>channel.</span>
  <span m='2814790'>You</span> <span m='2814910'>just</span> <span m='2816230'>together</span>
  <span m='2816710'>broadcast</span> <span m='2817610'>a</span> <span m='2817670'>transaction</span>
  <span m='2818210'>with</span> <span m='2818390'>just</span> <span m='2818570'>2</span>
  <span m='2818750'>of</span> <span m='2819030'>2</span> <span m='2819220'>multisig.</span>
  <span m='2819970'>But</span> <span m='2820160'>in</span> <span m='2820240'>lightning,</span>
  <span m='2820490'>you</span> <span m='2820610'>do</span> <span m='2820820'>see</span>
  <span m='2820970'>that</span> <span m='2821090'>there</span> <span m='2821210'>was</span>
  <span m='2821510'>2</span> <span m='2821720'>of</span> <span m='2821810'>2</span>
  <span m='2822140'>multisig.</span> </p><p><span m='2822680'>So</span> <span m='2822800'>you</span>
  <span m='2822890'>can</span> <span m='2823010'>sort</span> <span m='2823210'>of</span>
  <span m='2823270'>see,</span> <span m='2823460'>oh,</span> <span m='2823970'>it</span>
  <span m='2824060'>was</span> <span m='2824330'>either</span> <span m='2824690'>a</span>
  <span m='2824720'>channel</span> <span m='2825140'>or a</span> <span m='2825380'>multisig.</span>
  <span m='2826580'>But</span> <span m='2826760'>in</span> <span m='2826850'>this</span>
  <span m='2827000'>kind</span> <span m='2827180'>of</span> <span m='2827270'>construction,</span>
  <span m='2828080'>you</span> <span m='2828200'>wouldn't</span> <span m='2828350'>even</span>
  <span m='2828560'>show</span> <span m='2828710'>that.</span> <span m='2829390'>You'd</span>
  <span m='2829470'>say,</span> <span m='2829610'>OK,</span> <span m='2829820'>this</span>
  <span m='2829970'>is</span> <span m='2830090'>actually</span> <span m='2830510'>2</span>
  <span m='2830660'>of</span> <span m='2830750'>2</span> <span m='2830870'>multisig,</span>
  <span m='2831350'>but</span> <span m='2832550'>we</span> <span m='2832700'>can</span>
  <span m='2832880'>merge</span> <span m='2833150'>them.</span> </p><p><span m='2836520'>Oh,</span>
  <span m='2837000'>other</span> <span m='2837270'>weird</span> <span m='2837630'>trick--</span>
  <span m='2839550'>you</span> <span m='2839670'>can</span> <span m='2839850'>make</span>
  <span m='2840180'>a</span> <span m='2840240'>public</span> <span m='2840570'>key,</span>
  <span m='2841140'>and</span> <span m='2841260'>prove</span> <span m='2841860'>that</span>
  <span m='2841980'>there</span> <span m='2842130'>is</span> <span m='2842400'>no</span>
  <span m='2842610'>known</span> <span m='2842940'>private</span> <span m='2843300'>key.</span>
  <span m='2844620'>So</span> <span m='2846150'>what</span> <span m='2846330'>if</span>
  <span m='2846450'>I</span> <span m='2846810'>only</span> <span m='2847290'>want</span>
  <span m='2847560'>this</span> <span m='2847740'>script</span> <span m='2848480'>z,</span>
  <span m='2849240'>and</span> <span m='2849360'>there</span> <span m='2849630'>is</span>
  <span m='2849990'>no</span> <span m='2850470'>set</span> <span m='2851040'>of</span>
  <span m='2851310'>everyone</span> <span m='2851730'>signing?</span> <span m='2852810'>I</span>
  <span m='2852870'>don't</span> <span m='2853050'>want</span> <span m='2853320'>that</span>
  <span m='2853470'>to</span> <span m='2853560'>be</span> <span m='2853710'>a</span>
  <span m='2853740'>requirement.</span> <span m='2854430'>What</span> <span m='2854580'>if</span>
  <span m='2854700'>I</span> <span m='2855090'>only</span> <span m='2855360'>want</span>
  <span m='2855570'>the</span> <span m='2855670'>script</span> <span m='2855990'>hash?</span>
  <span m='2857280'>I</span> <span m='2857370'>can</span> <span m='2857490'>do</span>
  <span m='2857610'>that.</span> <span m='2858600'>Interactively,</span> <span m='2859740'>I</span>
  <span m='2859800'>can</span> <span m='2859920'>use</span> <span m='2860100'>someone</span>
  <span m='2860520'>else's</span> <span m='2860970'>J.</span> <span m='2861930'>If</span>
  <span m='2863280'>I'm</span> <span m='2863460'>sending</span> <span m='2863760'>you</span>
  <span m='2863910'>a</span> <span m='2863970'>script</span> <span m='2864360'>that</span>
  <span m='2864540'>involves</span> <span m='2864900'>someone</span> <span m='2865170'>else,</span>
  <span m='2865340'>I</span> <span m='2865410'>say,</span> <span m='2865530'>hey,</span>
  <span m='2866160'>can</span> <span m='2866310'>you</span> <span m='2866430'>come</span>
  <span m='2866700'>up</span> <span m='2866820'>with</span> <span m='2866970'>a</span>
  <span m='2867030'>key</span> <span m='2867240'>J?</span> <span m='2868200'>I'm</span>
  <span m='2868470'>going</span> <span m='2868710'>to</span> <span m='2868800'>compute</span>
  <span m='2869140'>a</span> <span m='2869190'>key</span> <span m='2869460'>C,</span>
  <span m='2869940'>that's</span> <span m='2870180'>J</span> <span m='2870510'>plus</span>
  <span m='2870810'>the</span> <span m='2870900'>hash</span> <span m='2871140'>of</span>
  <span m='2871230'>the</span> <span m='2871290'>script</span> <span m='2871680'>comma</span>
  <span m='2872020'>J</span> <span m='2872510'>times</span> <span m='2872790'>G.</span>
  <span m='2875210'>And</span> <span m='2875340'>then</span> <span m='2875490'>I</span>
  <span m='2875550'>can</span> <span m='2875700'>prove</span> <span m='2875940'>that</span>
  <span m='2876090'>to</span> <span m='2876210'>you</span> <span m='2876660'>after</span>
  <span m='2876900'>the</span> <span m='2876990'>fact.</span> <span m='2877740'>And</span>
  <span m='2877860'>you</span> <span m='2877980'>can</span> <span m='2878130'>say,</span>
  <span m='2878280'>OK,</span> <span m='2878520'>well,</span> <span m='2878760'>I</span>
  <span m='2878850'>know</span> <span m='2879000'>it's</span> <span m='2879260'>my
  key.</span> <span m='2879510'>So</span> <span m='2879780'>interactive,</span> <span
  m='2880860'>I</span> <span m='2880950'>can</span> <span m='2881070'>show</span>
  <span m='2881220'>that</span> <span m='2881340'>it's</span> <span m='2881460'>someone</span>
  <span m='2881730'>else's</span> <span m='2882060'>key.</span> </p><p><span m='2882600'>Non-interactive,</span>
  <span m='2883950'>I</span> <span m='2884070'>can</span> <span m='2884220'>just</span>
  <span m='2884340'>say,</span> <span m='2884520'>look,</span> <span m='2884820'>I</span>
  <span m='2884910'>know</span> <span m='2885090'>the</span> <span m='2885180'>pre-image</span>
  <span m='2885960'>of</span> <span m='2886110'>the</span> <span m='2886260'>x-coordinate</span>
  <span m='2887010'>of</span> <span m='2887190'>J.</span> <span m='2889550'>So</span>
  <span m='2889730'>basically,</span> <span m='2890870'>I</span> <span m='2890990'>can</span>
  <span m='2891140'>prove</span> <span m='2891470'>to</span> <span m='2891560'>you</span>
  <span m='2891680'>that</span> <span m='2892610'>there's</span> <span m='2892790'>no</span>
  <span m='2893060'>way</span> <span m='2893300'>I</span> <span m='2893420'>came</span>
  <span m='2893750'>up</span> <span m='2893900'>with</span> <span m='2894080'>this</span>
  <span m='2894260'>point</span> <span m='2894590'>on</span> <span m='2894710'>the</span>
  <span m='2894800'>curve</span> <span m='2895370'>in</span> <span m='2895520'>the</span>
  <span m='2895610'>normal</span> <span m='2896420'>multiply</span> <span m='2896930'>by</span>
  <span m='2897080'>G</span> <span m='2897290'>way.</span> <span m='2898340'>Because</span>
  <span m='2900980'>that</span> <span m='2901140'>sort</span> <span m='2901340'>of</span>
  <span m='2901430'>shows</span> <span m='2901730'>that</span> <span m='2902360'>I</span>
  <span m='2902510'>came</span> <span m='2902840'>up</span> <span m='2902990'>with</span>
  <span m='2903140'>the</span> <span m='2903290'>x-coordinate</span> <span m='2904190'>by</span>
  <span m='2904370'>just</span> <span m='2904550'>hashing</span> <span m='2904970'>a</span>
  <span m='2905030'>random</span> <span m='2905360'>number--</span> <span m='2906920'>or
  a</span> <span m='2907340'>non-random</span> <span m='2907820'>number,</span> <span
  m='2908280'>if</span> <span m='2908330'>it's</span> <span m='2908450'>the</span>
  <span m='2908540'>hash</span> <span m='2908780'>of</span> <span m='2908900'>0,</span>
  <span m='2909500'>or</span> <span m='2909650'>if</span> <span m='2909770'>it's the</span>
  <span m='2909860'>hash</span> <span m='2910130'>of</span> <span m='2911270'>anything.</span>
  <span m='2911960'>The</span> <span m='2912080'>idea</span> <span m='2912380'>is</span>
  <span m='2912620'>I</span> <span m='2912770'>randomly</span> <span m='2913490'>picked</span>
  <span m='2914180'>an</span> <span m='2914300'>x-coordinate</span> <span m='2915530'>on</span>
  <span m='2915710'>this</span> <span m='2915890'>curve,</span> <span m='2916730'>figured</span>
  <span m='2917060'>out</span> <span m='2917150'>what</span> <span m='2917270'>the</span>
  <span m='2917330'>y-coordinate</span> <span m='2917900'>was,</span> <span m='2918530'>turned</span>
  <span m='2918740'>that</span> <span m='2918890'>into</span> <span m='2919070'>a</span>
  <span m='2919100'>point,</span> <span m='2919700'>and</span> <span m='2919790'>then</span>
  <span m='2919940'>used</span> <span m='2920240'>it</span> <span m='2920300'>in</span>
  <span m='2920390'>this</span> <span m='2920540'>construction.</span> <span m='2921920'>If</span>
  <span m='2922100'>I</span> <span m='2922190'>do</span> <span m='2922340'>that,</span>
  <span m='2922850'>you</span> <span m='2922970'>can</span> <span m='2923150'>be</span>
  <span m='2923240'>pretty</span> <span m='2923540'>sure</span> <span m='2923720'>that</span>
  <span m='2923870'>I</span> <span m='2923960'>don't</span> <span m='2924260'>know</span>
  <span m='2924470'>the</span> <span m='2924560'>private</span> <span m='2924950'>key</span>
  <span m='2925250'>for</span> <span m='2925430'>J,</span> <span m='2925850'>because</span>
  <span m='2926570'>I</span> <span m='2926660'>didn't</span> <span m='2926960'>compute</span>
  <span m='2927440'>it</span> <span m='2927770'>the</span> <span m='2927860'>right</span>
  <span m='2928070'>way.</span> <span m='2930040'>Does</span> <span m='2930140'>that</span>
  <span m='2930260'>make</span> <span m='2930380'>sense?</span> </p><p><span m='2932200'>So</span>
  <span m='2932320'>you</span> <span m='2932410'>can</span> <span m='2932500'>do</span>
  <span m='2932590'>that.</span> <span m='2934840'>That's</span> <span m='2935290'>a</span>
  <span m='2935380'>way</span> <span m='2935800'>to</span> <span m='2935950'>then</span>
  <span m='2936220'>prove</span> <span m='2936550'>to</span> <span m='2936640'>other</span>
  <span m='2936850'>people</span> <span m='2938310'>like</span> <span m='2938590'>there</span>
  <span m='2938770'>is</span> <span m='2938980'>no</span> <span m='2939430'>J.</span>
  <span m='2940390'>It's</span> <span m='2940540'>a</span> <span m='2940600'>point</span>
  <span m='2940930'>on</span> <span m='2941050'>the</span> <span m='2941110'>curve,</span>
  <span m='2941550'>but</span> <span m='2941590'>it's</span> <span m='2941710'>a</span>
  <span m='2941770'>random</span> <span m='2942160'>point</span> <span m='2942370'>on</span>
  <span m='2942460'>the</span> <span m='2942520'>curve.</span> <span m='2943090'>So</span>
  <span m='2943240'>there's</span> <span m='2943420'>no</span> <span m='2943600'>way</span>
  <span m='2943870'>I</span> <span m='2944050'>can</span> <span m='2944260'>sign</span>
  <span m='2945070'>with</span> <span m='2945310'>c.</span> <span m='2950490'>I</span>
  <span m='2950550'>sent</span> <span m='2950830'>the</span> <span m='2950880'>pubkey</span>
  <span m='2951120'>c.</span> <span m='2951810'>And</span> <span m='2951900'>I</span>
  <span m='2951990'>proved</span> <span m='2952290'>to you,</span> <span m='2952380'>look,</span>
  <span m='2952890'>C</span> <span m='2953130'>is</span> <span m='2953250'>not</span>
  <span m='2953430'>a</span> <span m='2953490'>key</span> <span m='2953640'>that</span>
  <span m='2953790'>anyone</span> <span m='2954090'>can</span> <span m='2954210'>sign</span>
  <span m='2954420'>with.</span> <span m='2955650'>However,</span> <span m='2956310'>there</span>
  <span m='2956520'>is</span> <span m='2956940'>a</span> <span m='2957000'>point</span>
  <span m='2957300'>J,</span> <span m='2957780'>and</span> <span m='2957900'>there's</span>
  <span m='2958110'>a</span> <span m='2958160'>script</span> <span m='2958470'>z,</span>
  <span m='2958800'>and</span> <span m='2958920'>you</span> <span m='2958980'>can</span>
  <span m='2959100'>execute</span> <span m='2959460'>the</span> <span m='2959520'>script.</span>
  <span m='2961180'>So</span> <span m='2961300'>that's</span> <span m='2962200'>useful</span>
  <span m='2962620'>in</span> <span m='2962710'>many</span> <span m='2962920'>cases,</span>
  <span m='2963280'>where</span> <span m='2963460'>you</span> <span m='2963580'>want</span>
  <span m='2963820'>to</span> <span m='2963910'>prove</span> <span m='2964270'>to</span>
  <span m='2964390'>people</span> <span m='2965170'>that,</span> <span m='2965320'>look,</span>
  <span m='2965500'>there</span> <span m='2965680'>is</span> <span m='2965860'>no</span>
  <span m='2965980'>key</span> <span m='2966160'>here.</span> <span m='2966340'>It's</span>
  <span m='2966550'>just</span> <span m='2966820'>a</span> <span m='2966850'>script.</span>
  <span m='2968620'>And</span> <span m='2968710'>then</span> <span m='2969250'>everyone</span>
  <span m='2969550'>will</span> <span m='2969640'>find</span> <span m='2969940'>out</span>
  <span m='2970060'>later</span> <span m='2970360'>when</span> <span m='2970510'>you</span>
  <span m='2970600'>spend</span> <span m='2970930'>it.</span> <span m='2972160'>But</span>
  <span m='2972310'>they</span> <span m='2972370'>don't</span> <span m='2972520'>have</span>
  <span m='2972610'>to</span> <span m='2972700'>know</span> <span m='2972820'>that</span>
  <span m='2972940'>there</span> <span m='2973060'>was</span> <span m='2973420'>no</span>
  <span m='2973590'>key.</span> <span m='2973810'>They</span> <span m='2973930'>just</span>
  <span m='2974080'>know</span> <span m='2974200'>that</span> <span m='2974320'>the</span>
  <span m='2974410'>script</span> <span m='2974680'>got</span> <span m='2974830'>executed.</span>
  <span m='2975940'>So</span> <span m='2976270'>that's</span> <span m='2976480'>a</span>
  <span m='2976540'>nice</span> <span m='2978340'>sort</span> <span m='2978490'>of</span>
  <span m='2978850'>patch,</span> <span m='2979900'>where</span> <span m='2980050'>you</span>
  <span m='2980200'>can</span> <span m='2980470'>default.</span> <span m='2981640'>If</span>
  <span m='2981760'>there's</span> <span m='2981970'>any</span> <span m='2982180'>use</span>
  <span m='2982390'>cases</span> <span m='2982780'>where</span> <span m='2983080'>in</span>
  <span m='2983350'>the</span> <span m='2983440'>current</span> <span m='2983740'>script</span>
  <span m='2984010'>hash</span> <span m='2984760'>you</span> <span m='2984940'>want</span>
  <span m='2985300'>that</span> <span m='2985930'>exact</span> <span m='2986290'>same</span>
  <span m='2986470'>functionality</span> <span m='2987040'>and</span> <span m='2987130'>you</span>
  <span m='2987250'>don't</span> <span m='2987550'>want</span> <span m='2987760'>this</span>
  <span m='2987910'>new</span> <span m='2988060'>functionality,</span> <span m='2988990'>you</span>
  <span m='2989080'>can</span> <span m='2989200'>sort</span> <span m='2989350'>of</span>
  <span m='2989470'>get</span> <span m='2989710'>rid</span> <span m='2989860'>of</span>
  <span m='2989950'>it</span> <span m='2990040'>this</span> <span m='2990220'>way.</span>
  </p><p><span m='2995070'>AUDIENCE:</span> <span m='2995150'>So</span> <span m='2997120'>the</span>
  <span m='2997350'>idea</span> <span m='2997890'>of</span> <span m='2998000'>[INAUDIBLE]</span>
  <span m='2998490'>is</span> <span m='2998670'>that</span> <span m='2999090'>you
  are</span> <span m='2999360'>trying</span> <span m='2999690'>to</span> <span m='3000560'>make</span>
  <span m='3000830'>your</span> <span m='3001790'>special</span> <span m='3003580'>transaction</span>
  <span m='3003950'>scripts</span> <span m='3004340'>not</span> <span m='3004610'>stand</span>
  <span m='3004960'>out</span> <span m='3005110'>[INAUDIBLE].</span> <span m='3005810'>The</span>
  <span m='3005900'>fear</span> <span m='3006260'>is</span> <span m='3006380'>that</span>
  <span m='3007612'>people</span> <span m='3008110'>will</span> <span m='3009040'>see</span>
  <span m='3009400'>those</span> <span m='3009650'>and</span> <span m='3009740'>not</span>
  <span m='3010970'>put</span> <span m='3011120'>them</span> <span m='3011240'>into</span>
  <span m='3011450'>blocks,</span> <span m='3011810'>or</span> <span m='3011900'>not</span>
  <span m='3012090'>[INAUDIBLE]</span> <span m='3012350'>them,</span> <span m='3012510'>or</span>
  <span m='3012860'>discriminate</span> <span m='3013370'>against</span> <span m='3013730'>them?</span>
  </p><p><span m='3014750'>TADGE DRYJA:</span> <span m='3014990'>Maybe</span> <span
  m='3015230'>a</span> <span m='3015290'>little.</span> <span m='3015680'>But</span>
  <span m='3015890'>it's</span> <span m='3016070'>more</span> <span m='3016550'>that--</span>
  <span m='3019310'>let's</span> <span m='3019460'>say</span> <span m='3019610'>I</span>
  <span m='3019670'>have</span> <span m='3019850'>my</span> <span m='3020030'>wallet</span>
  <span m='3020330'>software,</span> <span m='3020870'>and</span> <span m='3020960'>it</span>
  <span m='3021080'>always</span> <span m='3021500'>uses</span> <span m='3021770'>to</span>
  <span m='3022010'>P2WSH,</span> <span m='3022600'>P2SH,</span> <span m='3023990'>or</span>
  <span m='3024080'>something.</span> <span m='3024680'>Then</span> <span m='3024890'>I</span>
  <span m='3024980'>can</span> <span m='3025160'>say,</span> <span m='3025440'>oh,</span>
  <span m='3025490'>I</span> <span m='3025550'>bet</span> <span m='3025790'>this</span>
  <span m='3025970'>is</span> <span m='3026060'>the</span> <span m='3026150'>same</span>
  <span m='3026360'>person.</span> <span m='3027230'>I</span> <span m='3027320'>can</span>
  <span m='3027440'>try</span> <span m='3027620'>to</span> <span m='3027710'>track</span>
  <span m='3028130'>who is</span> <span m='3028490'>spending</span> <span m='3028900'>them.</span>
  </p><p><span m='3029310'>AUDIENCE:</span> <span m='3029515'>[INAUDIBLE].</span>
  </p><p><span m='3029720'>TADGE DRYJA:</span> <span m='3029855'>Yeah,</span> <span
  m='3030920'>a</span> <span m='3030980'>big</span> <span m='3031220'>part</span>
  <span m='3031430'>of</span> <span m='3031490'>it</span> <span m='3031580'>is</span>
  <span m='3031670'>privacy.</span> <span m='3032390'>Maybe</span> <span m='3032960'>they're</span>
  <span m='3034250'>discriminated</span> <span m='3035030'>against</span> <span m='3035270'>them</span>
  <span m='3035740'>like</span> <span m='3035890'>miners.</span> <span m='3036530'>Probably,</span>
  <span m='3036890'>the</span> <span m='3036980'>miners</span> <span m='3037310'>don't</span>
  <span m='3037490'>care.</span> <span m='3038450'>But</span> <span m='3038630'>it's</span>
  <span m='3038750'>more</span> <span m='3039170'>like</span> <span m='3039470'>if</span>
  <span m='3039900'>everyone's</span> <span m='3040340'>using</span> <span m='3041000'>software</span>
  <span m='3041360'>that</span> <span m='3041480'>can</span> <span m='3041690'>create</span>
  <span m='3042020'>similar</span> <span m='3042410'>transactions,</span> <span m='3043650'>then</span>
  <span m='3043670'>it</span> <span m='3043730'>becomes</span> <span m='3043970'>much</span>
  <span m='3044240'>harder</span> <span m='3044570'>to</span> <span m='3044870'>tell</span>
  <span m='3045110'>people</span> <span m='3045380'>apart,</span> <span m='3046580'>and</span>
  <span m='3046730'>it</span> <span m='3046970'>has</span> <span m='3047120'>more</span>
  <span m='3047330'>privacy</span> <span m='3047810'>for</span> <span m='3047930'>the</span>
  <span m='3048020'>transactions.</span> </p><p><span m='3049100'>AUDIENCE:</span>
  <span m='3049220'>Then</span> <span m='3049340'>this</span> <span m='3049610'>one,</span>
  <span m='3050200'>you're</span> <span m='3052680'>putting</span> <span m='3052980'>in</span>
  <span m='3053100'>a</span> <span m='3053160'>script</span> <span m='3053670'>that</span>
  <span m='3053820'>can</span> <span m='3054510'>anybody</span> <span m='3054900'>can</span>
  <span m='3055020'>potentially</span> <span m='3056310'>execute</span> <span m='3056820'>it,</span>
  <span m='3057190'>but</span> <span m='3057430'>they</span> <span m='3057580'>don't</span>
  <span m='3057740'>know</span> <span m='3058000'>that</span> <span m='3058260'>they</span>
  <span m='3058500'>can?</span> </p><p><span m='3061630'>TADGE DRYJA:</span> <span
  m='3061655'>They</span> <span m='3061680'>need</span> <span m='3061860'>to</span>
  <span m='3061950'>know</span> <span m='3062220'>both</span> <span m='3062490'>the</span>
  <span m='3062580'>script</span> <span m='3063090'>and</span> <span m='3063360'>J,</span>
  <span m='3064230'>which</span> <span m='3064650'>is</span> <span m='3064800'>not</span>
  <span m='3065010'>obvious</span> <span m='3065340'>from</span> <span m='3065520'>C.</span>
  <span m='3066550'>C</span> <span m='3066790'>is</span> <span m='3066900'>the</span>
  <span m='3066990'>only</span> <span m='3067200'>thing</span> <span m='3067380'>you</span>
  <span m='3067470'>see</span> <span m='3067620'>on</span> <span m='3067710'>the</span>
  <span m='3067790'>blockchain,</span> <span m='3068250'>in</span> <span m='3068340'>the</span>
  <span m='3068460'>output.</span> <span m='3069870'>And</span> <span m='3069990'>so</span>
  <span m='3070110'>they</span> <span m='3070230'>just</span> <span m='3070440'>said,</span>
  <span m='3070770'>it's</span> <span m='3070980'>a</span> <span m='3071010'>key--</span>
  <span m='3071790'>probably,</span> <span m='3072330'>someone</span> <span m='3072690'>knows</span>
  <span m='3072900'>the</span> <span m='3072990'>private</span> <span m='3073320'>key.</span>
  <span m='3074280'>Maybe</span> <span m='3074820'>there's</span> <span m='3075180'>some</span>
  <span m='3075420'>weird</span> <span m='3075660'>thing</span> <span m='3075840'>like</span>
  <span m='3075990'>this</span> <span m='3076140'>going</span> <span m='3076440'>on.</span>
  <span m='3077230'>You</span> <span m='3077250'>don't</span> <span m='3077370'>have</span>
  <span m='3077580'>to</span> <span m='3077700'>use</span> <span m='3077880'>this,</span>
  <span m='3078120'>right?</span> </p><p><span m='3079740'>And</span> <span m='3079890'>then,</span>
  <span m='3080210'>yeah,</span> <span m='3080420'>so</span> <span m='3080550'>they</span>
  <span m='3080670'>won't</span> <span m='3081000'>know</span> <span m='3081750'>what</span>
  <span m='3082020'>J</span> <span m='3082260'>or</span> <span m='3082380'>z</span>
  <span m='3082590'>are.</span> </p><p><span m='3084051'>AUDIENCE:</span> <span m='3084255'>Still</span>
  <span m='3084460'>you're</span> <span m='3084720'>[INAUDIBLE].</span> </p><p><span
  m='3086400'>TADGE DRYJA:</span> <span m='3086490'>Yeah.</span> <span m='3087030'>You</span>
  <span m='3087180'>can</span> <span m='3088770'>publicly</span> <span m='3089670'>publish</span>
  <span m='3090240'>it,</span> <span m='3090960'>if</span> <span m='3091080'>you</span>
  <span m='3091200'>want--</span> <span m='3092010'>and</span> <span m='3092130'>tell</span>
  <span m='3092310'>everyone</span> <span m='3092610'>in</span> <span m='3092670'>the</span>
  <span m='3092730'>world,</span> <span m='3092970'>hey,</span> <span m='3093690'>this</span>
  <span m='3093910'>C</span> <span m='3094230'>is</span> <span m='3094410'>actually</span>
  <span m='3094890'>this</span> <span m='3095100'>J</span> <span m='3095460'>plus</span>
  <span m='3095760'>this</span> <span m='3095910'>script</span> <span m='3096210'>z.</span>
  <span m='3096810'>They</span> <span m='3096960'>still</span> <span m='3097140'>can't</span>
  <span m='3097350'>spend</span> <span m='3097620'>it.</span> <span m='3098640'>That</span>
  <span m='3098790'>can</span> <span m='3098940'>be</span> <span m='3099090'>public,</span>
  <span m='3100050'>even</span> <span m='3100260'>beforehand.</span> <span m='3101820'>And</span>
  <span m='3101970'>then</span> <span m='3102060'>they</span> <span m='3102150'>see,</span>
  <span m='3102520'>oh,</span> <span m='3102730'>there's</span> <span m='3102810'>a</span>
  <span m='3102870'>script</span> <span m='3103530'>and</span> <span m='3103740'>a</span>
  <span m='3103770'>key.</span> <span m='3104310'>And</span> <span m='3104400'>you</span>
  <span m='3104490'>can</span> <span m='3104610'>also,</span> <span m='3105240'>say,</span>
  <span m='3105540'>sign</span> <span m='3106020'>something,</span> <span m='3106500'>and</span>
  <span m='3106620'>prove</span> <span m='3107040'>that</span> <span m='3107190'>you</span>
  <span m='3107340'>know</span> <span m='3107550'>the</span> <span m='3107640'>private</span>
  <span m='3108000'>key</span> <span m='3108210'>for</span> <span m='3108360'>J.</span>
  <span m='3109750'>So</span> <span m='3109840'>you</span> <span m='3109900'>can</span>
  <span m='3110020'>say,</span> <span m='3111070'>I</span> <span m='3111130'>can</span>
  <span m='3111280'>prove</span> <span m='3111580'>that</span> <span m='3111700'>I'm</span>
  <span m='3111790'>not</span> <span m='3112060'>doing</span> <span m='3112390'>this--</span>
  <span m='3114310'>there</span> <span m='3114490'>is</span> <span m='3114700'>no</span>
  <span m='3114910'>J</span> <span m='3115660'>kind</span> <span m='3115840'>of</span>
  <span m='3115930'>thing.</span> </p><p><span m='3117220'>So</span> <span m='3117310'>you</span>
  <span m='3117370'>can</span> <span m='3117490'>prove</span> <span m='3117700'>all</span>
  <span m='3117820'>those</span> <span m='3117940'>things,</span> <span m='3118390'>but</span>
  <span m='3118540'>you</span> <span m='3118630'>don't</span> <span m='3118780'>need</span>
  <span m='3119020'>to.</span> <span m='3120940'>For</span> <span m='3121090'>normal</span>
  <span m='3121450'>usage,</span> <span m='3121840'>you</span> <span m='3121900'>just</span>
  <span m='3122080'>send</span> <span m='3122400'>a</span> <span m='3122440'>key</span>
  <span m='3122730'>C,</span> <span m='3123580'>spend</span> <span m='3123940'>from</span>
  <span m='3124180'>key</span> <span m='3124495'>C.</span> <span m='3124810'>You're</span>
  <span m='3124930'>done.</span> <span m='3126010'>And</span> <span m='3126130'>if</span>
  <span m='3126250'>you</span> <span m='3126340'>want</span> <span m='3126610'>to</span>
  <span m='3127870'>spend</span> <span m='3128170'>from</span> <span m='3128380'>the</span>
  <span m='3128680'>script</span> <span m='3129000'>z,</span> <span m='3129410'>you</span>
  <span m='3129820'>just</span> <span m='3129970'>provide</span> <span m='3130330'>J,</span>
  <span m='3131010'>the</span> <span m='3131170'>script</span> <span m='3131410'>,</span>
  <span m='3131800'>and</span> <span m='3131890'>then</span> <span m='3132010'>execute</span>
  <span m='3132370'>the</span> <span m='3132460'>script.</span> <span m='3134020'>So</span>
  <span m='3134380'>it's</span> <span m='3134560'>nice.</span> <span m='3134830'>And</span>
  <span m='3136960'>you</span> <span m='3137110'>might</span> <span m='3137320'>have</span>
  <span m='3137440'>had</span> <span m='3137680'>a</span> <span m='3137740'>script,</span>
  <span m='3138460'>and</span> <span m='3138550'>then</span> <span m='3138670'>you</span>
  <span m='3138760'>didn't</span> <span m='3139000'>use</span> <span m='3139180'>it,</span>
  <span m='3139270'>so</span> <span m='3139390'>you</span> <span m='3139450'>didn't</span>
  <span m='3139660'>reveal</span> <span m='3140050'>that</span> <span m='3140170'>there</span>
  <span m='3140290'>was</span> <span m='3140500'>a</span> <span m='3140530'>script.</span>
  </p><p><span m='3143400'>So</span> <span m='3143730'>it</span> <span m='3143910'>helps</span>
  <span m='3144180'>with</span> <span m='3144270'>privacy.</span> <span m='3145230'>It</span>
  <span m='3145350'>helps</span> <span m='3145620'>with</span> <span m='3145770'>efficiency</span>
  <span m='3146310'>in</span> <span m='3146400'>many</span> <span m='3146580'>cases,</span>
  <span m='3146940'>because</span> <span m='3148500'>if</span> <span m='3148650'>you</span>
  <span m='3148740'>don't</span> <span m='3148920'>need</span> <span m='3149310'>to</span>
  <span m='3149430'>use</span> <span m='3149610'>a</span> <span m='3149670'>script,</span>
  <span m='3150040'>you</span> <span m='3150140'>don't</span> <span m='3150150'>have</span>
  <span m='3150360'>to.</span> <span m='3151710'>So</span> <span m='3152430'>in</span>
  <span m='3152550'>a</span> <span m='3152610'>lot</span> <span m='3152760'>of</span>
  <span m='3152850'>cases</span> <span m='3153180'>you</span> <span m='3153240'>say,</span>
  <span m='3155010'>all</span> <span m='3155280'>three</span> <span m='3155730'>of</span>
  <span m='3155850'>the</span> <span m='3155940'>2</span> <span m='3156120'>of</span>
  <span m='3156210'>3</span> <span m='3156390'>multisigs</span> <span m='3156930'>are</span>
  <span m='3157020'>on</span> <span m='3157130'>board,</span> <span m='3157440'>so</span>
  <span m='3157590'>let's</span> <span m='3157800'>use</span> <span m='3157920'>C</span>
  <span m='3158370'>instead</span> <span m='3158670'>of</span> <span m='3158760'>the</span>
  <span m='3158820'>script</span> <span m='3159300'>z.</span> <span m='3163090'>So</span>
  <span m='3163780'>it's</span> <span m='3163900'>pretty</span> <span m='3164050'>cool.</span>
  </p><p><span m='3164810'>OK,</span> <span m='3165040'>so</span> <span m='3165610'>questions</span>
  <span m='3165970'>about</span> <span m='3166120'>this?</span> <span m='3167020'>Go</span>
  <span m='3167210'>to</span> <span m='3167340'>the</span> <span m='3167410'>next</span>
  <span m='3168930'>crazy</span> <span m='3169230'>thing.</span> <span m='3172830'>Little</span>
  <span m='3173160'>notes</span> <span m='3173430'>about</span> <span m='3173610'>taproot--</span>
  <span m='3174060'>anyone</span> <span m='3174480'>can</span> <span m='3174660'>make</span>
  <span m='3174840'>a</span> <span m='3174900'>key</span> <span m='3175230'>and</span>
  <span m='3175410'>script</span> <span m='3175830'>and</span> <span m='3175920'>send</span>
  <span m='3176130'>to</span> <span m='3176280'>it.</span> <span m='3176760'>Only</span>
  <span m='3176970'>the</span> <span m='3177030'>pubkeys</span> <span m='3177360'>are</span>
  <span m='3177420'>needed.</span> <span m='3178410'>So</span> <span m='3178560'>if</span>
  <span m='3178980'>I</span> <span m='3180560'>want</span> <span m='3180830'>to</span>
  <span m='3180950'>send</span> <span m='3181280'>to</span> <span m='3181430'>something</span>
  <span m='3181820'>that's</span> <span m='3182480'>3</span> <span m='3183230'>of</span>
  <span m='3183320'>3--</span> <span m='3183680'>Alice,</span> <span m='3184080'>Bob,</span>
  <span m='3184250'>and</span> <span m='3184340'>Carol</span> <span m='3185240'>added</span>
  <span m='3185510'>all</span> <span m='3185720'>together--</span> <span m='3186530'>or</span>
  <span m='3187220'>2</span> <span m='3187460'>of</span> <span m='3187580'>the</span>
  <span m='3187670'>3</span> <span m='3187940'>of</span> <span m='3188060'>Alice,</span>
  <span m='3188300'>and</span> <span m='3188420'>Bob,</span> <span m='3188600'>and</span>
  <span m='3188690'>Carol--</span> <span m='3190010'>I</span> <span m='3190070'>don't</span>
  <span m='3190220'>have</span> <span m='3190310'>to</span> <span m='3190430'>even</span>
  <span m='3190790'>ask</span> <span m='3191210'>Alice,</span> <span m='3191640'>Bob,</span>
  <span m='3191780'>and</span> <span m='3191870'>Carol.</span> <span m='3192710'>If</span>
  <span m='3192830'>I</span> <span m='3192950'>know</span> <span m='3193130'>they're</span>
  <span m='3193280'>public</span> <span m='3193610'>keys,</span> <span m='3194360'>I</span>
  <span m='3194510'>can</span> <span m='3194660'>just</span> <span m='3194810'>compute</span>
  <span m='3195140'>all</span> <span m='3195260'>this</span> <span m='3195440'>myself,</span>
  <span m='3196400'>and</span> <span m='3197030'>send</span> <span m='3197270'>money</span>
  <span m='3197570'>to</span> <span m='3198270'>them.</span> </p><p><span m='3199790'>And</span>
  <span m='3199910'>I</span> <span m='3199970'>can</span> <span m='3200120'>compute</span>
  <span m='3200480'>any</span> <span m='3200660'>construction</span> <span m='3201080'>I</span>
  <span m='3201140'>want.</span> <span m='3201350'>I</span> <span m='3201440'>can</span>
  <span m='3201590'>make</span> <span m='3201770'>it</span> <span m='3202370'>1</span>
  <span m='3202580'>of</span> <span m='3202670'>3.</span> <span m='3204830'>I</span>
  <span m='3204920'>know</span> <span m='3205040'>Alice,</span> <span m='3205410'>Bob,</span>
  <span m='3205580'>and</span> <span m='3205670'>Carol's</span> <span m='3208380'>public</span>
  <span m='3208810'>keys.</span> <span m='3209520'>And</span> <span m='3209640'>I</span>
  <span m='3209730'>can</span> <span m='3209850'>say,</span> <span m='3210100'>hey</span>
  <span m='3210210'>Alice,</span> <span m='3210550'>Bob,</span> <span m='3210570'>and</span>
  <span m='3210660'>Carol,</span> <span m='3210960'>I'm</span> <span m='3211140'>giving</span>
  <span m='3211440'>you</span> <span m='3211560'>all</span> <span m='3211680'>money,</span>
  <span m='3212040'>and</span> <span m='3212160'>you</span> <span m='3212250'>can</span>
  <span m='3212370'>fight</span> <span m='3212580'>over</span> <span m='3212820'>it--</span>
  <span m='3213510'>or</span> <span m='3213720'>you</span> <span m='3213840'>can</span>
  <span m='3213990'>cooperate.</span> <span m='3214620'>Like,</span> <span m='3215340'>any</span>
  <span m='3215550'>of</span> <span m='3215670'>you</span> <span m='3215760'>get</span>
  <span m='3215910'>it.</span> <span m='3216060'>And</span> <span m='3216150'>so</span>
  <span m='3216270'>the</span> <span m='3216390'>idea</span> <span m='3216570'>is</span>
  <span m='3216690'>1</span> <span m='3217020'>of</span> <span m='3217140'>3</span>
  <span m='3217610'>multisig</span> <span m='3217870'>script</span> <span m='3218430'>goes</span>
  <span m='3218670'>into</span> <span m='3218820'>here,</span> <span m='3219540'>and</span>
  <span m='3219660'>then</span> <span m='3219900'>3</span> <span m='3220260'>of</span>
  <span m='3220350'>3</span> <span m='3220860'>is</span> <span m='3221010'>here.</span>
  <span m='3222250'>So</span> <span m='3222300'>if</span> <span m='3222390'>you</span>
  <span m='3222480'>cooperate,</span> <span m='3223140'>you</span> <span m='3224010'>save</span>
  <span m='3224280'>a</span> <span m='3224310'>little</span> <span m='3224490'>bit</span>
  <span m='3224610'>of</span> <span m='3224670'>space,</span> <span m='3225590'>and</span>
  <span m='3226140'>the</span> <span m='3226230'>fees</span> <span m='3226440'>are</span>
  <span m='3226500'>smaller.</span> </p><p><span m='3227200'>But</span> <span m='3227300'>if</span>
  <span m='3227400'>you</span> <span m='3227500'>don't</span> <span m='3227600'>cooperate,</span>
  <span m='3227880'>any</span> <span m='3228060'>of</span> <span m='3228180'>you</span>
  <span m='3228300'>can</span> <span m='3228900'>grab</span> <span m='3229110'>it</span>
  <span m='3229200'>immediately.</span> <span m='3230310'>I</span> <span m='3230370'>don't</span>
  <span m='3230490'>know</span> <span m='3230580'>how</span> <span m='3230700'>useful</span>
  <span m='3230970'>that</span> <span m='3231120'>is,</span> <span m='3231330'>but</span>
  <span m='3231570'>you</span> <span m='3231690'>could</span> <span m='3231840'>do</span>
  <span m='3232020'>this.</span> <span m='3232500'>You</span> <span m='3232860'>don't</span>
  <span m='3233280'>need</span> <span m='3233730'>knowledge</span> <span m='3234240'>of</span>
  <span m='3234360'>any</span> <span m='3234540'>private</span> <span m='3234930'>keys</span>
  <span m='3235290'>to</span> <span m='3235380'>construct</span> <span m='3236630'>C.</span>
  <span m='3239410'>Only</span> <span m='3239620'>the</span> <span m='3239720'>pubkeys</span>
  <span m='3239980'>are</span> <span m='3240040'>needed.</span> <span m='3240520'>That's</span>
  <span m='3240760'>actually</span> <span m='3241030'>really</span> <span m='3241180'>nice,</span>
  <span m='3241960'>because</span> <span m='3243750'>you're</span> <span m='3243900'>creating.</span>
  <span m='3244560'>So</span> <span m='3245220'>the</span> <span m='3245340'>same</span>
  <span m='3245580'>is</span> <span m='3245700'>currently</span> <span m='3246270'>the</span>
  <span m='3246360'>case</span> <span m='3246780'>in</span> <span m='3246900'>Bitcoin.</span>
  <span m='3247770'>If</span> <span m='3247920'>you're</span> <span m='3248220'>creating</span>
  <span m='3248640'>an</span> <span m='3248730'>output</span> <span m='3249090'>script,</span>
  <span m='3249420'>like</span> <span m='3249600'>pay</span> <span m='3249740'>to</span>
  <span m='3249840'>pubkey</span> <span m='3250170'>hash,</span> <span m='3250750'>pay</span>
  <span m='3250940'>to</span> <span m='3251010'>script</span> <span m='3251280'>hash,</span>
  <span m='3252150'>there's</span> <span m='3252390'>no</span> <span m='3252570'>private</span>
  <span m='3252900'>keys</span> <span m='3253140'>involved</span> <span m='3253500'>in</span>
  <span m='3253560'>that</span> <span m='3253710'>process.</span> <span m='3255060'>You</span>
  <span m='3255120'>just</span> <span m='3255270'>tell</span> <span m='3255450'>everyone.</span>
  </p><p><span m='3256410'>OK,</span> <span m='3256710'>which</span> <span m='3257070'>differs,</span>
  <span m='3258180'>and</span> <span m='3258300'>is</span> <span m='3258480'>the</span>
  <span m='3258600'>important</span> <span m='3259020'>distinction</span> <span m='3259500'>between</span>
  <span m='3259920'>the</span> <span m='3260010'>next</span> <span m='3260250'>cool</span>
  <span m='3260430'>thing,</span> <span m='3260760'>which</span> <span m='3261000'>is</span>
  <span m='3261930'>graftroot--</span> <span m='3263220'>also</span> <span m='3263730'>Greg</span>
  <span m='3264630'>Maxwell,</span> <span m='3265980'>like</span> <span m='3266190'>a</span>
  <span m='3266250'>week</span> <span m='3266460'>or</span> <span m='3266520'>two</span>
  <span m='3266700'>after</span> <span m='3266950'>taproot.</span> <span m='3268530'>They're</span>
  <span m='3268710'>not</span> <span m='3268860'>actually</span> <span m='3269100'>that</span>
  <span m='3269370'>similar.</span> <span m='3269730'>But</span> <span m='3269850'>it</span>
  <span m='3269910'>was</span> <span m='3270000'>like,</span> <span m='3270150'>wait--</span>
  <span m='3271170'>people</span> <span m='3271440'>were</span> <span m='3271500'>sort</span>
  <span m='3271650'>of</span> <span m='3271710'>talking</span> <span m='3271920'>about</span>
  <span m='3272070'>it.</span> </p><p><span m='3273040'>So</span> <span m='3273140'>the</span>
  <span m='3273150'>idea</span> <span m='3273310'>is</span> <span m='3273420'>allow</span>
  <span m='3273780'>a</span> <span m='3273900'>lot</span> <span m='3274260'>of</span>
  <span m='3274350'>scripts</span> <span m='3275610'>with</span> <span m='3276030'>a</span>
  <span m='3276690'>proof</span> <span m='3277200'>that</span> <span m='3278250'>goes</span>
  <span m='3278610'>up</span> <span m='3278730'>in</span> <span m='3278820'>size</span>
  <span m='3279180'>with</span> <span m='3279445'>0</span> <span m='3279710'>of</span>
  <span m='3279970'>1--</span> <span m='3280360'>aka</span> <span m='3280790'>it</span>
  <span m='3280920'>doesn't</span> <span m='3281220'>go</span> <span m='3281370'>up</span>
  <span m='3281520'>in</span> <span m='3281610'>size.</span> <span m='3282510'>So</span>
  <span m='3282870'>the</span> <span m='3282960'>Merkle</span> <span m='3283290'>proofs--</span>
  <span m='3283680'>the</span> <span m='3283990'>MAST--</span> <span m='3284850'>go</span>
  <span m='3285270'>in</span> <span m='3285450'>log</span> <span m='3285720'>n.</span>
  <span m='3286140'>So</span> <span m='3286290'>if</span> <span m='3286380'>you've</span>
  <span m='3286620'>got</span> <span m='3287400'>a</span> <span m='3287460'>million</span>
  <span m='3288480'>different</span> <span m='3288840'>scripts,</span> <span m='3290660'>you're</span>
  <span m='3290780'>going</span> <span m='3290870'>to</span> <span m='3290990'>take</span>
  <span m='3292280'>something</span> <span m='3292610'>like</span> <span m='3292790'>20</span>
  <span m='3293120'>hashes</span> <span m='3293600'>or</span> <span m='3293660'>whatever</span>
  <span m='3293930'>to</span> <span m='3294020'>prove</span> <span m='3294230'>that.</span>
  <span m='3295730'>What's</span> <span m='3296000'>a</span> <span m='3296060'>proof</span>
  <span m='3296630'>that</span> <span m='3297260'>grows</span> <span m='3297680'>in</span>
  <span m='3297860'>0 of</span> <span m='3298160'>1</span> <span m='3298760'>of</span>
  <span m='3298880'>the</span> <span m='3298970'>number</span> <span m='3299240'>of</span>
  <span m='3299330'>things</span> <span m='3299600'>being</span> <span m='3299840'>proven?</span>
  <span m='3303210'>It's</span> <span m='3303360'>actually</span> <span m='3303630'>not--</span>
  <span m='3304230'>it's</span> <span m='3304410'>kind</span> <span m='3304590'>of</span>
  <span m='3304650'>obvious.</span> </p><p><span m='3306660'>Like,</span> <span m='3306870'>I</span>
  <span m='3306930'>want</span> <span m='3307080'>to</span> <span m='3307140'>prove</span>
  <span m='3308340'>something,</span> <span m='3310970'>and</span> <span m='3312170'>the</span>
  <span m='3312260'>proof</span> <span m='3312560'>size</span> <span m='3313460'>does</span>
  <span m='3313670'>not</span> <span m='3313850'>change</span> <span m='3314390'>regardless</span>
  <span m='3314840'>of</span> <span m='3314930'>how</span> <span m='3315080'>many</span>
  <span m='3315290'>things</span> <span m='3315980'>I</span> <span m='3316150'>am</span>
  <span m='3316280'>proving.</span> <span m='3317400'>Well,</span> <span m='3317480'>it's</span>
  <span m='3317570'>just</span> <span m='3317720'>a</span> <span m='3317750'>signature.</span>
  <span m='3319340'>If</span> <span m='3319430'>I</span> <span m='3319520'>make</span>
  <span m='3319700'>a</span> <span m='3319730'>million</span> <span m='3320000'>signatures,</span>
  <span m='3320450'>they're</span> <span m='3320570'>all</span> <span m='3320660'>the</span>
  <span m='3320750'>same</span> <span m='3320930'>size.</span> <span m='3321990'>So</span>
  <span m='3322070'>I</span> <span m='3322170'>could,</span> <span m='3322550'>instead</span>
  <span m='3322760'>of</span> <span m='3323420'>making</span> <span m='3323750'>a</span>
  <span m='3323790'>Merkle</span> <span m='3324080'>route,</span> <span m='3324740'>I</span>
  <span m='3324860'>just</span> <span m='3325070'>have</span> <span m='3325580'>all</span>
  <span m='3325790'>these</span> <span m='3326000'>little</span> <span m='3326240'>leaves.</span>
  <span m='3326810'>And</span> <span m='3326900'>I</span> <span m='3326960'>just sign</span>
  <span m='3327290'>them</span> <span m='3327380'>all.</span> <span m='3328160'>And</span>
  <span m='3328580'>a</span> <span m='3328670'>leaf</span> <span m='3329000'>with</span>
  <span m='3329150'>a</span> <span m='3329210'>signature</span> <span m='3330440'>is</span>
  <span m='3330740'>just</span> <span m='3330950'>as</span> <span m='3331040'>good.</span>
  </p><p><span m='3333720'>So</span> <span m='3333840'>the</span> <span m='3333930'>idea</span>
  <span m='3334170'>is</span> <span m='3334580'>this</span> <span m='3334720'>is</span>
  <span m='3334800'>called</span> <span m='3334980'>graftroot.</span> <span m='3336750'>It's</span>
  <span m='3336930'>similar</span> <span m='3337470'>to</span> <span m='3337590'>taproot</span>
  <span m='3338520'>in</span> <span m='3338850'>that</span> <span m='3340410'>it's</span>
  <span m='3340620'>got</span> <span m='3340830'>sort</span> <span m='3340980'>of</span>
  <span m='3341100'>two</span> <span m='3341700'>execution</span> <span m='3342240'>paths.</span>
  <span m='3343320'>You</span> <span m='3343470'>send</span> <span m='3343710'>to</span>
  <span m='3343860'>a</span> <span m='3343920'>key</span> <span m='3344150'>C,</span>
  <span m='3344910'>and</span> <span m='3345120'>there's</span> <span m='3345300'>two</span>
  <span m='3345510'>ways</span> <span m='3345840'>to</span> <span m='3345930'>spend</span>
  <span m='3346230'>from</span> <span m='3346440'>it.</span> <span m='3347310'>So</span>
  <span m='3347490'>you</span> <span m='3347580'>can</span> <span m='3347730'>use</span>
  <span m='3347910'>the</span> <span m='3347970'>regular</span> <span m='3348870'>pay</span>
  <span m='3349030'>to</span> <span m='3349160'>pubkey</span> <span m='3349470'>hash</span>
  <span m='3349830'>mode,</span> <span m='3350400'>where</span> <span m='3350610'>you're</span>
  <span m='3350730'>just</span> <span m='3350940'>spending</span> <span m='3351360'>from</span>
  <span m='3351540'>C.</span> <span m='3351810'>You</span> <span m='3351960'>just</span>
  <span m='3352290'>sign</span> <span m='3352770'>with</span> <span m='3353040'>key</span>
  <span m='3353290'>C,</span> <span m='3354240'>your</span> <span m='3354330'>transaction--</span>
  <span m='3355650'>same</span> <span m='3355950'>as</span> <span m='3356070'>in</span>
  <span m='3356160'>taproot,</span> <span m='3356580'>same</span> <span m='3356850'>as</span>
  <span m='3356970'>in</span> <span m='3357210'>regular</span> <span m='3357660'>Bitcoin</span>
  <span m='3358050'>right</span> <span m='3358260'>now.</span> <span m='3359280'>That's</span>
  <span m='3359460'>the</span> <span m='3359520'>easy</span> <span m='3359730'>one.</span>
  </p><p><span m='3360550'>The</span> <span m='3360570'>script</span> <span m='3361050'>version</span>
  <span m='3361650'>is</span> <span m='3362250'>I</span> <span m='3362340'>show</span>
  <span m='3362580'>a</span> <span m='3362640'>script</span> <span m='3363000'>s,</span>
  <span m='3364080'>and</span> <span m='3364290'>a</span> <span m='3364440'>signature</span>
  <span m='3365190'>from</span> <span m='3365700'>key</span> <span m='3366030'>C</span>
  <span m='3366780'>on</span> <span m='3367530'>the</span> <span m='3367620'>message</span>
  <span m='3368040'>s,</span> <span m='3369090'>and</span> <span m='3369240'>then</span>
  <span m='3369390'>I</span> <span m='3369480'>execute</span> <span m='3369870'>that</span>
  <span m='3370020'>script.</span> <span m='3372530'>So</span> <span m='3372580'>this</span>
  <span m='3372730'>is</span> <span m='3372850'>kind</span> <span m='3373030'>of</span>
  <span m='3374020'>cool,</span> <span m='3374500'>right?</span> <span m='3374830'>You</span>
  <span m='3375010'>say,</span> <span m='3375350'>look,</span> <span m='3376010'>I'm</span>
  <span m='3376120'>sending</span> <span m='3376450'>you</span> <span m='3376600'>a</span>
  <span m='3376660'>key,</span> <span m='3377080'>and</span> <span m='3377350'>either</span>
  <span m='3378190'>that</span> <span m='3378400'>key</span> <span m='3378610'>itself</span>
  <span m='3378910'>signs</span> <span m='3379900'>or</span> <span m='3380080'>that</span>
  <span m='3380230'>key</span> <span m='3380680'>endorses</span> <span m='3381460'>a</span>
  <span m='3381550'>script</span> <span m='3382450'>to</span> <span m='3382840'>be</span>
  <span m='3382960'>executed.</span> <span m='3386370'>And</span> <span m='3386420'>I</span>
  <span m='3386510'>can</span> <span m='3386630'>make</span> <span m='3386990'>as</span>
  <span m='3387110'>many</span> <span m='3387380'>of</span> <span m='3387440'>these</span>
  <span m='3387650'>as</span> <span m='3387740'>I</span> <span m='3387830'>want.</span>
  <span m='3389030'>So</span> <span m='3389210'>if</span> <span m='3389330'>I</span>
  <span m='3389420'>want</span> <span m='3390380'>1,000</span> <span m='3391070'>different</span>
  <span m='3391970'>scripts,</span> <span m='3392900'>it's</span> <span m='3393080'>not</span>
  <span m='3393290'>like</span> <span m='3393470'>I</span> <span m='3393560'>have</span>
  <span m='3393710'>to</span> <span m='3393800'>prove</span> <span m='3394280'>inclusion</span>
  <span m='3394730'>in</span> <span m='3394830'>the</span> <span m='3394930'>three--</span>
  <span m='3395870'>that's</span> <span m='3396080'>going</span> <span m='3396180'>to</span>
  <span m='3396290'>be</span> <span m='3396410'>height</span> <span m='3396690'>22,</span>
  <span m='3397340'>or</span> <span m='3397820'>height</span> <span m='3398060'>12,</span>
  <span m='3398390'>or</span> <span m='3398450'>whatever--</span> <span m='3399260'>I</span>
  <span m='3399380'>just</span> <span m='3399590'>have</span> <span m='3399860'>a</span>
  <span m='3399890'>signature,</span> <span m='3400310'>saying,</span> <span m='3400580'>OK,</span>
  <span m='3401810'>key</span> <span m='3402215'>C</span> <span m='3402620'>signed</span>
  <span m='3403550'>this</span> <span m='3403910'>to</span> <span m='3404090'>a</span>
  <span m='3404210'>50</span> <span m='3404600'>multisig.</span> <span m='3404900'>Key</span>
  <span m='3405110'>C</span> <span m='3405590'>also</span> <span m='3405830'>signed</span>
  <span m='3407710'>the</span> <span m='3407780'>other</span> <span m='3407990'>two</span>
  <span m='3408140'>of</span> <span m='3408200'>50</span> <span m='3408440'>multisig.</span>
  </p><p><span m='3409730'>So</span> <span m='3410090'>the</span> <span m='3410210'>one</span>
  <span m='3410540'>that</span> <span m='3410690'>I'm</span> <span m='3410840'>actually</span>
  <span m='3411110'>using,</span> <span m='3411770'>I</span> <span m='3411860'>just</span>
  <span m='3412040'>provide</span> <span m='3412340'>the</span> <span m='3412430'>proof.</span>
  <span m='3413390'>The</span> <span m='3413480'>proof</span> <span m='3413720'>of</span>
  <span m='3413810'>inclusion</span> <span m='3414260'>is</span> <span m='3414380'>just</span>
  <span m='3414530'>a</span> <span m='3414590'>signature.</span> <span m='3416640'>Questions</span>
  <span m='3416910'>about</span> <span m='3417060'>this?</span> <span m='3417700'>Makes</span>
  <span m='3417900'>sense?</span> <span m='3418890'>Kind</span> <span m='3419070'>of</span>
  <span m='3419160'>weird?</span> </p><p><span m='3422180'>It</span> <span m='3422270'>works.</span>
  <span m='3426990'>The</span> <span m='3427110'>real</span> <span m='3427350'>problem</span>
  <span m='3427680'>is</span> <span m='3428340'>there</span> <span m='3428640'>is</span>
  <span m='3428940'>this</span> <span m='3429240'>key</span> <span m='3429570'>C,</span>
  <span m='3431340'>right?</span> <span m='3431880'>So</span> <span m='3432150'>there's</span>
  <span m='3432390'>this</span> <span m='3432570'>sort</span> <span m='3432810'>of</span>
  <span m='3432960'>root</span> <span m='3433440'>key</span> <span m='3434670'>that</span>
  <span m='3435270'>controls</span> <span m='3435840'>the</span> <span m='3435930'>whole</span>
  <span m='3436110'>thing.</span> <span m='3438700'>The</span> <span m='3438930'>idea</span>
  <span m='3439170'>is</span> <span m='3439500'>key</span> <span m='3439710'>C</span>
  <span m='3440520'>endorses</span> <span m='3441300'>all</span> <span m='3441630'>the</span>
  <span m='3441720'>different</span> <span m='3442410'>leaves.</span> <span m='3442980'>So</span>
  <span m='3443730'>in</span> <span m='3443850'>the</span> <span m='3443910'>case</span>
  <span m='3444120'>of</span> <span m='3444180'>MAST</span> <span m='3445080'>you've</span>
  <span m='3445230'>got,</span> <span m='3445830'>let's</span> <span m='3446010'>say,</span>
  <span m='3446250'>four</span> <span m='3446490'>different</span> <span m='3446790'>scripts</span>
  <span m='3447180'>that</span> <span m='3447300'>can</span> <span m='3447450'>execute.</span>
  <span m='3448950'>All</span> <span m='3449220'>four</span> <span m='3449580'>of</span>
  <span m='3449730'>those</span> <span m='3451110'>are</span> <span m='3451200'>committed</span>
  <span m='3451590'>to</span> <span m='3451830'>by</span> <span m='3452010'>the</span>
  <span m='3452100'>Merkle</span> <span m='3452390'>root.</span> </p><p><span m='3453180'>In</span>
  <span m='3453270'>the</span> <span m='3453360'>case</span> <span m='3453600'>of</span>
  <span m='3453720'>graftroot,</span> <span m='3454560'>let's</span> <span m='3454740'>say</span>
  <span m='3454860'>you</span> <span m='3454910'>have</span> <span m='3454970'>four</span>
  <span m='3455160'>different</span> <span m='3455430'>scripts.</span> <span m='3456330'>C</span>
  <span m='3456840'>signs</span> <span m='3457860'>all</span> <span m='3458040'>four</span>
  <span m='3458280'>of</span> <span m='3458370'>those</span> <span m='3458550'>different</span>
  <span m='3458820'>scripts.</span> <span m='3460080'>The</span> <span m='3460170'>thing</span>
  <span m='3460350'>is,</span> <span m='3460500'>C</span> <span m='3460870'>can</span>
  <span m='3460970'>sign</span> <span m='3461520'>10</span> <span m='3461730'>scripts.</span>
  <span m='3461970'>C has</span> <span m='3462300'>got</span> <span m='3462570'>total</span>
  <span m='3462960'>control</span> <span m='3463650'>over</span> <span m='3463890'>this</span>
  <span m='3464070'>output.</span> <span m='3465030'>Whereas</span> <span m='3465390'>before,</span>
  <span m='3466350'>in</span> <span m='3466470'>the</span> <span m='3467280'>MAST</span>
  <span m='3467610'>idea,</span> <span m='3469860'>it</span> <span m='3469950'>can</span>
  <span m='3470070'>be</span> <span m='3470160'>different</span> <span m='3470460'>people.</span>
  <span m='3471120'>It</span> <span m='3471210'>could</span> <span m='3471300'>be</span>
  <span m='3472000'>Alice</span> <span m='3472100'>and</span> <span m='3472500'>Bob,</span>
  <span m='3473310'>Carol</span> <span m='3473730'>and</span> <span m='3473820'>Dave,</span>
  <span m='3474750'>Edna</span> <span m='3475200'>and</span> <span m='3475860'>Gertrude--</span>
  <span m='3476310'>I</span> <span m='3476340'>don't</span> <span m='3476460'>know.</span>
  <span m='3477660'>And</span> <span m='3477780'>they</span> <span m='3477930'>might</span>
  <span m='3478140'>not</span> <span m='3478290'>be</span> <span m='3478410'>friends.</span>
  <span m='3479460'>No</span> <span m='3479760'>single</span> <span m='3480240'>entity</span>
  <span m='3480570'>there</span> <span m='3480810'>has</span> <span m='3481020'>full</span>
  <span m='3481200'>control.</span> </p><p><span m='3482080'>So</span> <span m='3482310'>the</span>
  <span m='3482400'>idea</span> <span m='3482730'>of</span> <span m='3483240'>this</span>
  <span m='3483660'>is,</span> <span m='3484320'>well,</span> <span m='3484800'>you</span>
  <span m='3484920'>can</span> <span m='3485100'>combine</span> <span m='3485640'>a</span>
  <span m='3485670'>whole</span> <span m='3485880'>bunch</span> <span m='3486150'>of</span>
  <span m='3486210'>people.</span> <span m='3487110'>The</span> <span m='3487230'>key</span>
  <span m='3487500'>C</span> <span m='3487860'>is</span> <span m='3488010'>essentially</span>
  <span m='3488670'>everyone,</span> <span m='3490050'>and</span> <span m='3490170'>they</span>
  <span m='3490320'>all</span> <span m='3490620'>have</span> <span m='3490830'>to</span>
  <span m='3490920'>sign</span> <span m='3491280'>off</span> <span m='3491940'>on</span>
  <span m='3492060'>all</span> <span m='3492180'>the</span> <span m='3492270'>different</span>
  <span m='3492570'>scripts</span> <span m='3493230'>that</span> <span m='3493380'>could</span>
  <span m='3493530'>happen,</span> <span m='3496640'>and</span> <span m='3496850'>then</span>
  <span m='3497360'>distribute</span> <span m='3497840'>those</span> <span m='3498120'>signatures</span>
  <span m='3498680'>on</span> <span m='3498800'>those</span> <span m='3498950'>scripts,</span>
  <span m='3499250'>which</span> <span m='3499370'>are</span> <span m='3499430'>proofs.</span>
  </p><p><span m='3502070'>OK,</span> <span m='3503840'>basic</span> <span m='3504170'>idea</span>
  <span m='3504350'>make</span> <span m='3504530'>sense?</span> <span m='3506870'>This</span>
  <span m='3507000'>one's</span> <span m='3507740'>a</span> <span m='3507800'>little</span>
  <span m='3508040'>weirder.</span> <span m='3513740'>In</span> <span m='3513890'>this</span>
  <span m='3514160'>one</span> <span m='3516140'>there</span> <span m='3516310'>is</span>
  <span m='3516470'>a</span> <span m='3516530'>way</span> <span m='3516890'>to</span>
  <span m='3517040'>prove</span> <span m='3517850'>that</span> <span m='3518030'>there</span>
  <span m='3518210'>is</span> <span m='3518540'>no</span> <span m='3519420'>key</span>
  <span m='3519780'>C.</span> <span m='3520280'>So</span> <span m='3520430'>that's</span>
  <span m='3520610'>to</span> <span m='3520670'>sort</span> <span m='3520850'>of</span>
  <span m='3520910'>say,</span> <span m='3521190'>look,</span> <span m='3521970'>it's</span>
  <span m='3522080'>only</span> <span m='3522410'>going</span> <span m='3522490'>to</span>
  <span m='3522620'>be</span> <span m='3522740'>this</span> <span m='3522890'>script,</span>
  <span m='3524060'>and</span> <span m='3525020'>no</span> <span m='3525290'>one's</span>
  <span m='3525530'>going</span> <span m='3525690'>to</span> <span m='3525800'>sign</span>
  <span m='3526190'>in</span> <span m='3526310'>the</span> <span m='3526400'>normal</span>
  <span m='3527000'>just</span> <span m='3527240'>the</span> <span m='3527300'>key</span>
  <span m='3527480'>signs</span> <span m='3527880'>method.</span> </p><p><span m='3528810'>There's</span>
  <span m='3529100'>also</span> <span m='3529700'>a</span> <span m='3529790'>way</span>
  <span m='3530150'>to</span> <span m='3530360'>do</span> <span m='3530720'>that</span>
  <span m='3531130'>here.</span> <span m='3532370'>It's</span> <span m='3532550'>much</span>
  <span m='3532790'>less</span> <span m='3533000'>useful,</span> <span m='3533360'>though,</span>
  <span m='3533510'>because</span> <span m='3534200'>what</span> <span m='3534410'>you</span>
  <span m='3534530'>essentially</span> <span m='3534920'>do</span> <span m='3535070'>is</span>
  <span m='3535190'>you</span> <span m='3536720'>start</span> <span m='3537260'>with</span>
  <span m='3537470'>your</span> <span m='3537590'>script,</span> <span m='3539470'>and</span>
  <span m='3539590'>then</span> <span m='3539710'>you</span> <span m='3539800'>compute</span>
  <span m='3540640'>a</span> <span m='3541690'>signature</span> <span m='3542410'>on</span>
  <span m='3542530'>it--</span> <span m='3543040'>but</span> <span m='3543220'>you</span>
  <span m='3543340'>also</span> <span m='3543580'>prove</span> <span m='3544060'>that</span>
  <span m='3544180'>there</span> <span m='3544330'>was</span> <span m='3544630'>no</span>
  <span m='3544810'>private</span> <span m='3545200'>key</span> <span m='3545710'>that</span>
  <span m='3545860'>made</span> <span m='3546070'>the</span> <span m='3546160'>signature.</span>
  <span m='3548260'>You</span> <span m='3548600'>have</span> <span m='3548900'>time.</span>
  <span m='3549340'>It's</span> <span m='3549640'>actually</span> <span m='3549850'>really</span>
  <span m='3550000'>fun.</span> </p><p><span m='3550630'>What</span> <span m='3550750'>you</span>
  <span m='3550840'>do</span> <span m='3552040'>is--</span> <span m='3552790'>normally</span>
  <span m='3553210'>you</span> <span m='3553330'>say,</span> <span m='3553720'>OK,</span>
  <span m='3554800'>S</span> <span m='3555130'>equals</span> <span m='3556750'>k</span>
  <span m='3557260'>minus</span> <span m='3557740'>the</span> <span m='3557860'>hash</span>
  <span m='3558460'>of</span> <span m='3558820'>my</span> <span m='3558970'>message</span>
  <span m='3560090'>and</span> <span m='3560350'>R</span> <span m='3560680'>times</span>
  <span m='3561100'>point</span> <span m='3561490'>a.</span> <span m='3562810'>What</span>
  <span m='3562990'>if</span> <span m='3563140'>I</span> <span m='3563290'>want</span>
  <span m='3563500'>to</span> <span m='3563590'>prove</span> <span m='3563890'>to</span>
  <span m='3564010'>you</span> <span m='3564340'>that</span> <span m='3564550'>there</span>
  <span m='3565540'>is</span> <span m='3565810'>no</span> <span m='3566050'>a?</span>
  <span m='3570010'>SG</span> <span m='3570900'>equals</span> <span m='3571620'>R</span>
  <span m='3572190'>minus</span> <span m='3572730'>the</span> <span m='3572850'>hash</span>
  <span m='3573300'>of</span> <span m='3573690'>message</span> <span m='3574560'>R</span>
  <span m='3575490'>times</span> <span m='3575880'>pubkey</span> <span m='3576170'>A.</span>
  <span m='3576930'>I</span> <span m='3577080'>want</span> <span m='3577320'>to</span>
  <span m='3577410'>prove</span> <span m='3577770'>that</span> <span m='3578430'>I</span>
  <span m='3578520'>do</span> <span m='3578640'>not</span> <span m='3578940'>know</span>
  <span m='3579390'>that</span> <span m='3579600'>private</span> <span m='3579960'>key,</span>
  <span m='3580380'>and</span> <span m='3580470'>nobody</span> <span m='3580800'>knows</span>
  <span m='3581010'>it.</span> </p><p></p><p><span m='3583065'>Actually,</span> <span
  m='3583380'>I</span> <span m='3584320'>have</span> <span m='3584680'>to</span> <span
  m='3585060'>both.</span> <span m='3586080'>I</span> <span m='3586620'>say,</span>
  <span m='3586920'>OK,</span> <span m='3587190'>I</span> <span m='3587340'>know</span>
  <span m='3587670'>the</span> <span m='3587760'>pre-image</span> <span m='3588120'>of
  the</span> <span m='3588480'>x-coordinate.</span> <span m='3591960'>Same</span>
  <span m='3592350'>with</span> <span m='3592560'>R.</span> <span m='3596750'>Wait,</span>
  <span m='3596890'>can I</span> <span m='3597100'>do</span> <span m='3597220'>this?</span>
  <span m='3598140'>I</span> <span m='3598610'>forget how</span> <span m='3599080'>this</span>
  <span m='3599200'>is</span> <span m='3599290'>going</span> <span m='3599360'>to</span>
  <span m='3599430'>work.</span> </p><p><span m='3599800'>Anyway,</span> <span m='3600190'>basically</span>
  <span m='3600550'>what</span> <span m='3600670'>I</span> <span m='3600730'>do</span>
  <span m='3600880'>is</span> <span m='3601030'>I</span> <span m='3601150'>compute</span>
  <span m='3602020'>A</span> <span m='3602860'>public</span> <span m='3603190'>key</span>
  <span m='3604180'>randomly.</span> <span m='3605050'>Or</span> <span m='3605140'>no,</span>
  <span m='3605420'>I</span> <span m='3605830'>first</span> <span m='3606100'>get</span>
  <span m='3606250'>the</span> <span m='3606310'>message</span> <span m='3606640'>I</span>
  <span m='3606700'>want</span> <span m='3606820'>to</span> <span m='3606880'>sign.</span>
  <span m='3607960'>I</span> <span m='3608050'>make</span> <span m='3608230'>a</span>
  <span m='3608290'>random</span> <span m='3609030'>R,</span> <span m='3611170'>and</span>
  <span m='3611260'>I</span> <span m='3611350'>show</span> <span m='3611710'>that</span>
  <span m='3612040'>it's</span> <span m='3612520'>random--</span> <span m='3613150'>I</span>
  <span m='3613210'>know</span> <span m='3613630'>the</span> <span m='3613720'>pre-image</span>
  <span m='3614290'>of</span> <span m='3614440'>its</span> <span m='3615010'>coordinates,</span>
  <span m='3615490'>or</span> <span m='3615550'>something.</span> <span m='3615850'>I</span>
  <span m='3615910'>can</span> <span m='3616030'>prove</span> <span m='3616420'>that</span>
  <span m='3616570'>I</span> <span m='3616630'>didn't</span> <span m='3617200'>construct</span>
  <span m='3617680'>this.</span> <span m='3618220'>I</span> <span m='3618310'>don't</span>
  <span m='3618520'>know</span> <span m='3618610'>the</span> <span m='3618670'>private</span>
  <span m='3618940'>key.</span> <span m='3621010'>And</span> <span m='3621130'>then</span>
  <span m='3621250'>I</span> <span m='3621670'>solve</span> <span m='3622420'>for</span>
  <span m='3622810'>A</span> <span m='3623200'>and</span> <span m='3623500'>S,</span>
  <span m='3624280'>essentially.</span> </p><p><span m='3626400'>So</span> <span m='3626480'>I</span>
  <span m='3626540'>can</span> <span m='3626690'>show,</span> <span m='3626900'>look,</span>
  <span m='3627140'>I've</span> <span m='3627260'>got</span> <span m='3627440'>a</span>
  <span m='3627500'>signature,</span> <span m='3628310'>but</span> <span m='3628460'>I</span>
  <span m='3628520'>can</span> <span m='3628640'>prove</span> <span m='3629060'>that</span>
  <span m='3629390'>no</span> <span m='3629540'>one</span> <span m='3629720'>signed.</span>
  <span m='3633110'>I</span> <span m='3633200'>think</span> <span m='3633350'>I</span>
  <span m='3633450'>make</span> <span m='3633650'>a</span> <span m='3633710'>random</span>
  <span m='3634160'>s,</span> <span m='3635770'>and</span> <span m='3635870'>then</span>
  <span m='3635990'>I</span> <span m='3636080'>solve</span> <span m='3636500'>for</span>
  <span m='3639380'>big</span> <span m='3639610'>A.</span> <span m='3642205'>I</span>
  <span m='3642650'>make</span> <span m='3642770'>a</span> <span m='3642830'>random</span>
  <span m='3643100'>s,</span> <span m='3643450'>multiply</span> <span m='3643910'>by</span>
  <span m='3644090'>G,</span> <span m='3644740'>solve</span> <span m='3645080'>for
  A.</span> </p><p><span m='3645560'>So</span> <span m='3645920'>A</span> <span m='3647480'>divided</span>
  <span m='3648020'>by</span> <span m='3648320'>hash</span> <span m='3648770'>of</span>
  <span m='3649405'>m,</span> <span m='3649860'>R--</span> <span m='3651410'>wait,</span>
  <span m='3651590'>I</span> <span m='3651680'>can't</span> <span m='3651890'>do</span>
  <span m='3652010'>that,</span> <span m='3652533'>can</span> <span m='3652936'>I?</span>
  <span m='3653340'>Yeah,</span> <span m='3653460'>I</span> <span m='3653940'>can.</span>
  <span m='3654050'>This</span> <span m='3654140'>is</span> <span m='3654390'>[INAUDIBLE.]</span>
  <span m='3663520'>Equals</span> <span m='3663940'>R</span> <span m='3664270'>minus</span>
  <span m='3665020'>SG.</span> <span m='3667160'>I</span> <span m='3667250'>come</span>
  <span m='3667490'>up</span> <span m='3667610'>with</span> <span m='3667700'>a</span>
  <span m='3667730'>random</span> <span m='3668030'>R,</span> <span m='3668690'>put</span>
  <span m='3668870'>it</span> <span m='3668960'>in</span> <span m='3669050'>here,</span>
  <span m='3669980'>come</span> <span m='3670160'>up</span> <span m='3670250'>with</span>
  <span m='3670350'>the</span> <span m='3670400'>message</span> <span m='3670700'>I</span>
  <span m='3670760'>want</span> <span m='3670910'>to</span> <span m='3670970'>sign,</span>
  <span m='3673980'>and</span> <span m='3674220'>then</span> <span m='3674430'>solve</span>
  <span m='3674700'>for</span> <span m='3674910'>A.</span> <span m='3677070'>So</span>
  <span m='3677160'>I</span> <span m='3677220'>can</span> <span m='3677310'>do</span>
  <span m='3677400'>that,</span> <span m='3677990'>and</span> <span m='3678090'>I</span>
  <span m='3678150'>can</span> <span m='3678270'>prove</span> <span m='3679470'>that</span>
  <span m='3681760'>there</span> <span m='3681970'>was</span> <span m='3684040'>no</span>
  <span m='3684280'>real A,</span> <span m='3684570'>because</span> <span m='3685450'>of</span>
  <span m='3685600'>the</span> <span m='3685720'>way</span> <span m='3685930'>I</span>
  <span m='3686020'>constructed</span> <span m='3686305'>it.</span> <span m='3686800'>I</span>
  <span m='3686890'>know</span> <span m='3687160'>weird</span> <span m='3687520'>things</span>
  <span m='3687820'>about</span> <span m='3688060'>R</span> <span m='3688390'>and</span>
  <span m='3688720'>A.</span> <span m='3689830'>And</span> <span m='3689950'>so</span>
  <span m='3690040'>I</span> <span m='3690130'>can</span> <span m='3690250'>show</span>
  <span m='3690580'>that</span> <span m='3692250'>this</span> <span m='3692430'>is</span>
  <span m='3692490'>not</span> <span m='3692640'>a</span> <span m='3692700'>real</span>
  <span m='3692880'>signature.</span> </p><p><span m='3694440'>However,</span> <span
  m='3694770'>in</span> <span m='3694860'>this</span> <span m='3695040'>case,</span>
  <span m='3695250'>it's</span> <span m='3695370'>not</span> <span m='3695520'>that</span>
  <span m='3695640'>useful.</span> <span m='3695970'>In</span> <span m='3696090'>the</span>
  <span m='3696180'>case</span> <span m='3696420'>of</span> <span m='3696540'>taproot,</span>
  <span m='3696930'>it's</span> <span m='3697080'>useful,</span> <span m='3697530'>because</span>
  <span m='3697800'>I</span> <span m='3697860'>might</span> <span m='3698040'>want</span>
  <span m='3698190'>to</span> <span m='3698250'>prove</span> <span m='3698430'>to</span>
  <span m='3698520'>people,</span> <span m='3698760'>look,</span> <span m='3699180'>this</span>
  <span m='3699360'>is</span> <span m='3699480'>just</span> <span m='3699780'>a</span>
  <span m='3699810'>script.</span> <span m='3700560'>There</span> <span m='3700710'>is</span>
  <span m='3700860'>no</span> <span m='3701010'>key.</span> <span m='3703170'>In</span>
  <span m='3703320'>this</span> <span m='3703530'>case,</span> <span m='3704170'>I</span>
  <span m='3704270'>can</span> <span m='3704310'>still</span> <span m='3704580'>do</span>
  <span m='3704760'>that.</span> <span m='3705160'>I</span> <span m='3705260'>can</span>
  <span m='3705360'>say,</span> <span m='3705390'>there's</span> <span m='3705660'>just</span>
  <span m='3706020'>a</span> <span m='3706050'>script.</span> <span m='3706360'>There</span>
  <span m='3706530'>is</span> <span m='3706680'>no</span> <span m='3706830'>key.</span>
  <span m='3708580'>But</span> <span m='3711350'>then</span> <span m='3711540'>I</span>
  <span m='3711600'>can</span> <span m='3711690'>only</span> <span m='3711840'>do</span>
  <span m='3711930'>it</span> <span m='3711990'>once.</span> <span m='3713970'>The</span>
  <span m='3714060'>whole</span> <span m='3714300'>idea</span> <span m='3714660'>of</span>
  <span m='3714780'>graftroot</span> <span m='3715260'>is</span> <span m='3715410'>I</span>
  <span m='3715500'>can</span> <span m='3715620'>have</span> <span m='3715980'>a</span>
  <span m='3716070'>million</span> <span m='3716550'>different</span> <span m='3716850'>scripts,</span>
  <span m='3717510'>that</span> <span m='3717660'>are</span> <span m='3717750'>all</span>
  <span m='3717900'>going</span> <span m='3718140'>into</span> <span m='3718320'>one</span>
  <span m='3718460'>key.</span> </p><p><span m='3720370'>OK,</span> <span m='3720740'>so</span>
  <span m='3720950'>the</span> <span m='3721010'>problem</span> <span m='3721280'>is</span>
  <span m='3721820'>the</span> <span m='3721910'>root</span> <span m='3722240'>key
  must</span> <span m='3722460'>sign</span> <span m='3722690'>every</span> <span m='3722900'>script.</span>
  <span m='3723990'>And</span> <span m='3724090'>now</span> <span m='3724160'>you</span>
  <span m='3724310'>need</span> <span m='3724460'>to</span> <span m='3724550'>use</span>
  <span m='3724760'>private</span> <span m='3725330'>keys</span> <span m='3726050'>to</span>
  <span m='3726200'>create</span> <span m='3726830'>an</span> <span m='3726920'>address.</span>
  <span m='3727910'>That's</span> <span m='3729230'>not</span> <span m='3729560'>great,</span>
  <span m='3730210'>right?</span> <span m='3730670'>It's</span> <span m='3730880'>maybe</span>
  <span m='3731210'>OK,</span> <span m='3734180'>but</span> <span m='3734390'>you</span>
  <span m='3734510'>haven't</span> <span m='3734720'>had</span> <span m='3734810'>to</span>
  <span m='3734870'>do</span> <span m='3734990'>that</span> <span m='3735140'>before.</span>
  <span m='3736920'>So</span> <span m='3737460'>now</span> <span m='3737700'>we</span>
  <span m='3737850'>have</span> <span m='3737970'>to</span> <span m='3738060'>sign</span>
  <span m='3738600'>off</span> <span m='3739200'>on</span> <span m='3739380'>every</span>
  <span m='3739650'>script</span> <span m='3739920'>that</span> <span m='3740040'>we're</span>
  <span m='3740190'>endorsing,</span> <span m='3741120'>in</span> <span m='3741210'>order</span>
  <span m='3741420'>to</span> <span m='3741480'>compute</span> <span m='3741840'>an</span>
  <span m='3741930'>address.</span> </p><p><span m='3743160'>You</span> <span m='3743280'>can</span>
  <span m='3743400'>do</span> <span m='3743520'>this</span> <span m='3743730'>after</span>
  <span m='3744030'>the</span> <span m='3744120'>fact,</span> <span m='3744360'>though.</span>
  <span m='3744810'>So</span> <span m='3744990'>that's</span> <span m='3745290'>kind</span>
  <span m='3745500'>of</span> <span m='3745590'>the</span> <span m='3745680'>interesting</span>
  <span m='3746100'>thing</span> <span m='3746250'>about</span> <span m='3746430'>this,</span>
  <span m='3746640'>is</span> <span m='3746760'>you</span> <span m='3746850'>can</span>
  <span m='3746970'>say,</span> <span m='3747090'>OK,</span> <span m='3747780'>I'm</span>
  <span m='3748410'>sending</span> <span m='3748920'>the</span> <span m='3749080'>key</span>
  <span m='3749250'>C--</span> <span m='3749700'>which</span> <span m='3749910'>is</span>
  <span m='3750030'>this</span> <span m='3750210'>root</span> <span m='3750460'>key,</span>
  <span m='3750730'>that's</span> <span m='3750930'>all</span> <span m='3751260'>50</span>
  <span m='3751620'>participants.</span> <span m='3753130'>And</span> <span m='3753150'>then</span>
  <span m='3753420'>after</span> <span m='3753810'>the</span> <span m='3753930'>fact--</span>
  <span m='3754230'>after</span> <span m='3754470'>it's</span> <span m='3754590'>gone</span>
  <span m='3754770'>been</span> <span m='3754980'>confirmed</span> <span m='3755430'>in</span>
  <span m='3755520'>the</span> <span m='3755580'>blockchain--</span> <span m='3756270'>those</span>
  <span m='3756510'>50</span> <span m='3757170'>participants</span> <span m='3757770'>can</span>
  <span m='3757890'>say,</span> <span m='3758100'>actually,</span> <span m='3758490'>you</span>
  <span m='3758550'>know</span> <span m='3758670'>what,</span> <span m='3759690'>2</span>
  <span m='3760710'>of</span> <span m='3760770'>50</span> <span m='3761190'>is</span>
  <span m='3761310'>good.</span> <span m='3762090'>We're</span> <span m='3762180'>not</span>
  <span m='3762360'>suspending</span> <span m='3762870'>the</span> <span m='3762930'>money</span>
  <span m='3763200'>right</span> <span m='3763350'>now.</span> <span m='3763560'>But</span>
  <span m='3763710'>we're</span> <span m='3763860'>all</span> <span m='3764040'>agreeing</span>
  <span m='3764490'>that,</span> <span m='3764610'>yeah,</span> <span m='3764820'>any</span>
  <span m='3765120'>two</span> <span m='3765390'>of</span> <span m='3765540'>us</span>
  <span m='3766140'>can</span> <span m='3766290'>spend</span> <span m='3766500'>this</span>
  <span m='3766680'>money</span> <span m='3766920'>later.</span> </p><p><span m='3767770'>And</span>
  <span m='3767790'>so</span> <span m='3767970'>they</span> <span m='3768090'>all</span>
  <span m='3768240'>get</span> <span m='3768360'>together,</span> <span m='3768870'>and</span>
  <span m='3768990'>all</span> <span m='3769110'>50</span> <span m='3769470'>sign</span>
  <span m='3770190'>with</span> <span m='3770400'>the</span> <span m='3770520'>root</span>
  <span m='3770940'>key</span> <span m='3771330'>C</span> <span m='3771810'>all</span>
  <span m='3772080'>the</span> <span m='3772170'>different</span> <span m='3772440'>scripts--</span>
  <span m='3772890'>those</span> <span m='3773280'>1,225</span> <span m='3774660'>scripts--</span>
  <span m='3776040'>and</span> <span m='3776130'>then</span> <span m='3776250'>hand</span>
  <span m='3776400'>those</span> <span m='3776550'>signatures</span> <span m='3777000'>out</span>
  <span m='3777510'>to</span> <span m='3777870'>the</span> <span m='3778350'>respective</span>
  <span m='3778860'>people</span> <span m='3779220'>who</span> <span m='3781080'>would</span>
  <span m='3781350'>be</span> <span m='3781530'>interested</span> <span m='3781950'>in</span>
  <span m='3782070'>that</span> <span m='3782190'>signature.</span> </p><p><span m='3782790'>So,</span>
  <span m='3782940'>oh,</span> <span m='3783150'>Alice and</span> <span m='3783480'>Bob,</span>
  <span m='3783990'>if</span> <span m='3784110'>you</span> <span m='3784230'>want</span>
  <span m='3784350'>to</span> <span m='3784410'>spend</span> <span m='3784590'>the</span>
  <span m='3784650'>money,</span> <span m='3785160'>we</span> <span m='3785340'>all</span>
  <span m='3785490'>made</span> <span m='3785670'>a</span> <span m='3785700'>signature</span>
  <span m='3786240'>endorsing</span> <span m='3786780'>your</span> <span m='3787530'>2</span>
  <span m='3787710'>of</span> <span m='3787830'>2,</span> <span m='3788170'>2</span>
  <span m='3788460'>of</span> <span m='3788520'>50--</span> <span m='3789480'>your</span>
  <span m='3789860'>two</span> <span m='3790000'>keys.</span> <span m='3790710'>And</span>
  <span m='3791040'>Bob</span> <span m='3791280'>and</span> <span m='3791370'>Carol,</span>
  <span m='3791700'>if</span> <span m='3791850'>you</span> <span m='3791980'>two</span>
  <span m='3792180'>want</span> <span m='3792360'>to</span> <span m='3792420'>spend</span>
  <span m='3792600'>the</span> <span m='3792660'>money,</span> <span m='3792930'>we've</span>
  <span m='3793170'>made</span> <span m='3793380'>a</span> <span m='3793410'>script</span>
  <span m='3795150'>that's</span> <span m='3795330'>endorsed</span> <span m='3795630'>by</span>
  <span m='3795810'>us</span> <span m='3795930'>saying,</span> <span m='3797160'>your</span>
  <span m='3797580'>two</span> <span m='3797730'>keys</span> <span m='3797940'>can</span>
  <span m='3798090'>spend</span> <span m='3798330'>it.</span> </p><p><span m='3798720'>It's</span>
  <span m='3798810'>really</span> <span m='3798960'>cool.</span> <span m='3799350'>The</span>
  <span m='3799440'>overhead</span> <span m='3799770'>is</span> <span m='3799860'>one</span>
  <span m='3800040'>signature.</span> <span m='3801040'>So</span> <span m='3801150'>you</span>
  <span m='3801270'>can</span> <span m='3801420'>have</span> <span m='3801660'>that</span>
  <span m='3801990'>like</span> <span m='3802230'>100</span> <span m='3802560'>trillion</span>
  <span m='3802980'>different--</span> <span m='3805320'>50</span> <span m='3805590'>choose</span>
  <span m='3805820'>25,</span> <span m='3806400'>which</span> <span m='3806550'>is</span>
  <span m='3806640'>100</span> <span m='3806880'>trillion.</span> <span m='3807850'>Well,</span>
  <span m='3807990'>you've</span> <span m='3808080'>got</span> <span m='3808200'>to</span>
  <span m='3808410'>sign</span> <span m='3808770'>100</span> <span m='3809010'>trillion</span>
  <span m='3809340'>times,</span> <span m='3810360'>but</span> <span m='3810540'>when</span>
  <span m='3810690'>you</span> <span m='3810810'>spend</span> <span m='3811080'>from</span>
  <span m='3811290'>it,</span> <span m='3811710'>it's</span> <span m='3811860'>small.</span>
  <span m='3812700'>It's</span> <span m='3812850'>an</span> <span m='3812940'>extra</span>
  <span m='3813180'>33</span> <span m='3813990'>bytes</span> <span m='3814260'>of</span>
  <span m='3814350'>overhead.</span> <span m='3817130'>Yeah,</span> <span m='3817350'>the</span>
  <span m='3817440'>overhead</span> <span m='3817770'>is</span> <span m='3817830'>just</span>
  <span m='3817980'>a</span> <span m='3818040'>signature.</span> <span m='3818880'>So</span>
  <span m='3819060'>you</span> <span m='3819120'>say,</span> <span m='3819400'>OK,</span>
  <span m='3819640'>here's</span> <span m='3819750'>key</span> <span m='3820230'>C.
  Here's</span> <span m='3820410'>a</span> <span m='3820440'>signature</span> <span
  m='3820800'>from</span> <span m='3820980'>it.</span> <span m='3821070'>Here's</span>
  <span m='3821250'>the</span> <span m='3821310'>script,</span> <span m='3822150'>to</span>
  <span m='3822300'>endorse</span> <span m='3822570'>the</span> <span m='3822660'>script</span>
  <span m='3822840'>being</span> <span m='3823020'>executed.</span> <span m='3824020'>It's</span>
  <span m='3824100'>not</span> <span m='3824310'>actually</span> <span m='3824550'>64</span>
  <span m='3824970'>bytes.</span> <span m='3825240'>You</span> <span m='3825390'>can</span>
  <span m='3825570'>get</span> <span m='3825900'>the</span> <span m='3826290'>overhead</span>
  <span m='3826740'>into</span> <span m='3827040'>33</span> <span m='3827910'>bytes,</span>
  <span m='3828900'>because</span> <span m='3829200'>you</span> <span m='3829290'>can</span>
  <span m='3829560'>aggregate</span> <span m='3830040'>the S</span> <span m='3830190'>values</span>
  <span m='3831060'>of</span> <span m='3831300'>the</span> <span m='3831960'>signature.</span>
  </p><p><span m='3833610'>I'll</span> <span m='3833910'>talk</span> <span m='3834150'>about</span>
  <span m='3834360'>this</span> <span m='3834990'>on</span> <span m='3835110'>Wednesday.</span>
  <span m='3836700'>I</span> <span m='3836790'>don't</span> <span m='3837000'>think</span>
  <span m='3837300'>I</span> <span m='3837390'>actually</span> <span m='3837780'>came</span>
  <span m='3837960'>up</span> <span m='3838080'>with</span> <span m='3838170'>this,</span>
  <span m='3838320'>but</span> <span m='3838590'>Greg</span> <span m='3838890'>cites</span>
  <span m='3839190'>me</span> <span m='3839370'>on</span> <span m='3839520'>it,</span>
  <span m='3839720'>and</span> <span m='3839950'>it's</span> <span m='3840060'>like,</span>
  <span m='3840390'>I</span> <span m='3840750'>guess</span> <span m='3841110'>no</span>
  <span m='3841260'>one</span> <span m='3841380'>thought</span> <span m='3841560'>of</span>
  <span m='3841620'>this.</span> <span m='3842940'>But</span> <span m='3843150'>there's</span>
  <span m='3843690'>a</span> <span m='3843720'>non-interactive</span> <span m='3844800'>partial</span>
  <span m='3845280'>aggregation</span> <span m='3845850'>of</span> <span m='3845940'>these</span>
  <span m='3846090'>things,</span> <span m='3847440'>which</span> <span m='3847950'>I</span>
  <span m='3848130'>was</span> <span m='3848340'>really</span> <span m='3848580'>hoping</span>
  <span m='3848820'>would</span> <span m='3848940'>get</span> <span m='3849090'>into</span>
  <span m='3849270'>Bitcoin</span> <span m='3849630'>itself,</span> <span m='3850950'>but</span>
  <span m='3851160'>I</span> <span m='3851250'>think</span> <span m='3851400'>it's</span>
  <span m='3851520'>too</span> <span m='3851670'>slow.</span> <span m='3852570'>But</span>
  <span m='3852750'>in</span> <span m='3852840'>this</span> <span m='3852960'>case</span>
  <span m='3853200'>it's</span> <span m='3853290'>not</span> <span m='3853440'>that</span>
  <span m='3853590'>slow,</span> <span m='3853830'>so</span> <span m='3854460'>people</span>
  <span m='3854690'>are like, yeah,</span> <span m='3854950'>we'll</span> <span m='3855120'>use</span>
  <span m='3855270'>it</span> <span m='3855360'>here.</span> </p><p><span m='3856830'>So</span>
  <span m='3857400'>this</span> <span m='3857790'>is</span> <span m='3857940'>kind</span>
  <span m='3858150'>of</span> <span m='3858270'>cool,</span> <span m='3858510'>because</span>
  <span m='3858780'>it's</span> <span m='3858900'>simple.</span> <span m='3860130'>It's</span>
  <span m='3860970'>just</span> <span m='3861450'>more</span> <span m='3861720'>scripts</span>
  <span m='3861990'>can</span> <span m='3862140'>be</span> <span m='3862230'>added</span>
  <span m='3862440'>any</span> <span m='3862900'>time.</span> <span m='3863220'>It's</span>
  <span m='3863370'>all</span> <span m='3863490'>one</span> <span m='3863700'>scaling.</span>
  <span m='3864700'>So</span> <span m='3864990'>if</span> <span m='3865080'>you</span>
  <span m='3865140'>have</span> <span m='3865230'>it</span> <span m='3865300'>a</span>
  <span m='3865410'>million</span> <span m='3865740'>different</span> <span m='3865980'>scripts,</span>
  <span m='3866280'>proving</span> <span m='3866580'>one</span> <span m='3866730'>of</span>
  <span m='3866820'>them</span> <span m='3867380'>takes</span> <span m='3867590'>32</span>
  <span m='3867900'>bytes,</span> <span m='3868390'>or</span> <span m='3868540'>33,</span>
  <span m='3868870'>or</span> <span m='3869020'>something.</span> <span m='3870540'>C</span>
  <span m='3870780'>can</span> <span m='3870930'>be</span> <span m='3871020'>a</span>
  <span m='3871080'>threshold</span> <span m='3871500'>signature</span> <span m='3871860'>of</span>
  <span m='3871950'>many</span> <span m='3872130'>different</span> <span m='3872340'>parties.</span>
  <span m='3873960'>The</span> <span m='3874080'>signature</span> <span m='3874500'>can</span>
  <span m='3874650'>be</span> <span m='3874830'>aggregated</span> <span m='3875760'>within</span>
  <span m='3876060'>the</span> <span m='3876150'>transaction.</span> <span m='3876900'>The</span>
  <span m='3876990'>downside</span> <span m='3877440'>is</span> <span m='3877590'>this</span>
  <span m='3877800'>interactive</span> <span m='3878280'>setup,</span> <span m='3879000'>where</span>
  <span m='3879930'>you</span> <span m='3880080'>can't</span> <span m='3880500'>just</span>
  <span m='3880770'>take</span> <span m='3881160'>Alice,</span> <span m='3881760'>and</span>
  <span m='3881880'>Bob,</span> <span m='3882210'>and</span> <span m='3882330'>Carol's</span>
  <span m='3882750'>key,</span> <span m='3883530'>and</span> <span m='3883710'>send</span>
  <span m='3884070'>to</span> <span m='3884250'>a</span> <span m='3884310'>graftroot</span>
  <span m='3884940'>2</span> <span m='3885120'>of</span> <span m='3885150'>3</span>
  <span m='3885330'>multisig.</span> <span m='3886410'>Alice, and</span> <span m='3886740'>Bob,</span>
  <span m='3886920'>and</span> <span m='3887010'>Carol</span> <span m='3887220'>need</span>
  <span m='3887340'>to</span> <span m='3887430'>sign</span> <span m='3887790'>something.</span>
  </p><p><span m='3890430'>In</span> <span m='3890580'>some</span> <span m='3890880'>cases</span>
  <span m='3891390'>that's</span> <span m='3891630'>no</span> <span m='3891780'>big</span>
  <span m='3891900'>deal.</span> <span m='3892430'>In</span> <span m='3892500'>some</span>
  <span m='3892680'>cases,</span> <span m='3892980'>you're</span> <span m='3893070'>connected</span>
  <span m='3893420'>to them</span> <span m='3893620'>over</span> <span m='3893760'>the</span>
  <span m='3893820'>internet,</span> <span m='3894750'>and</span> <span m='3895410'>all</span>
  <span m='3895560'>the</span> <span m='3895620'>participants</span> <span m='3896130'>are</span>
  <span m='3896190'>cooperating.</span> <span m='3897300'>Sure,</span> <span m='3897600'>we'll</span>
  <span m='3897750'>sign.</span> <span m='3898110'>We'll</span> <span m='3898350'>create</span>
  <span m='3898650'>addresses.</span> <span m='3899370'>Or</span> <span m='3899490'>we'll</span>
  <span m='3899700'>pre-sign</span> <span m='3900450'>all</span> <span m='3900600'>sorts</span>
  <span m='3900870'>of</span> <span m='3900960'>different</span> <span m='3901230'>addresses</span>
  <span m='3902520'>beforehand.</span> <span m='3904290'>Doable,</span> <span m='3904680'>but</span>
  <span m='3904860'>sometimes</span> <span m='3905400'>you</span> <span m='3905550'>don't</span>
  <span m='3905790'>want</span> <span m='3906030'>this</span> <span m='3906180'>interactive</span>
  <span m='3906570'>setup.</span> <span m='3906780'>Sometimes</span> <span m='3907260'>I</span>
  <span m='3907380'>want</span> <span m='3907560'>to</span> <span m='3907620'>be</span>
  <span m='3907710'>able</span> <span m='3907830'>to</span> <span m='3907890'>send</span>
  <span m='3908160'>to</span> <span m='3909600'>participants</span> <span m='3910230'>of</span>
  <span m='3910320'>my</span> <span m='3910530'>choosing,</span> <span m='3911460'>without</span>
  <span m='3911850'>their</span> <span m='3912210'>cooperation.</span> <span m='3914500'>Really,</span>
  <span m='3915890'>usually</span> <span m='3916160'>for</span> <span m='3916280'>sending</span>
  <span m='3916550'>people</span> <span m='3916790'>money,</span> <span m='3917030'>they're</span>
  <span m='3917150'>OK</span> <span m='3917390'>with</span> <span m='3917570'>it,</span>
  <span m='3917640'>right?</span> <span m='3917930'>But</span> <span m='3918590'>sometimes</span>
  <span m='3919880'>you</span> <span m='3919970'>don't</span> <span m='3920150'>want</span>
  <span m='3920330'>them</span> <span m='3920480'>to</span> <span m='3920570'>be</span>
  <span m='3920690'>online.</span> </p><p><span m='3922870'>So</span> <span m='3924310'>put</span>
  <span m='3924490'>this</span> <span m='3924700'>all</span> <span m='3924800'>together.</span>
  <span m='3926110'>The</span> <span m='3928330'>goal</span> <span m='3928690'>for</span>
  <span m='3928840'>this,</span> <span m='3929110'>and</span> <span m='3929200'>I</span>
  <span m='3929260'>think</span> <span m='3929440'>the</span> <span m='3929530'>way</span>
  <span m='3929680'>it's</span> <span m='3929770'>going</span> <span m='3929850'>to</span>
  <span m='3929950'>work</span> <span m='3930130'>in</span> <span m='3930220'>Bitcoin--</span>
  <span m='3930670'>but</span> <span m='3930910'>this</span> <span m='3931060'>is</span>
  <span m='3931420'>still</span> <span m='3932320'>research--</span> <span m='3934120'>you</span>
  <span m='3934210'>have</span> <span m='3934300'>a</span> <span m='3934360'>unified</span>
  <span m='3934810'>output</span> <span m='3935110'>script.</span> <span m='3935540'>So</span>
  <span m='3935590'>let's</span> <span m='3935800'>say</span> <span m='3936520'>it's</span>
  <span m='3936670'>a</span> <span m='3936730'>templated</span> <span m='3937240'>with</span>
  <span m='3937620'>OP_5.</span> <span m='3938800'>And</span> <span m='3938890'>you</span>
  <span m='3939010'>say,</span> <span m='3939220'>OK,</span> <span m='3940180'>OP_5,</span>
  <span m='3941190'>pubkey.</span> </p><p><span m='3943510'>Now,</span> <span m='3943690'>when</span>
  <span m='3943810'>I</span> <span m='3943880'>want</span> <span m='3944000'>to</span>
  <span m='3944060'>spend</span> <span m='3944300'>to</span> <span m='3944420'>it,</span>
  <span m='3944820'>I</span> <span m='3944920'>have</span> <span m='3945020'>a</span>
  <span m='3945120'>bunch</span> <span m='3945220'>of</span> <span m='3945320'>options.</span>
  <span m='3946650'>To</span> <span m='3946770'>spend,</span> <span m='3947460'>I</span>
  <span m='3947550'>can</span> <span m='3947700'>just</span> <span m='3947850'>put</span>
  <span m='3948000'>a</span> <span m='3948060'>signature</span> <span m='3948540'>on</span>
  <span m='3948630'>the</span> <span m='3948690'>stack.</span> <span m='3949680'>And</span>
  <span m='3949800'>then</span> <span m='3949950'>the</span> <span m='3950550'>program</span>
  <span m='3950940'>says,</span> <span m='3951280'>oh,</span> <span m='3951550'>there's</span>
  <span m='3951690'>a</span> <span m='3951730'>signature.</span> <span m='3952440'>Let</span>
  <span m='3952650'>me</span> <span m='3952950'>check</span> <span m='3953460'>if</span>
  <span m='3953640'>the</span> <span m='3953760'>signature</span> <span m='3954840'>matches</span>
  <span m='3955770'>the</span> <span m='3955860'>public</span> <span m='3956220'>key--</span>
  <span m='3957650'>you</span> <span m='3957730'>know,</span> <span m='3957900'>this</span>
  <span m='3958290'>pubkey.</span> <span m='3959070'>And</span> <span m='3959190'>if</span>
  <span m='3959250'>it</span> <span m='3959310'>does,</span> <span m='3959550'>cool,</span>
  <span m='3960000'>the</span> <span m='3960180'>money</span> <span m='3960420'>moves.</span>
  <span m='3962300'>That's</span> <span m='3962530'>pay to</span> <span m='3962800'>pubkey</span>
  <span m='3963000'>hash</span> <span m='3963290'>mode,</span> <span m='3963930'>except</span>
  <span m='3964190'>it's</span> <span m='3964270'>not</span> <span m='3964450'>hashed.</span>
  </p><p><span m='3965460'>Another</span> <span m='3965760'>thing</span> <span m='3965970'>I</span>
  <span m='3966030'>could</span> <span m='3966150'>do</span> <span m='3966480'>is</span>
  <span m='3966960'>provide</span> <span m='3967710'>a</span> <span m='3967980'>point</span>
  <span m='3968350'>J--</span> <span m='3969270'>a</span> <span m='3969330'>script--</span>
  <span m='3970380'>and</span> <span m='3970770'>a</span> <span m='3971160'>series</span>
  <span m='3971850'>of</span> <span m='3971940'>arguments</span> <span m='3972330'>for</span>
  <span m='3972450'>the</span> <span m='3972510'>script.</span> <span m='3973700'>And</span>
  <span m='3973820'>that's</span> <span m='3974900'>taproot.</span> <span m='3975890'>I</span>
  <span m='3976010'>verify</span> <span m='3976790'>that</span> <span m='3977120'>J</span>
  <span m='3980090'>plus</span> <span m='3980450'>the</span> <span m='3980570'>hash</span>
  <span m='3980870'>of</span> <span m='3981050'>J</span> <span m='3981380'>in</span>
  <span m='3981470'>the</span> <span m='3981560'>script</span> <span m='3982120'>times</span>
  <span m='3982400'>G</span> <span m='3983300'>is</span> <span m='3983420'>equal</span>
  <span m='3983690'>to</span> <span m='3983810'>that</span> <span m='3983960'>pubkey,</span>
  <span m='3984980'>and</span> <span m='3985280'>then</span> <span m='3985400'>I</span>
  <span m='3985490'>execute</span> <span m='3985850'>that</span> <span m='3986000'>script.</span>
  </p><p><span m='3987190'>Another</span> <span m='3987520'>way</span> <span m='3987640'>to</span>
  <span m='3987730'>do</span> <span m='3987910'>it</span> <span m='3988120'>is</span>
  <span m='3988420'>if</span> <span m='3988540'>I've</span> <span m='3988660'>got</span>
  <span m='3988870'>this--</span> <span m='3989830'>I've</span> <span m='3990140'>got</span>
  <span m='3990700'>C,</span> <span m='3991150'>which</span> <span m='3991360'>is</span>
  <span m='3991510'>also</span> <span m='3991750'>just</span> <span m='3991930'>a</span>
  <span m='3991960'>point</span> <span m='3992350'>and</span> <span m='3992450'>a</span>
  <span m='3992500'>signature</span> <span m='3992830'>on</span> <span m='3992920'>the</span>
  <span m='3992980'>script--</span> <span m='3993610'>and</span> <span m='3993700'>then</span>
  <span m='3993790'>a</span> <span m='3993850'>script,</span> <span m='3994360'>and</span>
  <span m='3994480'>a</span> <span m='3994510'>bunch</span> <span m='3994690'>of</span>
  <span m='3994780'>arguments,</span> <span m='3995980'>then</span> <span m='3996280'>I</span>
  <span m='3996370'>say,</span> <span m='3996640'>oh,</span> <span m='3996910'>this</span>
  <span m='3997090'>is</span> <span m='3997180'>graftroot.</span> <span m='3998410'>I'll</span>
  <span m='3998650'>verify</span> <span m='3999220'>this</span> <span m='4000600'>signature</span>
  <span m='4001350'>on</span> <span m='4001710'>this</span> <span m='4001890'>script,</span>
  <span m='4003030'>and</span> <span m='4003150'>then</span> <span m='4003360'>execute</span>
  <span m='4003780'>with</span> <span m='4003900'>these</span> <span m='4004050'>arguments.</span>
  </p><p><span m='4007340'>So</span> <span m='4008330'>it would</span> <span m='4008450'>be</span>
  <span m='4008590'>cool</span> <span m='4008980'>if</span> <span m='4009100'>you</span>
  <span m='4009190'>could</span> <span m='4009340'>do</span> <span m='4009490'>it</span>
  <span m='4009550'>just</span> <span m='4009790'>based</span> <span m='4010060'>on</span>
  <span m='4010160'>the</span> <span m='4010240'>number</span> <span m='4010900'>of</span>
  <span m='4011740'>items</span> <span m='4012730'>pushed.</span> <span m='4013090'>But</span>
  <span m='4013780'>you</span> <span m='4013870'>might</span> <span m='4014110'>want</span>
  <span m='4014260'>to</span> <span m='4014320'>put</span> <span m='4014500'>like</span>
  <span m='4014680'>a</span> <span m='4014740'>flag</span> <span m='4015250'>or</span>
  <span m='4015340'>something</span> <span m='4015760'>here,</span> <span m='4016000'>to</span>
  <span m='4016150'>distinguish</span> <span m='4016630'>between</span> <span m='4016930'>these</span>
  <span m='4017110'>two.</span> <span m='4017760'>And</span> <span m='4017890'>with</span>
  <span m='4018040'>this,</span> <span m='4018310'>if</span> <span m='4018400'>there's</span>
  <span m='4018520'>just</span> <span m='4018670'>one</span> <span m='4019450'>element,</span>
  <span m='4019900'>you</span> <span m='4020020'>can</span> <span m='4020170'>just</span>
  <span m='4020410'>quickly</span> <span m='4020740'>say,</span> <span m='4020920'>OK,</span>
  <span m='4021100'>it's</span> <span m='4021370'>pay to</span> <span m='4021550'>pubkey.</span>
  </p><p><span m='4022600'>But</span> <span m='4022780'>to</span> <span m='4022900'>distinguish</span>
  <span m='4023350'>between</span> <span m='4023590'>these</span> <span m='4023710'>two</span>
  <span m='4023830'>there</span> <span m='4023980'>might</span> <span m='4024220'>be</span>
  <span m='4024370'>weird</span> <span m='4024640'>edge</span> <span m='4024790'>cases,</span>
  <span m='4025150'>where</span> <span m='4025270'>it's</span> <span m='4025390'>like,</span>
  <span m='4025540'>well,</span> <span m='4026320'>one</span> <span m='4026470'>of</span>
  <span m='4026530'>the</span> <span m='4026620'>arguments</span> <span m='4027160'>could</span>
  <span m='4027310'>also</span> <span m='4027580'>look</span> <span m='4027730'>like</span>
  <span m='4027880'>a</span> <span m='4027910'>script,</span> <span m='4028510'>and</span>
  <span m='4029160'>annoying things.</span> <span m='4029530'>So you</span> <span
  m='4029620'>might</span> <span m='4029770'>put</span> <span m='4029950'>some,</span>
  <span m='4030140'>like,</span> <span m='4030730'>flag</span> <span m='4031110'>byte</span>
  <span m='4032720'>But</span> <span m='4032840'>anyway,</span> <span m='4033590'>it's</span>
  <span m='4033740'>kind</span> <span m='4033890'>of</span> <span m='4033950'>nice,</span>
  <span m='4034160'>in</span> <span m='4034280'>that</span> <span m='4034400'>when</span>
  <span m='4034700'>you</span> <span m='4035300'>send</span> <span m='4035840'>to</span>
  <span m='4036320'>an</span> <span m='4036440'>output,</span> <span m='4037190'>you</span>
  <span m='4037310'>send</span> <span m='4037520'>to</span> <span m='4037640'>an</span>
  <span m='4037730'>address,</span> <span m='4038930'>all</span> <span m='4039140'>the</span>
  <span m='4039260'>addresses</span> <span m='4039650'>look</span> <span m='4039800'>the</span>
  <span m='4039890'>same.</span> <span m='4040310'>They</span> <span m='4040430'>just</span>
  <span m='4040580'>look</span> <span m='4040760'>like</span> <span m='4040910'>public</span>
  <span m='4041180'>keys,</span> <span m='4042590'>but</span> <span m='4043040'>they</span>
  <span m='4043160'>could</span> <span m='4043310'>be</span> <span m='4043430'>any</span>
  <span m='4043580'>of</span> <span m='4043640'>these</span> <span m='4043820'>things,</span>
  <span m='4044790'>and</span> <span m='4044810'>you</span> <span m='4044930'>only</span>
  <span m='4045260'>find</span> <span m='4045560'>out</span> <span m='4045830'>after</span>
  <span m='4046100'>the</span> <span m='4046190'>fact.</span> </p><p><span m='4050500'>And</span>
  <span m='4050890'>not</span> <span m='4051100'>only</span> <span m='4051220'>that--</span>
  <span m='4051430'>you</span> <span m='4051580'>could</span> <span m='4051790'>have</span>
  <span m='4052030'>the</span> <span m='4052180'>same</span> <span m='4054150'>key</span>
  <span m='4055170'>have</span> <span m='4055470'>a</span> <span m='4055530'>taproot</span>
  <span m='4056310'>and</span> <span m='4056430'>also</span> <span m='4056730'>have</span>
  <span m='4056880'>a</span> <span m='4056940'>graftroot.</span> <span m='4060350'>So</span>
  <span m='4060700'>there</span> <span m='4060850'>could</span> <span m='4061060'>be</span>
  <span m='4061180'>an</span> <span m='4061270'>address.</span> <span m='4061630'>And</span>
  <span m='4061750'>I've</span> <span m='4061840'>gotten</span> <span m='4062140'>my</span>
  <span m='4062290'>wallet.</span> <span m='4062980'>Well,</span> <span m='4063160'>there's</span>
  <span m='4063340'>three</span> <span m='4063580'>different</span> <span m='4063850'>ways</span>
  <span m='4064060'>I</span> <span m='4064150'>can</span> <span m='4064270'>spend</span>
  <span m='4064480'>this.</span> </p><p><span m='4065050'>I</span> <span m='4065140'>can</span>
  <span m='4065320'>spend</span> <span m='4065590'>this</span> <span m='4065830'>with</span>
  <span m='4068050'>everyone--</span> <span m='4068530'>all</span> <span m='4068890'>50</span>
  <span m='4069250'>people--</span> <span m='4069490'>signing.</span> <span m='4070270'>Or</span>
  <span m='4070360'>I</span> <span m='4070420'>can</span> <span m='4070540'>spend</span>
  <span m='4070780'>it</span> <span m='4070900'>with</span> <span m='4071560'>a</span>
  <span m='4072430'>single</span> <span m='4072910'>script</span> <span m='4073330'>that's</span>
  <span m='4073510'>been</span> <span m='4073690'>endorsed</span> <span m='4074050'>this</span>
  <span m='4074290'>way,</span> <span m='4075130'>that's</span> <span m='4075370'>got</span>
  <span m='4075760'>priority.</span> <span m='4076810'>And</span> <span m='4076960'>then</span>
  <span m='4077080'>I</span> <span m='4077170'>can</span> <span m='4077320'>also</span>
  <span m='4077650'>spend</span> <span m='4078040'>it</span> <span m='4078190'>with</span>
  <span m='4079000'>one</span> <span m='4079210'>of</span> <span m='4079360'>the</span>
  <span m='4079600'>millions</span> <span m='4080110'>of</span> <span m='4080170'>scripts</span>
  <span m='4080500'>that</span> <span m='4080590'>have</span> <span m='4080710'>been</span>
  <span m='4080830'>endorsed</span> <span m='4081160'>this</span> <span m='4081340'>way.</span>
  <span m='4083200'>So</span> <span m='4083290'>I</span> <span m='4083350'>can</span>
  <span m='4083620'>use</span> <span m='4083860'>all</span> <span m='4084040'>three.</span>
  <span m='4084280'>This</span> <span m='4084460'>is</span> <span m='4084850'>a</span>
  <span m='4084910'>little</span> <span m='4085060'>bit</span> <span m='4085180'>more</span>
  <span m='4085330'>efficient,</span> <span m='4085960'>because</span> <span m='4086380'>you're</span>
  <span m='4087430'>just</span> <span m='4087700'>revealing</span> <span m='4088090'>the</span>
  <span m='4088150'>script</span> <span m='4088420'>and a</span> <span m='4088530'>point.</span>
  <span m='4089080'>This</span> <span m='4089290'>one,</span> <span m='4089500'>you</span>
  <span m='4089590'>have</span> <span m='4089740'>to</span> <span m='4089830'>reveal.</span>
  </p><p><span m='4091620'>Oh</span> <span m='4091710'>no,</span> <span m='4091860'>wait,</span>
  <span m='4092020'>sorry,</span> <span m='4092610'>this</span> <span m='4092760'>is</span>
  <span m='4092850'>wrong.</span> <span m='4094170'>There's</span> <span m='4094290'>no</span>
  <span m='4094440'>C.</span> <span m='4094800'>You</span> <span m='4094890'>already</span>
  <span m='4095100'>know</span> <span m='4095220'>C.</span> <span m='4096470'>It's</span>
  <span m='4096770'>still</span> <span m='4096920'>a</span> <span m='4096950'>little</span>
  <span m='4097130'>more</span> <span m='4097279'>efficient.</span> <span m='4102010'>Yeah,</span>
  <span m='4102160'>there's</span> <span m='4102279'>no</span> <span m='4102399'>C</span>
  <span m='4102580'>there.</span> <span m='4102910'>You</span> <span m='4103000'>already</span>
  <span m='4103250'>know</span> <span m='4103410'>C.</span> <span m='4103689'>You</span>
  <span m='4103779'>just</span> <span m='4103899'>put</span> <span m='4104020'>the</span>
  <span m='4104109'>signature</span> <span m='4105010'>on</span> <span m='4105100'>the</span>
  <span m='4105189'>script.</span> <span m='4105649'>Yeah,</span> <span m='4106029'>OK,</span>
  <span m='4106210'>so</span> <span m='4106587'>that's</span> <span m='4106964'>[INAUDIBLE]</span>
  </p><p><span m='4110330'>OK,</span> <span m='4110649'>so</span> <span m='4110800'>this</span>
  <span m='4111040'>is</span> <span m='4111380'>graftroot,</span> <span m='4111880'>taproot.</span>
  <span m='4113080'>And</span> <span m='4113200'>then,</span> <span m='4113350'>also,</span>
  <span m='4113649'>part</span> <span m='4113920'>of</span> <span m='4114010'>the</span>
  <span m='4114069'>script</span> <span m='4114399'>can</span> <span m='4114580'>be</span>
  <span m='4114790'>masked.</span> <span m='4115569'>You</span> <span m='4115660'>can</span>
  <span m='4115779'>have</span> <span m='4115870'>a</span> <span m='4115930'>masked</span>
  <span m='4116149'>OP</span> <span m='4116410'>code.</span> <span m='4116979'>You</span>
  <span m='4117069'>can</span> <span m='4117189'>combine</span> <span m='4117609'>all</span>
  <span m='4117729'>these</span> <span m='4117910'>things</span> <span m='4118240'>in</span>
  <span m='4118359'>crazy</span> <span m='4118689'>ways,</span> <span m='4119620'>and</span>
  <span m='4119740'>have</span> <span m='4119920'>like</span> <span m='4120069'>really</span>
  <span m='4120460'>powerful</span> <span m='4121149'>scripting</span> <span m='4121540'>that</span>
  <span m='4121660'>way.</span> </p><p><span m='4122710'>So</span> <span m='4122859'>when</span>
  <span m='4123310'>this</span> <span m='4123580'>stuff</span> <span m='4124029'>was</span>
  <span m='4124210'>proposed,</span> <span m='4125240'>the</span> <span m='4125290'>argument</span>
  <span m='4126700'>was,</span> <span m='4127060'>hey,</span> <span m='4127520'>I</span>
  <span m='4127600'>don't</span> <span m='4127990'>want</span> <span m='4128319'>to</span>
  <span m='4128380'>spend</span> <span m='4128830'>to</span> <span m='4129010'>a</span>
  <span m='4129100'>public</span> <span m='4129460'>key.</span> <span m='4130479'>I</span>
  <span m='4130540'>want</span> <span m='4130720'>to</span> <span m='4130779'>spend</span>
  <span m='4130990'>to</span> <span m='4131109'>a</span> <span m='4131170'>public</span>
  <span m='4131450'>key</span> <span m='4131590'>hash.</span> <span m='4132490'>Because</span>
  <span m='4132850'>quantum</span> <span m='4133149'>computers</span> <span m='4133630'>are</span>
  <span m='4133689'>coming.</span> <span m='4134649'>And</span> <span m='4135370'>when</span>
  <span m='4135880'>the</span> <span m='4135970'>quantum</span> <span m='4136300'>computers</span>
  <span m='4136720'>come,</span> <span m='4137439'>if</span> <span m='4137560'>you</span>
  <span m='4137620'>know</span> <span m='4137740'>my</span> <span m='4137939'>pubkey,</span>
  <span m='4138790'>you</span> <span m='4138910'>can</span> <span m='4139029'>just</span>
  <span m='4139149'>calculate</span> <span m='4139510'>my</span> <span m='4139630'>private</span>
  <span m='4139930'>key,</span> <span m='4140590'>and</span> <span m='4140680'>take</span>
  <span m='4140859'>all</span> <span m='4140920'>my</span> <span m='4141040'>money.</span>
  <span m='4141970'>But</span> <span m='4142330'>if</span> <span m='4142450'>you</span>
  <span m='4142630'>only</span> <span m='4142930'>know</span> <span m='4143080'>my</span>
  <span m='4143229'>public</span> <span m='4143529'>key</span> <span m='4143740'>hash,</span>
  <span m='4144850'>quantum</span> <span m='4145090'>computer</span> <span m='4145390'>doesn't</span>
  <span m='4145600'>help</span> <span m='4145779'>you</span> <span m='4145840'>there.</span>
  <span m='4146770'>You're</span> <span m='4146890'>not</span> <span m='4147100'>going</span>
  <span m='4147220'>to</span> <span m='4147310'>be</span> <span m='4147399'>able</span>
  <span m='4147609'>to</span> <span m='4147700'>compute</span> <span m='4149020'>the</span>
  <span m='4149140'>pre-image</span> <span m='4150430'>of</span> <span m='4150550'>a</span>
  <span m='4150609'>hash</span> <span m='4151000'>with</span> <span m='4151180'>a</span>
  <span m='4151210'>quantum</span> <span m='4151479'>computer.</span> </p><p><span
  m='4156750'>All</span> <span m='4156930'>of</span> <span m='4157050'>those</span>
  <span m='4157260'>statements</span> <span m='4157740'>are</span> <span m='4158100'>true,</span>
  <span m='4159000'>except</span> <span m='4160770'>in</span> <span m='4160859'>practice</span>
  <span m='4162189'>it's</span> <span m='4162939'>dumb.</span> <span m='4163319'>Because</span>
  <span m='4164790'>if</span> <span m='4164970'>there's</span> <span m='4165210'>a</span>
  <span m='4165270'>quantum</span> <span m='4165569'>computer</span> <span m='4165990'>that</span>
  <span m='4166140'>can</span> <span m='4166319'>compute</span> <span m='4167279'>your</span>
  <span m='4167399'>private</span> <span m='4167729'>key</span> <span m='4167939'>from</span>
  <span m='4168210'>your</span> <span m='4168359'>public</span> <span m='4168660'>key,</span>
  <span m='4170970'>the</span> <span m='4171149'>only</span> <span m='4171479'>time</span>
  <span m='4172200'>using</span> <span m='4172590'>pubkey</span> <span m='4172979'>hashes</span>
  <span m='4173310'>will</span> <span m='4173430'>help</span> <span m='4173670'>you</span>
  <span m='4173850'>is</span> <span m='4174029'>if</span> <span m='4174149'>somehow</span>
  <span m='4174540'>that</span> <span m='4174689'>quantum</span> <span m='4174990'>computer</span>
  <span m='4175350'>takes</span> <span m='4175740'>a</span> <span m='4175800'>really</span>
  <span m='4176100'>long</span> <span m='4176370'>time</span> <span m='4176910'>to</span>
  <span m='4177240'>compute</span> <span m='4178229'>your</span> <span m='4178319'>private</span>
  <span m='4178620'>key.</span> <span m='4180000'>Because</span> <span m='4181330'>if</span>
  <span m='4181470'>it</span> <span m='4181560'>only</span> <span m='4181740'>takes</span>
  <span m='4181979'>them</span> <span m='4182069'>a</span> <span m='4182130'>minute</span>
  <span m='4182550'>to</span> <span m='4182700'>compute</span> <span m='4183060'>it,</span>
  <span m='4183540'>well,</span> <span m='4184319'>you</span> <span m='4184500'>have</span>
  <span m='4184740'>to</span> <span m='4184859'>reveal</span> <span m='4185220'>your</span>
  <span m='4185370'>public</span> <span m='4185790'>key</span> <span m='4186090'>to</span>
  <span m='4186240'>spend</span> <span m='4186510'>your</span> <span m='4186630'>money.</span>
  </p><p><span m='4187439'>And</span> <span m='4187620'>then</span> <span m='4187770'>the</span>
  <span m='4187920'>attacker,</span> <span m='4188430'>who</span> <span m='4188580'>has</span>
  <span m='4188729'>this</span> <span m='4189060'>nifty</span> <span m='4189359'>quantum</span>
  <span m='4189600'>computer,</span> <span m='4189960'>can</span> <span m='4190080'>just</span>
  <span m='4190200'>say,</span> <span m='4190350'>oh,</span> <span m='4190979'>that's</span>
  <span m='4191340'>his</span> <span m='4193250'>public</span> <span m='4193569'>key.</span>
  <span m='4193729'>I</span> <span m='4193819'>just</span> <span m='4193970'>saw</span>
  <span m='4194180'>it.</span> <span m='4194930'>And</span> <span m='4195170'>he</span>
  <span m='4195290'>signed.</span> <span m='4195860'>And</span> <span m='4196100'>using</span>
  <span m='4196460'>his</span> <span m='4196610'>public</span> <span m='4196910'>key,</span>
  <span m='4197030'>I</span> <span m='4197150'>just</span> <span m='4197330'>compute
  his</span> <span m='4197690'>private</span> <span m='4197900'>key,</span> <span
  m='4198320'>sign</span> <span m='4198470'>a</span> <span m='4198530'>different</span>
  <span m='4198770'>message,</span> <span m='4199460'>and</span> <span m='4199580'>broadcast</span>
  <span m='4200030'>it.</span> <span m='4200660'>And</span> <span m='4201740'>maybe</span>
  <span m='4202040'>I</span> <span m='4202160'>attach</span> <span m='4202460'>a</span>
  <span m='4202490'>higher</span> <span m='4202730'>fee.</span> <span m='4203120'>Because</span>
  <span m='4203330'>I</span> <span m='4203390'>don't</span> <span m='4203510'>care,</span>
  <span m='4203660'>it's</span> <span m='4203780'>not</span> <span m='4203900'>my</span>
  <span m='4204020'>money.</span> <span m='4204980'>And</span> <span m='4205100'>the</span>
  <span m='4205160'>miners</span> <span m='4205460'>are</span> <span m='4205490'>like,</span>
  <span m='4205670'>well,</span> <span m='4205850'>there's</span> <span m='4206060'>two</span>
  <span m='4206270'>different</span> <span m='4206570'>transactions--</span> <span
  m='4207890'>one</span> <span m='4208220'>sending</span> <span m='4208520'>over</span>
  <span m='4208670'>here,</span> <span m='4208880'>one</span> <span m='4209030'>sending</span>
  <span m='4209240'>over</span> <span m='4209360'>here.</span> <span m='4209590'>This</span>
  <span m='4209750'>one</span> <span m='4209870'>has</span> <span m='4209990'>a</span>
  <span m='4210020'>much</span> <span m='4210170'>higher</span> <span m='4210320'>fee.</span>
  <span m='4210710'>I'll</span> <span m='4210830'>use</span> <span m='4210950'>this</span>
  <span m='4211070'>one.</span> <span m='4212050'>And</span> <span m='4212450'>the</span>
  <span m='4212870'>attacker</span> <span m='4213230'>with</span> <span m='4213380'>the</span>
  <span m='4213440'>quantum</span> <span m='4213680'>computer</span> <span m='4213980'>still</span>
  <span m='4214190'>takes</span> <span m='4214370'>all</span> <span m='4214490'>your</span>
  <span m='4214580'>money.</span> </p><p><span m='4215720'>They</span> <span m='4215870'>can't</span>
  <span m='4216170'>take</span> <span m='4216440'>it</span> <span m='4216620'>at</span>
  <span m='4216770'>rest.</span> <span m='4217280'>They</span> <span m='4217400'>have</span>
  <span m='4217550'>to</span> <span m='4217640'>wait</span> <span m='4217820'>for</span>
  <span m='4217940'>you</span> <span m='4218030'>to</span> <span m='4218120'>try</span>
  <span m='4218270'>to</span> <span m='4218360'>spend</span> <span m='4218660'>it</span>
  <span m='4218720'>and</span> <span m='4218810'>take</span> <span m='4219050'>it.</span>
  <span m='4219860'>But</span> <span m='4221360'>you</span> <span m='4221540'>could</span>
  <span m='4222020'>say,</span> <span m='4222410'>OK,</span> <span m='4222710'>well</span>
  <span m='4222860'>actually,</span> <span m='4223310'>I'm</span> <span m='4223460'>doing</span>
  <span m='4223720'>OP_5,</span> <span m='4224600'>pubkey</span> <span m='4224990'>hash.</span>
  <span m='4225860'>And</span> <span m='4225980'>then</span> <span m='4226670'>for</span>
  <span m='4226820'>this,</span> <span m='4227180'>I</span> <span m='4227270'>have</span>
  <span m='4227420'>to</span> <span m='4227540'>reveal</span> <span m='4228140'>pubkey</span>
  <span m='4228650'>signature.</span> <span m='4229130'>For</span> <span m='4229280'>this,</span>
  <span m='4229520'>I</span> <span m='4229610'>reveal</span> <span m='4231440'>j</span>
  <span m='4231770'>component</span> <span m='4232220'>of</span> <span m='4232310'>pubkey</span>
  <span m='4232700'>script.</span> <span m='4233270'>For</span> <span m='4233390'>this,</span>
  <span m='4233690'>I</span> <span m='4233840'>reveal</span> <span m='4234810'>C</span>
  <span m='4235020'>and</span> <span m='4235360'>the</span> <span m='4235530'>sig.</span>
  <span m='4236120'>But</span> <span m='4236300'>it's</span> <span m='4238070'>kind</span>
  <span m='4238250'>of</span> <span m='4238320'>ugly.</span> <span m='4238860'>It</span>
  <span m='4239250'>wastes</span> <span m='4239530'>space,</span> <span m='4241250'>and</span>
  <span m='4241380'>in</span> <span m='4241470'>most</span> <span m='4241710'>cases</span>
  <span m='4242100'>doesn't</span> <span m='4242460'>provide</span> <span m='4242850'>a</span>
  <span m='4242910'>lot</span> <span m='4243120'>of</span> <span m='4243840'>protection.</span>
  <span m='4245940'>So</span> <span m='4246740'>there's</span> <span m='4247140'>hopefully</span>
  <span m='4247530'>better</span> <span m='4247770'>ways</span> <span m='4248040'>to</span>
  <span m='4248130'>deal</span> <span m='4248310'>with</span> <span m='4248400'>this.</span>
  <span m='4250140'>One</span> <span m='4250380'>thing</span> <span m='4250590'>that</span>
  <span m='4250710'>I</span> <span m='4251100'>have</span> <span m='4251310'>sort</span>
  <span m='4251580'>of</span> <span m='4251670'>been</span> <span m='4251790'>joking</span>
  <span m='4252120'>about,</span> <span m='4253290'>but</span> <span m='4253940'>would</span>
  <span m='4254070'>be</span> <span m='4254190'>kind</span> <span m='4254400'>of</span>
  <span m='4254460'>fun</span> <span m='4254700'>to</span> <span m='4254760'>put</span>
  <span m='4254940'>it</span> <span m='4255030'>into</span> <span m='4255150'>[INAUDIBLE].</span>
  <span m='4255810'>You</span> <span m='4255960'>can</span> <span m='4256080'>actually</span>
  <span m='4256380'>use</span> <span m='4256620'>taproot</span> <span m='4257250'>to</span>
  <span m='4257760'>commit</span> <span m='4258300'>to</span> <span m='4258870'>a</span>
  <span m='4259550'>Lamport-like</span> <span m='4261360'>hash-based</span> <span
  m='4261960'>pubkey.</span> </p><p><span m='4263640'>So</span> <span m='4263880'>in</span>
  <span m='4264650'>taproot</span> <span m='4267470'>this</span> <span m='4268660'>is</span>
  <span m='4268990'>actually</span> <span m='4271500'>quantum</span> <span m='4271770'>secure.</span>
  <span m='4273190'>I</span> <span m='4273570'>hesitate</span> <span m='4274110'>to</span>
  <span m='4274440'>advertise</span> <span m='4274950'>this.</span> <span m='4275550'>But</span>
  <span m='4275820'>it</span> <span m='4275910'>is</span> <span m='4276210'>a</span>
  <span m='4276300'>commitment</span> <span m='4276930'>that</span> <span m='4280110'>the</span>
  <span m='4280800'>quantum</span> <span m='4281160'>computer</span> <span m='4281550'>cannot</span>
  <span m='4282000'>forge.</span> <span m='4288250'>Where</span> <span m='4288970'>was</span>
  <span m='4289240'>I</span> <span m='4289300'>saying</span> <span m='4290422'>the</span>
  <span m='4293340'>J</span> <span m='4293610'>equals</span> <span m='4293910'>hash</span>
  <span m='4294150'>of--</span> <span m='4296140'>yeah,</span> <span m='4296500'>this</span>
  <span m='4296770'>thing</span> <span m='4298630'>is</span> <span m='4298720'>still</span>
  <span m='4298960'>a</span> <span m='4299020'>problem</span> <span m='4299320'>for</span>
  <span m='4299470'>a</span> <span m='4299500'>quantum</span> <span m='4299750'>computer.</span>
  <span m='4301120'>I</span> <span m='4301210'>want</span> <span m='4301420'>to</span>
  <span m='4301460'>compute</span> <span m='4301670'>a</span> <span m='4301820'>J</span>
  <span m='4302140'>such</span> <span m='4302440'>that</span> <span m='4302650'>J</span>
  <span m='4303070'>equals</span> <span m='4303550'>this</span> <span m='4303760'>hash</span>
  <span m='4304060'>times</span> <span m='4304420'>G</span> <span m='4304960'>minus</span>
  <span m='4305230'>R.</span> <span m='4306535'>And</span> <span m='4306970'>J</span>
  <span m='4307120'>is in</span> <span m='4307300'>there</span> <span m='4307450'>as</span>
  <span m='4307570'>well.</span> <span m='4308770'>Even</span> <span m='4309100'>with</span>
  <span m='4309250'>a</span> <span m='4309280'>quantum</span> <span m='4309640'>computer,</span>
  <span m='4310540'>maybe</span> <span m='4311050'>I</span> <span m='4311170'>can</span>
  <span m='4311380'>compute</span> <span m='4311800'>an</span> <span m='4311950'>arbitrary</span>
  <span m='4312610'>J</span> <span m='4313420'>and</span> <span m='4313570'>find</span>
  <span m='4313960'>its</span> <span m='4314110'>discrete</span> <span m='4314470'>lock--</span>
  <span m='4314930'>you</span> <span m='4314990'>know,</span> <span m='4315160'>find</span>
  <span m='4315430'>the</span> <span m='4315520'>private</span> <span m='4315880'>key--</span>
  <span m='4316600'>but</span> <span m='4316780'>it's</span> <span m='4316900'>still</span>
  <span m='4317200'>not</span> <span m='4317380'>going</span> <span m='4317500'>to</span>
  <span m='4317560'>satisfy</span> <span m='4318010'>this</span> <span m='4318160'>equation.</span>
  </p><p><span m='4321310'>So</span> <span m='4321810'>I</span> <span m='4321960'>can't</span>
  <span m='4324120'>after</span> <span m='4324450'>the</span> <span m='4324570'>fact</span>
  <span m='4324870'>find</span> <span m='4325800'>a</span> <span m='4325860'>script</span>
  <span m='4326660'>and</span> <span m='4326820'>a</span> <span m='4326850'>J</span>
  <span m='4327210'>to</span> <span m='4327360'>compute</span> <span m='4327780'>this</span>
  <span m='4327940'>C.</span> <span m='4328980'>So</span> <span m='4329460'>that</span>
  <span m='4329940'>is</span> <span m='4330090'>safe,</span> <span m='4330540'>even</span>
  <span m='4330870'>if</span> <span m='4330960'>a</span> <span m='4330990'>quantum</span>
  <span m='4331290'>computer</span> <span m='4331620'>exists,</span> <span m='4332700'>because</span>
  <span m='4333000'>that's</span> <span m='4333300'>based</span> <span m='4333540'>on</span>
  <span m='4333630'>the</span> <span m='4333720'>security</span> <span m='4334070'>the</span>
  <span m='4334140'>hash</span> <span m='4334320'>function.</span> </p><p><span m='4335280'>So</span>
  <span m='4335370'>that's</span> <span m='4335490'>kind</span> <span m='4335640'>of</span>
  <span m='4335730'>an</span> <span m='4335820'>interesting</span> <span m='4336540'>little</span>
  <span m='4336900'>tidbit--</span> <span m='4337350'>like,</span> <span m='4337560'>hey,</span>
  <span m='4337770'>this</span> <span m='4339540'>taproot</span> <span m='4339990'>construction</span>
  <span m='4342660'>is</span> <span m='4342870'>hash</span> <span m='4343140'>based.</span>
  <span m='4343860'>Quantum</span> <span m='4344160'>computer</span> <span m='4344550'>appears,</span>
  <span m='4345210'>and</span> <span m='4345300'>we</span> <span m='4345420'>say,</span>
  <span m='4345570'>look,</span> <span m='4346560'>we</span> <span m='4346740'>no</span>
  <span m='4346950'>longer</span> <span m='4347310'>allow</span> <span m='4348390'>C.</span>
  <span m='4349440'>We</span> <span m='4349560'>no</span> <span m='4349740'>longer</span>
  <span m='4349980'>allow</span> <span m='4350280'>the</span> <span m='4350810'>normal</span>
  <span m='4351210'>spend,</span> <span m='4351690'>where</span> <span m='4351900'>you</span>
  <span m='4352050'>sign</span> <span m='4352410'>with</span> <span m='4352560'>key</span>
  <span m='4353040'>C,</span> <span m='4353280'>because</span> <span m='4353490'>signatures--</span>
  <span m='4354060'>all</span> <span m='4354240'>this</span> <span m='4354420'>elliptic</span>
  <span m='4354720'>curve</span> <span m='4354930'>stuff,</span> <span m='4355470'>it's</span>
  <span m='4355620'>broken.</span> </p><p><span m='4356590'>However,</span> <span
  m='4356880'>we</span> <span m='4357060'>do</span> <span m='4357450'>allow</span>
  <span m='4357780'>you</span> <span m='4357990'>to</span> <span m='4358140'>prove</span>
  <span m='4359220'>that</span> <span m='4359370'>there</span> <span m='4359520'>was</span>
  <span m='4359850'>a</span> <span m='4359910'>script</span> <span m='4360300'>z</span>
  <span m='4362670'>committed</span> <span m='4363120'>to</span> <span m='4363510'>in</span>
  <span m='4363690'>C.</span> <span m='4364440'>And</span> <span m='4364560'>then</span>
  <span m='4364710'>maybe</span> <span m='4365010'>this</span> <span m='4365160'>script</span>
  <span m='4365520'>has</span> <span m='4365730'>like</span> <span m='4365940'>a</span>
  <span m='4366660'>quantum-safe</span> <span m='4367860'>signature</span> <span m='4368280'>in</span>
  <span m='4368370'>it,</span> <span m='4369200'>and</span> <span m='4369300'>then</span>
  <span m='4369420'>we</span> <span m='4369540'>can</span> <span m='4369690'>use</span>
  <span m='4369870'>that.</span> <span m='4370710'>What's</span> <span m='4370920'>nice</span>
  <span m='4371130'>about</span> <span m='4371310'>that</span> <span m='4371490'>is</span>
  <span m='4371610'>you</span> <span m='4371700'>can</span> <span m='4371820'>start</span>
  <span m='4372030'>using</span> <span m='4372360'>it</span> <span m='4372930'>sooner,</span>
  <span m='4373560'>and</span> <span m='4373710'>without</span> <span m='4374160'>the</span>
  <span m='4374310'>overhead</span> <span m='4374790'>of</span> <span m='4374910'>all</span>
  <span m='4375030'>the</span> <span m='4375150'>extra</span> <span m='4375390'>space</span>
  <span m='4375780'>taken</span> <span m='4376020'>by</span> <span m='4376140'>the</span>
  <span m='4376200'>quantum</span> <span m='4376440'>signature,</span> <span m='4377190'>because</span>
  <span m='4377670'>it's</span> <span m='4377820'>sort</span> <span m='4377970'>of</span>
  <span m='4378060'>a</span> <span m='4378120'>backup</span> <span m='4378600'>plan.</span>
  <span m='4379080'>It's</span> <span m='4379230'>like,</span> <span m='4379350'>well,</span>
  <span m='4379950'>normally</span> <span m='4380400'>I'm</span> <span m='4380580'>just</span>
  <span m='4380720'>signing</span> <span m='4381060'>with</span> <span m='4381210'>C,</span>
  <span m='4382700'>because</span> <span m='4382920'>I</span> <span m='4383040'>know</span>
  <span m='4383700'>this</span> <span m='4383880'>is</span> <span m='4383940'>just</span>
  <span m='4384120'>my</span> <span m='4384240'>regular</span> <span m='4384600'>key--</span>
  <span m='4385350'>and</span> <span m='4385470'>I</span> <span m='4385560'>do</span>
  <span m='4385710'>this.</span> <span m='4386310'>But</span> <span m='4386820'>worst-case</span>
  <span m='4387360'>scenario,</span> <span m='4387870'>if</span> <span m='4387960'>a</span>
  <span m='4387990'>quantum</span> <span m='4388290'>computer</span> <span m='4388590'>appears</span>
  <span m='4388920'>in</span> <span m='4389040'>10</span> <span m='4389220'>years,</span>
  <span m='4390000'>I've</span> <span m='4390150'>got</span> <span m='4390450'>my</span>
  <span m='4390780'>other</span> <span m='4391200'>backup</span> <span m='4391710'>key</span>
  <span m='4392010'>here.</span> <span m='4393520'>So</span> <span m='4394510'>that's</span>
  <span m='4394690'>kind</span> <span m='4394840'>of</span> <span m='4394900'>a</span>
  <span m='4394930'>cool</span> <span m='4395110'>thing.</span> <span m='4396700'>I</span>
  <span m='4396730'>don't</span> <span m='4396850'>know</span> <span m='4396910'>how</span>
  <span m='4397120'>useful</span> <span m='4397450'>it</span> <span m='4397510'>is</span>
  <span m='4397630'>in</span> <span m='4397720'>practice.</span> </p><p><span m='4399830'>So</span>
  <span m='4399980'>yeah,</span> <span m='4401020'>you've</span> <span m='4401210'>got</span>
  <span m='4401320'>all</span> <span m='4401410'>these</span> <span m='4401500'>three</span>
  <span m='4401690'>things.</span> <span m='4402530'>The</span> <span m='4402680'>other</span>
  <span m='4402920'>thing</span> <span m='4403130'>about</span> <span m='4403370'>this</span>
  <span m='4403490'>is--</span> <span m='4407310'>I</span> <span m='4407410'>don't</span>
  <span m='4407520'>know,</span> <span m='4407800'>big</span> <span m='4408070'>multisig</span>
  <span m='4408580'>is</span> <span m='4408700'>one</span> <span m='4408880'>use</span>
  <span m='4409060'>case.</span> <span m='4409750'>It</span> <span m='4409900'>seems</span>
  <span m='4410320'>really</span> <span m='4410590'>powerful,</span> <span m='4410980'>and</span>
  <span m='4411070'>like,</span> <span m='4411220'>hey,</span> <span m='4411400'>I</span>
  <span m='4411490'>can</span> <span m='4411610'>make</span> <span m='4411790'>these</span>
  <span m='4412360'>millions</span> <span m='4413320'>of</span> <span m='4413410'>different</span>
  <span m='4413770'>scripts,</span> <span m='4414310'>and</span> <span m='4414730'>Merkle</span>
  <span m='4415180'>trees</span> <span m='4415510'>of</span> <span m='4415600'>different</span>
  <span m='4415840'>scripts,</span> <span m='4416320'>and</span> <span m='4416530'>taproot</span>
  <span m='4416980'>and</span> <span m='4417080'>graftroot.</span> <span m='4418440'>Not</span>
  <span m='4418660'>a</span> <span m='4418750'>ton</span> <span m='4419170'>of</span>
  <span m='4419320'>really</span> <span m='4419950'>good</span> <span m='4420760'>real</span>
  <span m='4421000'>world</span> <span m='4421240'>use</span> <span m='4421420'>cases,</span>
  <span m='4421780'>though,</span> <span m='4423400'>I</span> <span m='4423460'>think</span>
  <span m='4423760'>that</span> <span m='4424000'>would</span> <span m='4424180'>motivate</span>
  <span m='4424525'>it</span> <span m='4424870'>a</span> <span m='4424900'>lot</span>
  <span m='4425110'>more.</span> </p><p><span m='4425380'>Because</span> <span m='4425710'>a</span>
  <span m='4425770'>lot</span> <span m='4425980'>of</span> <span m='4427090'>the</span>
  <span m='4427180'>hesitation</span> <span m='4427750'>from</span> <span m='4427930'>people</span>
  <span m='4428170'>working</span> <span m='4428410'>on</span> <span m='4428470'>Bitcoin</span>
  <span m='4428770'>is</span> <span m='4428860'>like,</span> <span m='4429010'>OK,</span>
  <span m='4429910'>this</span> <span m='4430090'>is</span> <span m='4430180'>really</span>
  <span m='4430330'>cool,</span> <span m='4430570'>but</span> <span m='4431290'>what</span>
  <span m='4431440'>are</span> <span m='4431500'>we</span> <span m='4431590'>going</span>
  <span m='4431670'>to</span> <span m='4431770'>do</span> <span m='4431950'>with</span>
  <span m='4432100'>it?</span> <span m='4434530'>As</span> <span m='4434860'>I'll</span>
  <span m='4435070'>talk</span> <span m='4435310'>about</span> <span m='4436300'>on</span>
  <span m='4436570'>Wednesday,</span> <span m='4437350'>multisig</span> <span m='4437890'>itself</span>
  <span m='4438220'>is</span> <span m='4438370'>not</span> <span m='4438790'>the</span>
  <span m='4438910'>best</span> <span m='4440080'>motivation.</span> <span m='4440770'>Because</span>
  <span m='4441520'>once</span> <span m='4441850'>we</span> <span m='4442000'>have</span>
  <span m='4443100'>Schnoor</span> <span m='4443380'>signatures</span> <span m='4443980'>and</span>
  <span m='4444100'>aggregate</span> <span m='4444400'>signatures</span> <span m='4446120'>there's</span>
  <span m='4446560'>direct</span> <span m='4447010'>ways</span> <span m='4447310'>to</span>
  <span m='4447400'>do</span> <span m='4447790'>multisig,</span> <span m='4448810'>that</span>
  <span m='4448990'>are</span> <span m='4449200'>actually</span> <span m='4449710'>more</span>
  <span m='4450130'>privacy</span> <span m='4450550'>preserving</span> <span m='4450970'>and
  more</span> <span m='4451210'>space</span> <span m='4451480'>preserving.</span>
  </p><p><span m='4452890'>So</span> <span m='4453880'>we</span> <span m='4453970'>need</span>
  <span m='4454130'>to</span> <span m='4454170'>use</span> <span m='4454330'>cases.</span>
  <span m='4455120'>And</span> <span m='4455710'>that's</span> <span m='4455920'>one</span>
  <span m='4456040'>of</span> <span m='4456100'>the</span> <span m='4456190'>debates--</span>
  <span m='4456490'>like,</span> <span m='4456740'>OK,</span> <span m='4456920'>what</span>
  <span m='4456940'>do</span> <span m='4457000'>we</span> <span m='4457120'>do</span>
  <span m='4457240'>with</span> <span m='4457360'>this?</span> <span m='4457750'>This</span>
  <span m='4457900'>is</span> <span m='4457990'>kind</span> <span m='4458170'>of</span>
  <span m='4458230'>cool.</span> <span m='4459140'>You</span> <span m='4459240'>can</span>
  <span m='4459340'>make</span> <span m='4459370'>all</span> <span m='4459490'>sorts</span>
  <span m='4459700'>of</span> <span m='4459790'>weird</span> <span m='4459970'>smart</span>
  <span m='4460210'>contracts,</span> <span m='4460660'>but</span> <span m='4460930'>what</span>
  <span m='4461110'>are</span> <span m='4461170'>some</span> <span m='4461320'>real-world</span>
  <span m='4461660'>use</span> <span m='4461830'>cases?</span> <span m='4462920'>There's</span>
  <span m='4463000'>also</span> <span m='4463270'>sort</span> <span m='4463450'>of</span>
  <span m='4463540'>argument--</span> <span m='4463910'>OK,</span> <span m='4464240'>MAST</span>
  <span m='4464810'>versus</span> <span m='4465280'>graftroot</span> <span m='4465880'>versus</span>
  <span m='4466240'>both.</span> <span m='4466870'>Well,</span> <span m='4467020'>if</span>
  <span m='4467110'>you</span> <span m='4467230'>have</span> <span m='4467440'>graftroot,</span>
  <span m='4468350'>do</span> <span m='4468370'>you</span> <span m='4468460'>really</span>
  <span m='4468730'>need</span> <span m='4468880'>MAST</span> <span m='4469210'>anymore?</span>
  <span m='4470260'>Instead</span> <span m='4470650'>of</span> <span m='4470770'>this</span>
  <span m='4472590'>big</span> <span m='4472770'>Merkle</span> <span m='4473100'>tree,</span>
  <span m='4473820'>you</span> <span m='4473940'>just</span> <span m='4474240'>have</span>
  <span m='4474600'>the</span> <span m='4474720'>signatures</span> <span m='4475200'>endorsing</span>
  <span m='4475620'>the</span> <span m='4475680'>leaves.</span> <span m='4476610'>So</span>
  <span m='4476940'>it</span> <span m='4477050'>sort</span> <span m='4477270'>of</span>
  <span m='4477360'>seems</span> <span m='4477630'>better</span> <span m='4477930'>scalability</span>
  <span m='4478560'>there.</span> <span m='4479730'>But</span> <span m='4480920'>graftroot</span>
  <span m='4481140'>is</span> <span m='4481260'>interactive,</span> <span m='4482010'>so</span>
  <span m='4482220'>maybe</span> <span m='4482430'>you</span> <span m='4482490'>still</span>
  <span m='4482670'>want</span> <span m='4482950'>MAST.</span> <span m='4483340'>Maybe</span>
  <span m='4483540'>you</span> <span m='4483600'>have</span> <span m='4483720'>both.</span>
  <span m='4485460'>There's</span> <span m='4485700'>all</span> <span m='4485820'>sorts</span>
  <span m='4486090'>of</span> <span m='4486150'>debate</span> <span m='4486420'>on</span>
  <span m='4486540'>this.</span> </p><p><span m='4486990'>And</span> <span m='4487350'>so</span>
  <span m='4488340'>in</span> <span m='4488460'>practice</span> <span m='4489180'>that</span>
  <span m='4489420'>may</span> <span m='4489600'>mean</span> <span m='4489930'>that</span>
  <span m='4490590'>since</span> <span m='4490830'>people</span> <span m='4491040'>are</span>
  <span m='4491130'>arguing</span> <span m='4491970'>next</span> <span m='4492270'>year,</span>
  <span m='4492730'>the</span> <span m='4492830'>year</span> <span m='4492930'>after,</span>
  <span m='4494610'>it's</span> <span m='4494790'>hard</span> <span m='4495210'>to</span>
  <span m='4495360'>get</span> <span m='4496050'>everyone</span> <span m='4496470'>on</span>
  <span m='4496590'>board</span> <span m='4496890'>to</span> <span m='4497010'>do</span>
  <span m='4497160'>stuff.</span> <span m='4497580'>There</span> <span m='4497760'>is</span>
  <span m='4497940'>code,</span> <span m='4498340'>though.</span> <span m='4499710'>Some</span>
  <span m='4499950'>things</span> <span m='4500430'>have</span> <span m='4500610'>code.</span>
  <span m='4502200'>A</span> <span m='4502290'>lot</span> <span m='4502440'>of</span>
  <span m='4502560'>it's</span> <span m='4502980'>sort</span> <span m='4503280'>of</span>
  <span m='4503400'>obvious</span> <span m='4503710'>enough,</span> <span m='4503930'>that</span>
  <span m='4504000'>like,</span> <span m='4504150'>yeah,</span> <span m='4504440'>graftroot</span>
  <span m='4504900'>makes</span> <span m='4505110'>sense.</span> <span m='4505410'>Just</span>
  <span m='4505590'>have</span> <span m='4505740'>them</span> <span m='4505860'>sign.</span>
  <span m='4507370'>The</span> <span m='4507510'>taproot</span> <span m='4507870'>construction</span>
  <span m='4508350'>there's</span> <span m='4508500'>code</span> <span m='4508710'>for.</span>
  <span m='4509250'>But</span> <span m='4509370'>it's</span> <span m='4509490'>not</span>
  <span m='4509670'>all</span> <span m='4510510'>put</span> <span m='4510750'>together.</span>
  <span m='4511140'>There's</span> <span m='4511320'>no</span> <span m='4511680'>spec</span>
  <span m='4512010'>for</span> <span m='4512130'>all</span> <span m='4512220'>these</span>
  <span m='4512370'>things.</span> </p><p><span m='4513040'>So</span> <span m='4513060'>if</span>
  <span m='4513120'>people</span> <span m='4513360'>are</span> <span m='4513450'>interested</span>
  <span m='4513810'>in</span> <span m='4513900'>this</span> <span m='4513990'>stuff,</span>
  <span m='4514680'>start</span> <span m='4514890'>coding</span> <span m='4515220'>it.</span>
  <span m='4515310'>Start</span> <span m='4515490'>trying</span> <span m='4515790'>it</span>
  <span m='4515850'>out.</span> <span m='4517260'>Come</span> <span m='4517440'>up</span>
  <span m='4517560'>with</span> <span m='4517680'>cool</span> <span m='4517830'>use</span>
  <span m='4518040'>cases,</span> <span m='4519030'>and</span> <span m='4519300'>maybe</span>
  <span m='4519660'>push</span> <span m='4519960'>for</span> <span m='4520110'>one</span>
  <span m='4520320'>thing</span> <span m='4520470'>or</span> <span m='4520530'>another</span>
  <span m='4520950'>to</span> <span m='4521100'>get</span> <span m='4521280'>in.</span>
  <span m='4521520'>There's</span> <span m='4522060'>a</span> <span m='4522120'>full</span>
  <span m='4522390'>request</span> <span m='4522750'>open</span> <span m='4523260'>in</span>
  <span m='4523410'>Bitcoin</span> <span m='4523800'>right</span> <span m='4523950'>now</span>
  <span m='4524210'>for</span> <span m='4524420'>MAST.</span> <span m='4527390'>I</span>
  <span m='4527810'>know</span> <span m='4528110'>some</span> <span m='4528320'>people</span>
  <span m='4528560'>are</span> <span m='4528590'>really</span> <span m='4528830'>into</span>
  <span m='4529040'>it,</span> <span m='4529340'>and</span> <span m='4529460'>other</span>
  <span m='4529610'>people</span> <span m='4529880'>are</span> <span m='4529940'>like,</span>
  <span m='4530120'>uh,</span> <span m='4530730'>I</span> <span m='4530830'>don't</span>
  <span m='4530930'>know.</span> <span m='4533150'>Also,</span> <span m='4533460'>how</span>
  <span m='4533700'>to</span> <span m='4533790'>implement</span> <span m='4534180'>MAST</span>
  <span m='4534450'>exactly.</span> </p><p><span m='4535320'>So</span> <span m='4535560'>this</span>
  <span m='4535770'>is</span> <span m='4536700'>still</span> <span m='4537030'>research</span>
  <span m='4537660'>kind</span> <span m='4537900'>of</span> <span m='4537990'>level,</span>
  <span m='4538360'>but</span> <span m='4538770'>it</span> <span m='4539340'>seems</span>
  <span m='4539790'>that</span> <span m='4539910'>they're</span> <span m='4540060'>usable,</span>
  <span m='4540540'>and</span> <span m='4540690'>it</span> <span m='4540840'>may</span>
  <span m='4541320'>improve</span> <span m='4541770'>smart-contract</span> <span m='4542340'>functionality.</span>
  <span m='4543570'>So</span> <span m='4544980'>cool</span> <span m='4545160'>stuff</span>
  <span m='4545400'>here.</span> <span m='4546330'>Any</span> <span m='4546480'>questions</span>
  <span m='4546810'>about</span> <span m='4547268'>this?</span> </p><p><span m='4551390'>All</span>
  <span m='4551450'>right,</span> <span m='4551810'>cool.</span> <span m='4552950'>So</span>
  <span m='4553160'>I'll</span> <span m='4553310'>do</span> <span m='4553670'>office</span>
  <span m='4553970'>hours</span> <span m='4555110'>tomorrow</span> <span m='4555420'>at</span>
  <span m='4555710'>4:00.</span> <span m='4556050'>We</span> <span m='4556280'>can
  talk</span> <span m='4556430'>about</span> <span m='4556580'>projects</span> <span
  m='4556940'>and</span> <span m='4557030'>stuff.</span> <span m='4557660'>And</span>
  <span m='4557780'>the</span> <span m='4557850'>next</span> <span m='4558980'>class</span>
  <span m='4559400'>on</span> <span m='4559550'>Wednesday</span> <span m='4559940'>will</span>
  <span m='4560150'>be</span> <span m='4560510'>even</span> <span m='4560810'>more</span>
  <span m='4561080'>crazy</span> <span m='4561520'>elliptic</span> <span m='4561820'>curve</span>
  <span m='4561980'>stuff</span> <span m='4562310'>about</span> <span m='4563090'>aggregate</span>
  <span m='4563420'>signatures,</span> <span m='4564460'>Schnoor</span> <span m='4564690'>signatures,</span>
  <span m='4565070'>multi</span> <span m='4565340'>signatures,</span> <span m='4567230'>threshold</span>
  <span m='4567650'>signatures,</span> <span m='4568070'>things</span> <span m='4568280'>like</span>
  <span m='4568400'>that.</span> <span m='4569070'>And</span> <span m='4569180'>also,</span>
  <span m='4569390'>privacy--</span> <span m='4571490'>I'm</span> <span m='4571580'>going</span>
  <span m='4571700'>to</span> <span m='4571760'>focus</span> <span m='4572030'>on</span>
  <span m='4572120'>the</span> <span m='4572180'>signature</span> <span m='4572540'>part.</span>
  <span m='4572900'>I</span> <span m='4572990'>also</span> <span m='4573230'>put</span>
  <span m='4573560'>privacy</span> <span m='4574360'>and</span> <span m='4574820'>CoinJoin</span>
  <span m='4575420'>in</span> <span m='4575510'>there,</span> <span m='4576180'>which</span>
  <span m='4576290'>is</span> <span m='4576410'>related,</span> <span m='4576890'>but</span>
  <span m='4577850'>might</span> <span m='4578240'>be</span> <span m='4578600'>squished</span>
  <span m='4579020'>towards</span> <span m='4579380'>the</span> <span m='4579530'>end</span>
  <span m='4579830'>if</span> <span m='4580130'>I don't</span> <span m='4580430'>have
  a ton</span> <span m='4580730'>of time.</span> </p>
type: course
uid: 4d595b57196aee4338937f75e346656b

---
None